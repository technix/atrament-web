{"version":3,"file":"main.js","mappings":"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","sources":["webpack://atrament/webpack/universalModuleDefinition","webpack://atrament/./node_modules/murmurhash-js/murmurhash2_gc.js","webpack://atrament/./node_modules/howler/dist/howler.js","webpack://atrament/./node_modules/murmurhash-js/index.js","webpack://atrament/./node_modules/murmurhash-js/murmurhash3_gc.js","webpack://atrament/./node_modules/localforage/dist/localforage.js","webpack://atrament/webpack/bootstrap","webpack://atrament/webpack/runtime/compat get default export","webpack://atrament/webpack/runtime/define property getters","webpack://atrament/webpack/runtime/global","webpack://atrament/webpack/runtime/hasOwnProperty shorthand","webpack://atrament/./node_modules/@atrament/core/dist/index.mjs","webpack://atrament/./node_modules/fflate/esm/browser.js","webpack://atrament/./src/interfaces/loader-common.js","webpack://atrament/./src/interfaces/loader-web-fflate.js","webpack://atrament/./src/interfaces/persistent-localforage.js","webpack://atrament/./src/interfaces/persistent-neutralino.js","webpack://atrament/./src/interfaces/sound-howler.js","webpack://atrament/./node_modules/nanostores/atom/index.js","webpack://atrament/./src/interfaces/state-nanostores.js","webpack://atrament/./node_modules/nanostores/map/index.js","webpack://atrament/./src/interfaces/platform-web.js","webpack://atrament/./src/interfaces/platform-neutralino.js","webpack://atrament/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"atrament\"] = factory();\n\telse\n\t\troot[\"atrament\"] = factory();\n})(typeof self !== 'undefined' ? self : this, () => {\nreturn ","/**\n * JS Implementation of MurmurHash2\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} str ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash\n */\n\nfunction murmurhash2_32_gc(str, seed) {\n  var\n    l = str.length,\n    h = seed ^ l,\n    i = 0,\n    k;\n  \n  while (l >= 4) {\n  \tk = \n  \t  ((str.charCodeAt(i) & 0xff)) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 8) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 16) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 24);\n    \n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n    k ^= k >>> 24;\n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n\n\th = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16)) ^ k;\n\n    l -= 4;\n    ++i;\n  }\n  \n  switch (l) {\n  case 3: h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n  case 2: h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n  case 1: h ^= (str.charCodeAt(i) & 0xff);\n          h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  }\n\n  h ^= h >>> 13;\n  h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  h ^= h >>> 15;\n\n  return h >>> 0;\n}\n\nif(typeof module !== undefined) {\n  module.exports = murmurhash2_32_gc\n}\n","/*!\n *  howler.js v2.2.4\n *  howlerjs.com\n *\n *  (c) 2013-2020, James Simpson of GoldFire Studios\n *  goldfirestudios.com\n *\n *  MIT License\n */\n\n(function() {\n\n  'use strict';\n\n  /** Global Methods **/\n  /***************************************************************************/\n\n  /**\n   * Create the global controller. All contained methods and properties apply\n   * to all sounds that are currently playing or will be in the future.\n   */\n  var HowlerGlobal = function() {\n    this.init();\n  };\n  HowlerGlobal.prototype = {\n    /**\n     * Initialize the global Howler object.\n     * @return {Howler}\n     */\n    init: function() {\n      var self = this || Howler;\n\n      // Create a global ID counter.\n      self._counter = 1000;\n\n      // Pool of unlocked HTML5 Audio objects.\n      self._html5AudioPool = [];\n      self.html5PoolSize = 10;\n\n      // Internal properties.\n      self._codecs = {};\n      self._howls = [];\n      self._muted = false;\n      self._volume = 1;\n      self._canPlayEvent = 'canplaythrough';\n      self._navigator = (typeof window !== 'undefined' && window.navigator) ? window.navigator : null;\n\n      // Public properties.\n      self.masterGain = null;\n      self.noAudio = false;\n      self.usingWebAudio = true;\n      self.autoSuspend = true;\n      self.ctx = null;\n\n      // Set to false to disable the auto audio unlocker.\n      self.autoUnlock = true;\n\n      // Setup the various state values for global tracking.\n      self._setup();\n\n      return self;\n    },\n\n    /**\n     * Get/set the global volume for all sounds.\n     * @param  {Float} vol Volume from 0.0 to 1.0.\n     * @return {Howler/Float}     Returns self or current volume.\n     */\n    volume: function(vol) {\n      var self = this || Howler;\n      vol = parseFloat(vol);\n\n      // If we don't have an AudioContext created yet, run the setup.\n      if (!self.ctx) {\n        setupAudioContext();\n      }\n\n      if (typeof vol !== 'undefined' && vol >= 0 && vol <= 1) {\n        self._volume = vol;\n\n        // Don't update any of the nodes if we are muted.\n        if (self._muted) {\n          return self;\n        }\n\n        // When using Web Audio, we just need to adjust the master gain.\n        if (self.usingWebAudio) {\n          self.masterGain.gain.setValueAtTime(vol, Howler.ctx.currentTime);\n        }\n\n        // Loop through and change volume for all HTML5 audio nodes.\n        for (var i=0; i<self._howls.length; i++) {\n          if (!self._howls[i]._webAudio) {\n            // Get all of the sounds in this Howl group.\n            var ids = self._howls[i]._getSoundIds();\n\n            // Loop through all sounds and change the volumes.\n            for (var j=0; j<ids.length; j++) {\n              var sound = self._howls[i]._soundById(ids[j]);\n\n              if (sound && sound._node) {\n                sound._node.volume = sound._volume * vol;\n              }\n            }\n          }\n        }\n\n        return self;\n      }\n\n      return self._volume;\n    },\n\n    /**\n     * Handle muting and unmuting globally.\n     * @param  {Boolean} muted Is muted or not.\n     */\n    mute: function(muted) {\n      var self = this || Howler;\n\n      // If we don't have an AudioContext created yet, run the setup.\n      if (!self.ctx) {\n        setupAudioContext();\n      }\n\n      self._muted = muted;\n\n      // With Web Audio, we just need to mute the master gain.\n      if (self.usingWebAudio) {\n        self.masterGain.gain.setValueAtTime(muted ? 0 : self._volume, Howler.ctx.currentTime);\n      }\n\n      // Loop through and mute all HTML5 Audio nodes.\n      for (var i=0; i<self._howls.length; i++) {\n        if (!self._howls[i]._webAudio) {\n          // Get all of the sounds in this Howl group.\n          var ids = self._howls[i]._getSoundIds();\n\n          // Loop through all sounds and mark the audio node as muted.\n          for (var j=0; j<ids.length; j++) {\n            var sound = self._howls[i]._soundById(ids[j]);\n\n            if (sound && sound._node) {\n              sound._node.muted = (muted) ? true : sound._muted;\n            }\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Handle stopping all sounds globally.\n     */\n    stop: function() {\n      var self = this || Howler;\n\n      // Loop through all Howls and stop them.\n      for (var i=0; i<self._howls.length; i++) {\n        self._howls[i].stop();\n      }\n\n      return self;\n    },\n\n    /**\n     * Unload and destroy all currently loaded Howl objects.\n     * @return {Howler}\n     */\n    unload: function() {\n      var self = this || Howler;\n\n      for (var i=self._howls.length-1; i>=0; i--) {\n        self._howls[i].unload();\n      }\n\n      // Create a new AudioContext to make sure it is fully reset.\n      if (self.usingWebAudio && self.ctx && typeof self.ctx.close !== 'undefined') {\n        self.ctx.close();\n        self.ctx = null;\n        setupAudioContext();\n      }\n\n      return self;\n    },\n\n    /**\n     * Check for codec support of specific extension.\n     * @param  {String} ext Audio file extention.\n     * @return {Boolean}\n     */\n    codecs: function(ext) {\n      return (this || Howler)._codecs[ext.replace(/^x-/, '')];\n    },\n\n    /**\n     * Setup various state values for global tracking.\n     * @return {Howler}\n     */\n    _setup: function() {\n      var self = this || Howler;\n\n      // Keeps track of the suspend/resume state of the AudioContext.\n      self.state = self.ctx ? self.ctx.state || 'suspended' : 'suspended';\n\n      // Automatically begin the 30-second suspend process\n      self._autoSuspend();\n\n      // Check if audio is available.\n      if (!self.usingWebAudio) {\n        // No audio is available on this system if noAudio is set to true.\n        if (typeof Audio !== 'undefined') {\n          try {\n            var test = new Audio();\n\n            // Check if the canplaythrough event is available.\n            if (typeof test.oncanplaythrough === 'undefined') {\n              self._canPlayEvent = 'canplay';\n            }\n          } catch(e) {\n            self.noAudio = true;\n          }\n        } else {\n          self.noAudio = true;\n        }\n      }\n\n      // Test to make sure audio isn't disabled in Internet Explorer.\n      try {\n        var test = new Audio();\n        if (test.muted) {\n          self.noAudio = true;\n        }\n      } catch (e) {}\n\n      // Check for supported codecs.\n      if (!self.noAudio) {\n        self._setupCodecs();\n      }\n\n      return self;\n    },\n\n    /**\n     * Check for browser support for various codecs and cache the results.\n     * @return {Howler}\n     */\n    _setupCodecs: function() {\n      var self = this || Howler;\n      var audioTest = null;\n\n      // Must wrap in a try/catch because IE11 in server mode throws an error.\n      try {\n        audioTest = (typeof Audio !== 'undefined') ? new Audio() : null;\n      } catch (err) {\n        return self;\n      }\n\n      if (!audioTest || typeof audioTest.canPlayType !== 'function') {\n        return self;\n      }\n\n      var mpegTest = audioTest.canPlayType('audio/mpeg;').replace(/^no$/, '');\n\n      // Opera version <33 has mixed MP3 support, so we need to check for and block it.\n      var ua = self._navigator ? self._navigator.userAgent : '';\n      var checkOpera = ua.match(/OPR\\/(\\d+)/g);\n      var isOldOpera = (checkOpera && parseInt(checkOpera[0].split('/')[1], 10) < 33);\n      var checkSafari = ua.indexOf('Safari') !== -1 && ua.indexOf('Chrome') === -1;\n      var safariVersion = ua.match(/Version\\/(.*?) /);\n      var isOldSafari = (checkSafari && safariVersion && parseInt(safariVersion[1], 10) < 15);\n\n      self._codecs = {\n        mp3: !!(!isOldOpera && (mpegTest || audioTest.canPlayType('audio/mp3;').replace(/^no$/, ''))),\n        mpeg: !!mpegTest,\n        opus: !!audioTest.canPlayType('audio/ogg; codecs=\"opus\"').replace(/^no$/, ''),\n        ogg: !!audioTest.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\n        oga: !!audioTest.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\n        wav: !!(audioTest.canPlayType('audio/wav; codecs=\"1\"') || audioTest.canPlayType('audio/wav')).replace(/^no$/, ''),\n        aac: !!audioTest.canPlayType('audio/aac;').replace(/^no$/, ''),\n        caf: !!audioTest.canPlayType('audio/x-caf;').replace(/^no$/, ''),\n        m4a: !!(audioTest.canPlayType('audio/x-m4a;') || audioTest.canPlayType('audio/m4a;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n        m4b: !!(audioTest.canPlayType('audio/x-m4b;') || audioTest.canPlayType('audio/m4b;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n        mp4: !!(audioTest.canPlayType('audio/x-mp4;') || audioTest.canPlayType('audio/mp4;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n        weba: !!(!isOldSafari && audioTest.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, '')),\n        webm: !!(!isOldSafari && audioTest.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, '')),\n        dolby: !!audioTest.canPlayType('audio/mp4; codecs=\"ec-3\"').replace(/^no$/, ''),\n        flac: !!(audioTest.canPlayType('audio/x-flac;') || audioTest.canPlayType('audio/flac;')).replace(/^no$/, '')\n      };\n\n      return self;\n    },\n\n    /**\n     * Some browsers/devices will only allow audio to be played after a user interaction.\n     * Attempt to automatically unlock audio on the first user interaction.\n     * Concept from: http://paulbakaus.com/tutorials/html5/web-audio-on-ios/\n     * @return {Howler}\n     */\n    _unlockAudio: function() {\n      var self = this || Howler;\n\n      // Only run this if Web Audio is supported and it hasn't already been unlocked.\n      if (self._audioUnlocked || !self.ctx) {\n        return;\n      }\n\n      self._audioUnlocked = false;\n      self.autoUnlock = false;\n\n      // Some mobile devices/platforms have distortion issues when opening/closing tabs and/or web views.\n      // Bugs in the browser (especially Mobile Safari) can cause the sampleRate to change from 44100 to 48000.\n      // By calling Howler.unload(), we create a new AudioContext with the correct sampleRate.\n      if (!self._mobileUnloaded && self.ctx.sampleRate !== 44100) {\n        self._mobileUnloaded = true;\n        self.unload();\n      }\n\n      // Scratch buffer for enabling iOS to dispose of web audio buffers correctly, as per:\n      // http://stackoverflow.com/questions/24119684\n      self._scratchBuffer = self.ctx.createBuffer(1, 1, 22050);\n\n      // Call this method on touch start to create and play a buffer,\n      // then check if the audio actually played to determine if\n      // audio has now been unlocked on iOS, Android, etc.\n      var unlock = function(e) {\n        // Create a pool of unlocked HTML5 Audio objects that can\n        // be used for playing sounds without user interaction. HTML5\n        // Audio objects must be individually unlocked, as opposed\n        // to the WebAudio API which only needs a single activation.\n        // This must occur before WebAudio setup or the source.onended\n        // event will not fire.\n        while (self._html5AudioPool.length < self.html5PoolSize) {\n          try {\n            var audioNode = new Audio();\n\n            // Mark this Audio object as unlocked to ensure it can get returned\n            // to the unlocked pool when released.\n            audioNode._unlocked = true;\n\n            // Add the audio node to the pool.\n            self._releaseHtml5Audio(audioNode);\n          } catch (e) {\n            self.noAudio = true;\n            break;\n          }\n        }\n\n        // Loop through any assigned audio nodes and unlock them.\n        for (var i=0; i<self._howls.length; i++) {\n          if (!self._howls[i]._webAudio) {\n            // Get all of the sounds in this Howl group.\n            var ids = self._howls[i]._getSoundIds();\n\n            // Loop through all sounds and unlock the audio nodes.\n            for (var j=0; j<ids.length; j++) {\n              var sound = self._howls[i]._soundById(ids[j]);\n\n              if (sound && sound._node && !sound._node._unlocked) {\n                sound._node._unlocked = true;\n                sound._node.load();\n              }\n            }\n          }\n        }\n\n        // Fix Android can not play in suspend state.\n        self._autoResume();\n\n        // Create an empty buffer.\n        var source = self.ctx.createBufferSource();\n        source.buffer = self._scratchBuffer;\n        source.connect(self.ctx.destination);\n\n        // Play the empty buffer.\n        if (typeof source.start === 'undefined') {\n          source.noteOn(0);\n        } else {\n          source.start(0);\n        }\n\n        // Calling resume() on a stack initiated by user gesture is what actually unlocks the audio on Android Chrome >= 55.\n        if (typeof self.ctx.resume === 'function') {\n          self.ctx.resume();\n        }\n\n        // Setup a timeout to check that we are unlocked on the next event loop.\n        source.onended = function() {\n          source.disconnect(0);\n\n          // Update the unlocked state and prevent this check from happening again.\n          self._audioUnlocked = true;\n\n          // Remove the touch start listener.\n          document.removeEventListener('touchstart', unlock, true);\n          document.removeEventListener('touchend', unlock, true);\n          document.removeEventListener('click', unlock, true);\n          document.removeEventListener('keydown', unlock, true);\n\n          // Let all sounds know that audio has been unlocked.\n          for (var i=0; i<self._howls.length; i++) {\n            self._howls[i]._emit('unlock');\n          }\n        };\n      };\n\n      // Setup a touch start listener to attempt an unlock in.\n      document.addEventListener('touchstart', unlock, true);\n      document.addEventListener('touchend', unlock, true);\n      document.addEventListener('click', unlock, true);\n      document.addEventListener('keydown', unlock, true);\n\n      return self;\n    },\n\n    /**\n     * Get an unlocked HTML5 Audio object from the pool. If none are left,\n     * return a new Audio object and throw a warning.\n     * @return {Audio} HTML5 Audio object.\n     */\n    _obtainHtml5Audio: function() {\n      var self = this || Howler;\n\n      // Return the next object from the pool if one exists.\n      if (self._html5AudioPool.length) {\n        return self._html5AudioPool.pop();\n      }\n\n      //.Check if the audio is locked and throw a warning.\n      var testPlay = new Audio().play();\n      if (testPlay && typeof Promise !== 'undefined' && (testPlay instanceof Promise || typeof testPlay.then === 'function')) {\n        testPlay.catch(function() {\n          console.warn('HTML5 Audio pool exhausted, returning potentially locked audio object.');\n        });\n      }\n\n      return new Audio();\n    },\n\n    /**\n     * Return an activated HTML5 Audio object to the pool.\n     * @return {Howler}\n     */\n    _releaseHtml5Audio: function(audio) {\n      var self = this || Howler;\n\n      // Don't add audio to the pool if we don't know if it has been unlocked.\n      if (audio._unlocked) {\n        self._html5AudioPool.push(audio);\n      }\n\n      return self;\n    },\n\n    /**\n     * Automatically suspend the Web Audio AudioContext after no sound has played for 30 seconds.\n     * This saves processing/energy and fixes various browser-specific bugs with audio getting stuck.\n     * @return {Howler}\n     */\n    _autoSuspend: function() {\n      var self = this;\n\n      if (!self.autoSuspend || !self.ctx || typeof self.ctx.suspend === 'undefined' || !Howler.usingWebAudio) {\n        return;\n      }\n\n      // Check if any sounds are playing.\n      for (var i=0; i<self._howls.length; i++) {\n        if (self._howls[i]._webAudio) {\n          for (var j=0; j<self._howls[i]._sounds.length; j++) {\n            if (!self._howls[i]._sounds[j]._paused) {\n              return self;\n            }\n          }\n        }\n      }\n\n      if (self._suspendTimer) {\n        clearTimeout(self._suspendTimer);\n      }\n\n      // If no sound has played after 30 seconds, suspend the context.\n      self._suspendTimer = setTimeout(function() {\n        if (!self.autoSuspend) {\n          return;\n        }\n\n        self._suspendTimer = null;\n        self.state = 'suspending';\n\n        // Handle updating the state of the audio context after suspending.\n        var handleSuspension = function() {\n          self.state = 'suspended';\n\n          if (self._resumeAfterSuspend) {\n            delete self._resumeAfterSuspend;\n            self._autoResume();\n          }\n        };\n\n        // Either the state gets suspended or it is interrupted.\n        // Either way, we need to update the state to suspended.\n        self.ctx.suspend().then(handleSuspension, handleSuspension);\n      }, 30000);\n\n      return self;\n    },\n\n    /**\n     * Automatically resume the Web Audio AudioContext when a new sound is played.\n     * @return {Howler}\n     */\n    _autoResume: function() {\n      var self = this;\n\n      if (!self.ctx || typeof self.ctx.resume === 'undefined' || !Howler.usingWebAudio) {\n        return;\n      }\n\n      if (self.state === 'running' && self.ctx.state !== 'interrupted' && self._suspendTimer) {\n        clearTimeout(self._suspendTimer);\n        self._suspendTimer = null;\n      } else if (self.state === 'suspended' || self.state === 'running' && self.ctx.state === 'interrupted') {\n        self.ctx.resume().then(function() {\n          self.state = 'running';\n\n          // Emit to all Howls that the audio has resumed.\n          for (var i=0; i<self._howls.length; i++) {\n            self._howls[i]._emit('resume');\n          }\n        });\n\n        if (self._suspendTimer) {\n          clearTimeout(self._suspendTimer);\n          self._suspendTimer = null;\n        }\n      } else if (self.state === 'suspending') {\n        self._resumeAfterSuspend = true;\n      }\n\n      return self;\n    }\n  };\n\n  // Setup the global audio controller.\n  var Howler = new HowlerGlobal();\n\n  /** Group Methods **/\n  /***************************************************************************/\n\n  /**\n   * Create an audio group controller.\n   * @param {Object} o Passed in properties for this group.\n   */\n  var Howl = function(o) {\n    var self = this;\n\n    // Throw an error if no source is provided.\n    if (!o.src || o.src.length === 0) {\n      console.error('An array of source files must be passed with any new Howl.');\n      return;\n    }\n\n    self.init(o);\n  };\n  Howl.prototype = {\n    /**\n     * Initialize a new Howl group object.\n     * @param  {Object} o Passed in properties for this group.\n     * @return {Howl}\n     */\n    init: function(o) {\n      var self = this;\n\n      // If we don't have an AudioContext created yet, run the setup.\n      if (!Howler.ctx) {\n        setupAudioContext();\n      }\n\n      // Setup user-defined default properties.\n      self._autoplay = o.autoplay || false;\n      self._format = (typeof o.format !== 'string') ? o.format : [o.format];\n      self._html5 = o.html5 || false;\n      self._muted = o.mute || false;\n      self._loop = o.loop || false;\n      self._pool = o.pool || 5;\n      self._preload = (typeof o.preload === 'boolean' || o.preload === 'metadata') ? o.preload : true;\n      self._rate = o.rate || 1;\n      self._sprite = o.sprite || {};\n      self._src = (typeof o.src !== 'string') ? o.src : [o.src];\n      self._volume = o.volume !== undefined ? o.volume : 1;\n      self._xhr = {\n        method: o.xhr && o.xhr.method ? o.xhr.method : 'GET',\n        headers: o.xhr && o.xhr.headers ? o.xhr.headers : null,\n        withCredentials: o.xhr && o.xhr.withCredentials ? o.xhr.withCredentials : false,\n      };\n\n      // Setup all other default properties.\n      self._duration = 0;\n      self._state = 'unloaded';\n      self._sounds = [];\n      self._endTimers = {};\n      self._queue = [];\n      self._playLock = false;\n\n      // Setup event listeners.\n      self._onend = o.onend ? [{fn: o.onend}] : [];\n      self._onfade = o.onfade ? [{fn: o.onfade}] : [];\n      self._onload = o.onload ? [{fn: o.onload}] : [];\n      self._onloaderror = o.onloaderror ? [{fn: o.onloaderror}] : [];\n      self._onplayerror = o.onplayerror ? [{fn: o.onplayerror}] : [];\n      self._onpause = o.onpause ? [{fn: o.onpause}] : [];\n      self._onplay = o.onplay ? [{fn: o.onplay}] : [];\n      self._onstop = o.onstop ? [{fn: o.onstop}] : [];\n      self._onmute = o.onmute ? [{fn: o.onmute}] : [];\n      self._onvolume = o.onvolume ? [{fn: o.onvolume}] : [];\n      self._onrate = o.onrate ? [{fn: o.onrate}] : [];\n      self._onseek = o.onseek ? [{fn: o.onseek}] : [];\n      self._onunlock = o.onunlock ? [{fn: o.onunlock}] : [];\n      self._onresume = [];\n\n      // Web Audio or HTML5 Audio?\n      self._webAudio = Howler.usingWebAudio && !self._html5;\n\n      // Automatically try to enable audio.\n      if (typeof Howler.ctx !== 'undefined' && Howler.ctx && Howler.autoUnlock) {\n        Howler._unlockAudio();\n      }\n\n      // Keep track of this Howl group in the global controller.\n      Howler._howls.push(self);\n\n      // If they selected autoplay, add a play event to the load queue.\n      if (self._autoplay) {\n        self._queue.push({\n          event: 'play',\n          action: function() {\n            self.play();\n          }\n        });\n      }\n\n      // Load the source file unless otherwise specified.\n      if (self._preload && self._preload !== 'none') {\n        self.load();\n      }\n\n      return self;\n    },\n\n    /**\n     * Load the audio file.\n     * @return {Howler}\n     */\n    load: function() {\n      var self = this;\n      var url = null;\n\n      // If no audio is available, quit immediately.\n      if (Howler.noAudio) {\n        self._emit('loaderror', null, 'No audio support.');\n        return;\n      }\n\n      // Make sure our source is in an array.\n      if (typeof self._src === 'string') {\n        self._src = [self._src];\n      }\n\n      // Loop through the sources and pick the first one that is compatible.\n      for (var i=0; i<self._src.length; i++) {\n        var ext, str;\n\n        if (self._format && self._format[i]) {\n          // If an extension was specified, use that instead.\n          ext = self._format[i];\n        } else {\n          // Make sure the source is a string.\n          str = self._src[i];\n          if (typeof str !== 'string') {\n            self._emit('loaderror', null, 'Non-string found in selected audio sources - ignoring.');\n            continue;\n          }\n\n          // Extract the file extension from the URL or base64 data URI.\n          ext = /^data:audio\\/([^;,]+);/i.exec(str);\n          if (!ext) {\n            ext = /\\.([^.]+)$/.exec(str.split('?', 1)[0]);\n          }\n\n          if (ext) {\n            ext = ext[1].toLowerCase();\n          }\n        }\n\n        // Log a warning if no extension was found.\n        if (!ext) {\n          console.warn('No file extension was found. Consider using the \"format\" property or specify an extension.');\n        }\n\n        // Check if this extension is available.\n        if (ext && Howler.codecs(ext)) {\n          url = self._src[i];\n          break;\n        }\n      }\n\n      if (!url) {\n        self._emit('loaderror', null, 'No codec support for selected audio sources.');\n        return;\n      }\n\n      self._src = url;\n      self._state = 'loading';\n\n      // If the hosting page is HTTPS and the source isn't,\n      // drop down to HTML5 Audio to avoid Mixed Content errors.\n      if (window.location.protocol === 'https:' && url.slice(0, 5) === 'http:') {\n        self._html5 = true;\n        self._webAudio = false;\n      }\n\n      // Create a new sound object and add it to the pool.\n      new Sound(self);\n\n      // Load and decode the audio data for playback.\n      if (self._webAudio) {\n        loadBuffer(self);\n      }\n\n      return self;\n    },\n\n    /**\n     * Play a sound or resume previous playback.\n     * @param  {String/Number} sprite   Sprite name for sprite playback or sound id to continue previous.\n     * @param  {Boolean} internal Internal Use: true prevents event firing.\n     * @return {Number}          Sound ID.\n     */\n    play: function(sprite, internal) {\n      var self = this;\n      var id = null;\n\n      // Determine if a sprite, sound id or nothing was passed\n      if (typeof sprite === 'number') {\n        id = sprite;\n        sprite = null;\n      } else if (typeof sprite === 'string' && self._state === 'loaded' && !self._sprite[sprite]) {\n        // If the passed sprite doesn't exist, do nothing.\n        return null;\n      } else if (typeof sprite === 'undefined') {\n        // Use the default sound sprite (plays the full audio length).\n        sprite = '__default';\n\n        // Check if there is a single paused sound that isn't ended.\n        // If there is, play that sound. If not, continue as usual.\n        if (!self._playLock) {\n          var num = 0;\n          for (var i=0; i<self._sounds.length; i++) {\n            if (self._sounds[i]._paused && !self._sounds[i]._ended) {\n              num++;\n              id = self._sounds[i]._id;\n            }\n          }\n\n          if (num === 1) {\n            sprite = null;\n          } else {\n            id = null;\n          }\n        }\n      }\n\n      // Get the selected node, or get one from the pool.\n      var sound = id ? self._soundById(id) : self._inactiveSound();\n\n      // If the sound doesn't exist, do nothing.\n      if (!sound) {\n        return null;\n      }\n\n      // Select the sprite definition.\n      if (id && !sprite) {\n        sprite = sound._sprite || '__default';\n      }\n\n      // If the sound hasn't loaded, we must wait to get the audio's duration.\n      // We also need to wait to make sure we don't run into race conditions with\n      // the order of function calls.\n      if (self._state !== 'loaded') {\n        // Set the sprite value on this sound.\n        sound._sprite = sprite;\n\n        // Mark this sound as not ended in case another sound is played before this one loads.\n        sound._ended = false;\n\n        // Add the sound to the queue to be played on load.\n        var soundId = sound._id;\n        self._queue.push({\n          event: 'play',\n          action: function() {\n            self.play(soundId);\n          }\n        });\n\n        return soundId;\n      }\n\n      // Don't play the sound if an id was passed and it is already playing.\n      if (id && !sound._paused) {\n        // Trigger the play event, in order to keep iterating through queue.\n        if (!internal) {\n          self._loadQueue('play');\n        }\n\n        return sound._id;\n      }\n\n      // Make sure the AudioContext isn't suspended, and resume it if it is.\n      if (self._webAudio) {\n        Howler._autoResume();\n      }\n\n      // Determine how long to play for and where to start playing.\n      var seek = Math.max(0, sound._seek > 0 ? sound._seek : self._sprite[sprite][0] / 1000);\n      var duration = Math.max(0, ((self._sprite[sprite][0] + self._sprite[sprite][1]) / 1000) - seek);\n      var timeout = (duration * 1000) / Math.abs(sound._rate);\n      var start = self._sprite[sprite][0] / 1000;\n      var stop = (self._sprite[sprite][0] + self._sprite[sprite][1]) / 1000;\n      sound._sprite = sprite;\n\n      // Mark the sound as ended instantly so that this async playback\n      // doesn't get grabbed by another call to play while this one waits to start.\n      sound._ended = false;\n\n      // Update the parameters of the sound.\n      var setParams = function() {\n        sound._paused = false;\n        sound._seek = seek;\n        sound._start = start;\n        sound._stop = stop;\n        sound._loop = !!(sound._loop || self._sprite[sprite][2]);\n      };\n\n      // End the sound instantly if seek is at the end.\n      if (seek >= stop) {\n        self._ended(sound);\n        return;\n      }\n\n      // Begin the actual playback.\n      var node = sound._node;\n      if (self._webAudio) {\n        // Fire this when the sound is ready to play to begin Web Audio playback.\n        var playWebAudio = function() {\n          self._playLock = false;\n          setParams();\n          self._refreshBuffer(sound);\n\n          // Setup the playback params.\n          var vol = (sound._muted || self._muted) ? 0 : sound._volume;\n          node.gain.setValueAtTime(vol, Howler.ctx.currentTime);\n          sound._playStart = Howler.ctx.currentTime;\n\n          // Play the sound using the supported method.\n          if (typeof node.bufferSource.start === 'undefined') {\n            sound._loop ? node.bufferSource.noteGrainOn(0, seek, 86400) : node.bufferSource.noteGrainOn(0, seek, duration);\n          } else {\n            sound._loop ? node.bufferSource.start(0, seek, 86400) : node.bufferSource.start(0, seek, duration);\n          }\n\n          // Start a new timer if none is present.\n          if (timeout !== Infinity) {\n            self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n          }\n\n          if (!internal) {\n            setTimeout(function() {\n              self._emit('play', sound._id);\n              self._loadQueue();\n            }, 0);\n          }\n        };\n\n        if (Howler.state === 'running' && Howler.ctx.state !== 'interrupted') {\n          playWebAudio();\n        } else {\n          self._playLock = true;\n\n          // Wait for the audio context to resume before playing.\n          self.once('resume', playWebAudio);\n\n          // Cancel the end timer.\n          self._clearTimer(sound._id);\n        }\n      } else {\n        // Fire this when the sound is ready to play to begin HTML5 Audio playback.\n        var playHtml5 = function() {\n          node.currentTime = seek;\n          node.muted = sound._muted || self._muted || Howler._muted || node.muted;\n          node.volume = sound._volume * Howler.volume();\n          node.playbackRate = sound._rate;\n\n          // Some browsers will throw an error if this is called without user interaction.\n          try {\n            var play = node.play();\n\n            // Support older browsers that don't support promises, and thus don't have this issue.\n            if (play && typeof Promise !== 'undefined' && (play instanceof Promise || typeof play.then === 'function')) {\n              // Implements a lock to prevent DOMException: The play() request was interrupted by a call to pause().\n              self._playLock = true;\n\n              // Set param values immediately.\n              setParams();\n\n              // Releases the lock and executes queued actions.\n              play\n                .then(function() {\n                  self._playLock = false;\n                  node._unlocked = true;\n                  if (!internal) {\n                    self._emit('play', sound._id);\n                  } else {\n                    self._loadQueue();\n                  }\n                })\n                .catch(function() {\n                  self._playLock = false;\n                  self._emit('playerror', sound._id, 'Playback was unable to start. This is most commonly an issue ' +\n                    'on mobile devices and Chrome where playback was not within a user interaction.');\n\n                  // Reset the ended and paused values.\n                  sound._ended = true;\n                  sound._paused = true;\n                });\n            } else if (!internal) {\n              self._playLock = false;\n              setParams();\n              self._emit('play', sound._id);\n            }\n\n            // Setting rate before playing won't work in IE, so we set it again here.\n            node.playbackRate = sound._rate;\n\n            // If the node is still paused, then we can assume there was a playback issue.\n            if (node.paused) {\n              self._emit('playerror', sound._id, 'Playback was unable to start. This is most commonly an issue ' +\n                'on mobile devices and Chrome where playback was not within a user interaction.');\n              return;\n            }\n\n            // Setup the end timer on sprites or listen for the ended event.\n            if (sprite !== '__default' || sound._loop) {\n              self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n            } else {\n              self._endTimers[sound._id] = function() {\n                // Fire ended on this audio node.\n                self._ended(sound);\n\n                // Clear this listener.\n                node.removeEventListener('ended', self._endTimers[sound._id], false);\n              };\n              node.addEventListener('ended', self._endTimers[sound._id], false);\n            }\n          } catch (err) {\n            self._emit('playerror', sound._id, err);\n          }\n        };\n\n        // If this is streaming audio, make sure the src is set and load again.\n        if (node.src === 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA') {\n          node.src = self._src;\n          node.load();\n        }\n\n        // Play immediately if ready, or wait for the 'canplaythrough'e vent.\n        var loadedNoReadyState = (window && window.ejecta) || (!node.readyState && Howler._navigator.isCocoonJS);\n        if (node.readyState >= 3 || loadedNoReadyState) {\n          playHtml5();\n        } else {\n          self._playLock = true;\n          self._state = 'loading';\n\n          var listener = function() {\n            self._state = 'loaded';\n            \n            // Begin playback.\n            playHtml5();\n\n            // Clear this listener.\n            node.removeEventListener(Howler._canPlayEvent, listener, false);\n          };\n          node.addEventListener(Howler._canPlayEvent, listener, false);\n\n          // Cancel the end timer.\n          self._clearTimer(sound._id);\n        }\n      }\n\n      return sound._id;\n    },\n\n    /**\n     * Pause playback and save current position.\n     * @param  {Number} id The sound ID (empty to pause all in group).\n     * @return {Howl}\n     */\n    pause: function(id) {\n      var self = this;\n\n      // If the sound hasn't loaded or a play() promise is pending, add it to the load queue to pause when capable.\n      if (self._state !== 'loaded' || self._playLock) {\n        self._queue.push({\n          event: 'pause',\n          action: function() {\n            self.pause(id);\n          }\n        });\n\n        return self;\n      }\n\n      // If no id is passed, get all ID's to be paused.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Clear the end timer.\n        self._clearTimer(ids[i]);\n\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound && !sound._paused) {\n          // Reset the seek position.\n          sound._seek = self.seek(ids[i]);\n          sound._rateSeek = 0;\n          sound._paused = true;\n\n          // Stop currently running fades.\n          self._stopFade(ids[i]);\n\n          if (sound._node) {\n            if (self._webAudio) {\n              // Make sure the sound has been created.\n              if (!sound._node.bufferSource) {\n                continue;\n              }\n\n              if (typeof sound._node.bufferSource.stop === 'undefined') {\n                sound._node.bufferSource.noteOff(0);\n              } else {\n                sound._node.bufferSource.stop(0);\n              }\n\n              // Clean up the buffer source.\n              self._cleanBuffer(sound._node);\n            } else if (!isNaN(sound._node.duration) || sound._node.duration === Infinity) {\n              sound._node.pause();\n            }\n          }\n        }\n\n        // Fire the pause event, unless `true` is passed as the 2nd argument.\n        if (!arguments[1]) {\n          self._emit('pause', sound ? sound._id : null);\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Stop playback and reset to start.\n     * @param  {Number} id The sound ID (empty to stop all in group).\n     * @param  {Boolean} internal Internal Use: true prevents event firing.\n     * @return {Howl}\n     */\n    stop: function(id, internal) {\n      var self = this;\n\n      // If the sound hasn't loaded, add it to the load queue to stop when capable.\n      if (self._state !== 'loaded' || self._playLock) {\n        self._queue.push({\n          event: 'stop',\n          action: function() {\n            self.stop(id);\n          }\n        });\n\n        return self;\n      }\n\n      // If no id is passed, get all ID's to be stopped.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Clear the end timer.\n        self._clearTimer(ids[i]);\n\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound) {\n          // Reset the seek position.\n          sound._seek = sound._start || 0;\n          sound._rateSeek = 0;\n          sound._paused = true;\n          sound._ended = true;\n\n          // Stop currently running fades.\n          self._stopFade(ids[i]);\n\n          if (sound._node) {\n            if (self._webAudio) {\n              // Make sure the sound's AudioBufferSourceNode has been created.\n              if (sound._node.bufferSource) {\n                if (typeof sound._node.bufferSource.stop === 'undefined') {\n                  sound._node.bufferSource.noteOff(0);\n                } else {\n                  sound._node.bufferSource.stop(0);\n                }\n\n                // Clean up the buffer source.\n                self._cleanBuffer(sound._node);\n              }\n            } else if (!isNaN(sound._node.duration) || sound._node.duration === Infinity) {\n              sound._node.currentTime = sound._start || 0;\n              sound._node.pause();\n\n              // If this is a live stream, stop download once the audio is stopped.\n              if (sound._node.duration === Infinity) {\n                self._clearSound(sound._node);\n              }\n            }\n          }\n\n          if (!internal) {\n            self._emit('stop', sound._id);\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Mute/unmute a single sound or all sounds in this Howl group.\n     * @param  {Boolean} muted Set to true to mute and false to unmute.\n     * @param  {Number} id    The sound ID to update (omit to mute/unmute all).\n     * @return {Howl}\n     */\n    mute: function(muted, id) {\n      var self = this;\n\n      // If the sound hasn't loaded, add it to the load queue to mute when capable.\n      if (self._state !== 'loaded'|| self._playLock) {\n        self._queue.push({\n          event: 'mute',\n          action: function() {\n            self.mute(muted, id);\n          }\n        });\n\n        return self;\n      }\n\n      // If applying mute/unmute to all sounds, update the group's value.\n      if (typeof id === 'undefined') {\n        if (typeof muted === 'boolean') {\n          self._muted = muted;\n        } else {\n          return self._muted;\n        }\n      }\n\n      // If no id is passed, get all ID's to be muted.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound) {\n          sound._muted = muted;\n\n          // Cancel active fade and set the volume to the end value.\n          if (sound._interval) {\n            self._stopFade(sound._id);\n          }\n\n          if (self._webAudio && sound._node) {\n            sound._node.gain.setValueAtTime(muted ? 0 : sound._volume, Howler.ctx.currentTime);\n          } else if (sound._node) {\n            sound._node.muted = Howler._muted ? true : muted;\n          }\n\n          self._emit('mute', sound._id);\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the volume of this sound or of the Howl group. This method can optionally take 0, 1 or 2 arguments.\n     *   volume() -> Returns the group's volume value.\n     *   volume(id) -> Returns the sound id's current volume.\n     *   volume(vol) -> Sets the volume of all sounds in this Howl group.\n     *   volume(vol, id) -> Sets the volume of passed sound id.\n     * @return {Howl/Number} Returns self or current volume.\n     */\n    volume: function() {\n      var self = this;\n      var args = arguments;\n      var vol, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // Return the value of the groups' volume.\n        return self._volume;\n      } else if (args.length === 1 || args.length === 2 && typeof args[1] === 'undefined') {\n        // First check if this is an ID, and if not, assume it is a new volume.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else {\n          vol = parseFloat(args[0]);\n        }\n      } else if (args.length >= 2) {\n        vol = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // Update the volume or return the current volume.\n      var sound;\n      if (typeof vol !== 'undefined' && vol >= 0 && vol <= 1) {\n        // If the sound hasn't loaded, add it to the load queue to change volume when capable.\n        if (self._state !== 'loaded'|| self._playLock) {\n          self._queue.push({\n            event: 'volume',\n            action: function() {\n              self.volume.apply(self, args);\n            }\n          });\n\n          return self;\n        }\n\n        // Set the group volume.\n        if (typeof id === 'undefined') {\n          self._volume = vol;\n        }\n\n        // Update one or all volumes.\n        id = self._getSoundIds(id);\n        for (var i=0; i<id.length; i++) {\n          // Get the sound.\n          sound = self._soundById(id[i]);\n\n          if (sound) {\n            sound._volume = vol;\n\n            // Stop currently running fades.\n            if (!args[2]) {\n              self._stopFade(id[i]);\n            }\n\n            if (self._webAudio && sound._node && !sound._muted) {\n              sound._node.gain.setValueAtTime(vol, Howler.ctx.currentTime);\n            } else if (sound._node && !sound._muted) {\n              sound._node.volume = vol * Howler.volume();\n            }\n\n            self._emit('volume', sound._id);\n          }\n        }\n      } else {\n        sound = id ? self._soundById(id) : self._sounds[0];\n        return sound ? sound._volume : 0;\n      }\n\n      return self;\n    },\n\n    /**\n     * Fade a currently playing sound between two volumes (if no id is passed, all sounds will fade).\n     * @param  {Number} from The value to fade from (0.0 to 1.0).\n     * @param  {Number} to   The volume to fade to (0.0 to 1.0).\n     * @param  {Number} len  Time in milliseconds to fade.\n     * @param  {Number} id   The sound id (omit to fade all sounds).\n     * @return {Howl}\n     */\n    fade: function(from, to, len, id) {\n      var self = this;\n\n      // If the sound hasn't loaded, add it to the load queue to fade when capable.\n      if (self._state !== 'loaded' || self._playLock) {\n        self._queue.push({\n          event: 'fade',\n          action: function() {\n            self.fade(from, to, len, id);\n          }\n        });\n\n        return self;\n      }\n\n      // Make sure the to/from/len values are numbers.\n      from = Math.min(Math.max(0, parseFloat(from)), 1);\n      to = Math.min(Math.max(0, parseFloat(to)), 1);\n      len = parseFloat(len);\n\n      // Set the volume to the start position.\n      self.volume(from, id);\n\n      // Fade the volume of one or all sounds.\n      var ids = self._getSoundIds(id);\n      for (var i=0; i<ids.length; i++) {\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        // Create a linear fade or fall back to timeouts with HTML5 Audio.\n        if (sound) {\n          // Stop the previous fade if no sprite is being used (otherwise, volume handles this).\n          if (!id) {\n            self._stopFade(ids[i]);\n          }\n\n          // If we are using Web Audio, let the native methods do the actual fade.\n          if (self._webAudio && !sound._muted) {\n            var currentTime = Howler.ctx.currentTime;\n            var end = currentTime + (len / 1000);\n            sound._volume = from;\n            sound._node.gain.setValueAtTime(from, currentTime);\n            sound._node.gain.linearRampToValueAtTime(to, end);\n          }\n\n          self._startFadeInterval(sound, from, to, len, ids[i], typeof id === 'undefined');\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Starts the internal interval to fade a sound.\n     * @param  {Object} sound Reference to sound to fade.\n     * @param  {Number} from The value to fade from (0.0 to 1.0).\n     * @param  {Number} to   The volume to fade to (0.0 to 1.0).\n     * @param  {Number} len  Time in milliseconds to fade.\n     * @param  {Number} id   The sound id to fade.\n     * @param  {Boolean} isGroup   If true, set the volume on the group.\n     */\n    _startFadeInterval: function(sound, from, to, len, id, isGroup) {\n      var self = this;\n      var vol = from;\n      var diff = to - from;\n      var steps = Math.abs(diff / 0.01);\n      var stepLen = Math.max(4, (steps > 0) ? len / steps : len);\n      var lastTick = Date.now();\n\n      // Store the value being faded to.\n      sound._fadeTo = to;\n\n      // Update the volume value on each interval tick.\n      sound._interval = setInterval(function() {\n        // Update the volume based on the time since the last tick.\n        var tick = (Date.now() - lastTick) / len;\n        lastTick = Date.now();\n        vol += diff * tick;\n\n        // Round to within 2 decimal points.\n        vol = Math.round(vol * 100) / 100;\n\n        // Make sure the volume is in the right bounds.\n        if (diff < 0) {\n          vol = Math.max(to, vol);\n        } else {\n          vol = Math.min(to, vol);\n        }\n\n        // Change the volume.\n        if (self._webAudio) {\n          sound._volume = vol;\n        } else {\n          self.volume(vol, sound._id, true);\n        }\n\n        // Set the group's volume.\n        if (isGroup) {\n          self._volume = vol;\n        }\n\n        // When the fade is complete, stop it and fire event.\n        if ((to < from && vol <= to) || (to > from && vol >= to)) {\n          clearInterval(sound._interval);\n          sound._interval = null;\n          sound._fadeTo = null;\n          self.volume(to, sound._id);\n          self._emit('fade', sound._id);\n        }\n      }, stepLen);\n    },\n\n    /**\n     * Internal method that stops the currently playing fade when\n     * a new fade starts, volume is changed or the sound is stopped.\n     * @param  {Number} id The sound id.\n     * @return {Howl}\n     */\n    _stopFade: function(id) {\n      var self = this;\n      var sound = self._soundById(id);\n\n      if (sound && sound._interval) {\n        if (self._webAudio) {\n          sound._node.gain.cancelScheduledValues(Howler.ctx.currentTime);\n        }\n\n        clearInterval(sound._interval);\n        sound._interval = null;\n        self.volume(sound._fadeTo, id);\n        sound._fadeTo = null;\n        self._emit('fade', id);\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the loop parameter on a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   loop() -> Returns the group's loop value.\n     *   loop(id) -> Returns the sound id's loop value.\n     *   loop(loop) -> Sets the loop value for all sounds in this Howl group.\n     *   loop(loop, id) -> Sets the loop value of passed sound id.\n     * @return {Howl/Boolean} Returns self or current loop value.\n     */\n    loop: function() {\n      var self = this;\n      var args = arguments;\n      var loop, id, sound;\n\n      // Determine the values for loop and id.\n      if (args.length === 0) {\n        // Return the grou's loop value.\n        return self._loop;\n      } else if (args.length === 1) {\n        if (typeof args[0] === 'boolean') {\n          loop = args[0];\n          self._loop = loop;\n        } else {\n          // Return this sound's loop value.\n          sound = self._soundById(parseInt(args[0], 10));\n          return sound ? sound._loop : false;\n        }\n      } else if (args.length === 2) {\n        loop = args[0];\n        id = parseInt(args[1], 10);\n      }\n\n      // If no id is passed, get all ID's to be looped.\n      var ids = self._getSoundIds(id);\n      for (var i=0; i<ids.length; i++) {\n        sound = self._soundById(ids[i]);\n\n        if (sound) {\n          sound._loop = loop;\n          if (self._webAudio && sound._node && sound._node.bufferSource) {\n            sound._node.bufferSource.loop = loop;\n            if (loop) {\n              sound._node.bufferSource.loopStart = sound._start || 0;\n              sound._node.bufferSource.loopEnd = sound._stop;\n\n              // If playing, restart playback to ensure looping updates.\n              if (self.playing(ids[i])) {\n                self.pause(ids[i], true);\n                self.play(ids[i], true);\n              }\n            }\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the playback rate of a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   rate() -> Returns the first sound node's current playback rate.\n     *   rate(id) -> Returns the sound id's current playback rate.\n     *   rate(rate) -> Sets the playback rate of all sounds in this Howl group.\n     *   rate(rate, id) -> Sets the playback rate of passed sound id.\n     * @return {Howl/Number} Returns self or the current playback rate.\n     */\n    rate: function() {\n      var self = this;\n      var args = arguments;\n      var rate, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // We will simply return the current rate of the first node.\n        id = self._sounds[0]._id;\n      } else if (args.length === 1) {\n        // First check if this is an ID, and if not, assume it is a new rate value.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else {\n          rate = parseFloat(args[0]);\n        }\n      } else if (args.length === 2) {\n        rate = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // Update the playback rate or return the current value.\n      var sound;\n      if (typeof rate === 'number') {\n        // If the sound hasn't loaded, add it to the load queue to change playback rate when capable.\n        if (self._state !== 'loaded' || self._playLock) {\n          self._queue.push({\n            event: 'rate',\n            action: function() {\n              self.rate.apply(self, args);\n            }\n          });\n\n          return self;\n        }\n\n        // Set the group rate.\n        if (typeof id === 'undefined') {\n          self._rate = rate;\n        }\n\n        // Update one or all volumes.\n        id = self._getSoundIds(id);\n        for (var i=0; i<id.length; i++) {\n          // Get the sound.\n          sound = self._soundById(id[i]);\n\n          if (sound) {\n            // Keep track of our position when the rate changed and update the playback\n            // start position so we can properly adjust the seek position for time elapsed.\n            if (self.playing(id[i])) {\n              sound._rateSeek = self.seek(id[i]);\n              sound._playStart = self._webAudio ? Howler.ctx.currentTime : sound._playStart;\n            }\n            sound._rate = rate;\n\n            // Change the playback rate.\n            if (self._webAudio && sound._node && sound._node.bufferSource) {\n              sound._node.bufferSource.playbackRate.setValueAtTime(rate, Howler.ctx.currentTime);\n            } else if (sound._node) {\n              sound._node.playbackRate = rate;\n            }\n\n            // Reset the timers.\n            var seek = self.seek(id[i]);\n            var duration = ((self._sprite[sound._sprite][0] + self._sprite[sound._sprite][1]) / 1000) - seek;\n            var timeout = (duration * 1000) / Math.abs(sound._rate);\n\n            // Start a new end timer if sound is already playing.\n            if (self._endTimers[id[i]] || !sound._paused) {\n              self._clearTimer(id[i]);\n              self._endTimers[id[i]] = setTimeout(self._ended.bind(self, sound), timeout);\n            }\n\n            self._emit('rate', sound._id);\n          }\n        }\n      } else {\n        sound = self._soundById(id);\n        return sound ? sound._rate : self._rate;\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the seek position of a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   seek() -> Returns the first sound node's current seek position.\n     *   seek(id) -> Returns the sound id's current seek position.\n     *   seek(seek) -> Sets the seek position of the first sound node.\n     *   seek(seek, id) -> Sets the seek position of passed sound id.\n     * @return {Howl/Number} Returns self or the current seek position.\n     */\n    seek: function() {\n      var self = this;\n      var args = arguments;\n      var seek, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // We will simply return the current position of the first node.\n        if (self._sounds.length) {\n          id = self._sounds[0]._id;\n        }\n      } else if (args.length === 1) {\n        // First check if this is an ID, and if not, assume it is a new seek position.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else if (self._sounds.length) {\n          id = self._sounds[0]._id;\n          seek = parseFloat(args[0]);\n        }\n      } else if (args.length === 2) {\n        seek = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // If there is no ID, bail out.\n      if (typeof id === 'undefined') {\n        return 0;\n      }\n\n      // If the sound hasn't loaded, add it to the load queue to seek when capable.\n      if (typeof seek === 'number' && (self._state !== 'loaded' || self._playLock)) {\n        self._queue.push({\n          event: 'seek',\n          action: function() {\n            self.seek.apply(self, args);\n          }\n        });\n\n        return self;\n      }\n\n      // Get the sound.\n      var sound = self._soundById(id);\n\n      if (sound) {\n        if (typeof seek === 'number' && seek >= 0) {\n          // Pause the sound and update position for restarting playback.\n          var playing = self.playing(id);\n          if (playing) {\n            self.pause(id, true);\n          }\n\n          // Move the position of the track and cancel timer.\n          sound._seek = seek;\n          sound._ended = false;\n          self._clearTimer(id);\n\n          // Update the seek position for HTML5 Audio.\n          if (!self._webAudio && sound._node && !isNaN(sound._node.duration)) {\n            sound._node.currentTime = seek;\n          }\n\n          // Seek and emit when ready.\n          var seekAndEmit = function() {\n            // Restart the playback if the sound was playing.\n            if (playing) {\n              self.play(id, true);\n            }\n\n            self._emit('seek', id);\n          };\n\n          // Wait for the play lock to be unset before emitting (HTML5 Audio).\n          if (playing && !self._webAudio) {\n            var emitSeek = function() {\n              if (!self._playLock) {\n                seekAndEmit();\n              } else {\n                setTimeout(emitSeek, 0);\n              }\n            };\n            setTimeout(emitSeek, 0);\n          } else {\n            seekAndEmit();\n          }\n        } else {\n          if (self._webAudio) {\n            var realTime = self.playing(id) ? Howler.ctx.currentTime - sound._playStart : 0;\n            var rateSeek = sound._rateSeek ? sound._rateSeek - sound._seek : 0;\n            return sound._seek + (rateSeek + realTime * Math.abs(sound._rate));\n          } else {\n            return sound._node.currentTime;\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Check if a specific sound is currently playing or not (if id is provided), or check if at least one of the sounds in the group is playing or not.\n     * @param  {Number}  id The sound id to check. If none is passed, the whole sound group is checked.\n     * @return {Boolean} True if playing and false if not.\n     */\n    playing: function(id) {\n      var self = this;\n\n      // Check the passed sound ID (if any).\n      if (typeof id === 'number') {\n        var sound = self._soundById(id);\n        return sound ? !sound._paused : false;\n      }\n\n      // Otherwise, loop through all sounds and check if any are playing.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (!self._sounds[i]._paused) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    /**\n     * Get the duration of this sound. Passing a sound id will return the sprite duration.\n     * @param  {Number} id The sound id to check. If none is passed, return full source duration.\n     * @return {Number} Audio duration in seconds.\n     */\n    duration: function(id) {\n      var self = this;\n      var duration = self._duration;\n\n      // If we pass an ID, get the sound and return the sprite length.\n      var sound = self._soundById(id);\n      if (sound) {\n        duration = self._sprite[sound._sprite][1] / 1000;\n      }\n\n      return duration;\n    },\n\n    /**\n     * Returns the current loaded state of this Howl.\n     * @return {String} 'unloaded', 'loading', 'loaded'\n     */\n    state: function() {\n      return this._state;\n    },\n\n    /**\n     * Unload and destroy the current Howl object.\n     * This will immediately stop all sound instances attached to this group.\n     */\n    unload: function() {\n      var self = this;\n\n      // Stop playing any active sounds.\n      var sounds = self._sounds;\n      for (var i=0; i<sounds.length; i++) {\n        // Stop the sound if it is currently playing.\n        if (!sounds[i]._paused) {\n          self.stop(sounds[i]._id);\n        }\n\n        // Remove the source or disconnect.\n        if (!self._webAudio) {\n          // Set the source to 0-second silence to stop any downloading (except in IE).\n          self._clearSound(sounds[i]._node);\n\n          // Remove any event listeners.\n          sounds[i]._node.removeEventListener('error', sounds[i]._errorFn, false);\n          sounds[i]._node.removeEventListener(Howler._canPlayEvent, sounds[i]._loadFn, false);\n          sounds[i]._node.removeEventListener('ended', sounds[i]._endFn, false);\n\n          // Release the Audio object back to the pool.\n          Howler._releaseHtml5Audio(sounds[i]._node);\n        }\n\n        // Empty out all of the nodes.\n        delete sounds[i]._node;\n\n        // Make sure all timers are cleared out.\n        self._clearTimer(sounds[i]._id);\n      }\n\n      // Remove the references in the global Howler object.\n      var index = Howler._howls.indexOf(self);\n      if (index >= 0) {\n        Howler._howls.splice(index, 1);\n      }\n\n      // Delete this sound from the cache (if no other Howl is using it).\n      var remCache = true;\n      for (i=0; i<Howler._howls.length; i++) {\n        if (Howler._howls[i]._src === self._src || self._src.indexOf(Howler._howls[i]._src) >= 0) {\n          remCache = false;\n          break;\n        }\n      }\n\n      if (cache && remCache) {\n        delete cache[self._src];\n      }\n\n      // Clear global errors.\n      Howler.noAudio = false;\n\n      // Clear out `self`.\n      self._state = 'unloaded';\n      self._sounds = [];\n      self = null;\n\n      return null;\n    },\n\n    /**\n     * Listen to a custom event.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to call.\n     * @param  {Number}   id    (optional) Only listen to events for this sound.\n     * @param  {Number}   once  (INTERNAL) Marks event to fire only once.\n     * @return {Howl}\n     */\n    on: function(event, fn, id, once) {\n      var self = this;\n      var events = self['_on' + event];\n\n      if (typeof fn === 'function') {\n        events.push(once ? {id: id, fn: fn, once: once} : {id: id, fn: fn});\n      }\n\n      return self;\n    },\n\n    /**\n     * Remove a custom event. Call without parameters to remove all events.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to remove. Leave empty to remove all.\n     * @param  {Number}   id    (optional) Only remove events for this sound.\n     * @return {Howl}\n     */\n    off: function(event, fn, id) {\n      var self = this;\n      var events = self['_on' + event];\n      var i = 0;\n\n      // Allow passing just an event and ID.\n      if (typeof fn === 'number') {\n        id = fn;\n        fn = null;\n      }\n\n      if (fn || id) {\n        // Loop through event store and remove the passed function.\n        for (i=0; i<events.length; i++) {\n          var isId = (id === events[i].id);\n          if (fn === events[i].fn && isId || !fn && isId) {\n            events.splice(i, 1);\n            break;\n          }\n        }\n      } else if (event) {\n        // Clear out all events of this type.\n        self['_on' + event] = [];\n      } else {\n        // Clear out all events of every type.\n        var keys = Object.keys(self);\n        for (i=0; i<keys.length; i++) {\n          if ((keys[i].indexOf('_on') === 0) && Array.isArray(self[keys[i]])) {\n            self[keys[i]] = [];\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Listen to a custom event and remove it once fired.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to call.\n     * @param  {Number}   id    (optional) Only listen to events for this sound.\n     * @return {Howl}\n     */\n    once: function(event, fn, id) {\n      var self = this;\n\n      // Setup the event listener.\n      self.on(event, fn, id, 1);\n\n      return self;\n    },\n\n    /**\n     * Emit all events of a specific type and pass the sound id.\n     * @param  {String} event Event name.\n     * @param  {Number} id    Sound ID.\n     * @param  {Number} msg   Message to go with event.\n     * @return {Howl}\n     */\n    _emit: function(event, id, msg) {\n      var self = this;\n      var events = self['_on' + event];\n\n      // Loop through event store and fire all functions.\n      for (var i=events.length-1; i>=0; i--) {\n        // Only fire the listener if the correct ID is used.\n        if (!events[i].id || events[i].id === id || event === 'load') {\n          setTimeout(function(fn) {\n            fn.call(this, id, msg);\n          }.bind(self, events[i].fn), 0);\n\n          // If this event was setup with `once`, remove it.\n          if (events[i].once) {\n            self.off(event, events[i].fn, events[i].id);\n          }\n        }\n      }\n\n      // Pass the event type into load queue so that it can continue stepping.\n      self._loadQueue(event);\n\n      return self;\n    },\n\n    /**\n     * Queue of actions initiated before the sound has loaded.\n     * These will be called in sequence, with the next only firing\n     * after the previous has finished executing (even if async like play).\n     * @return {Howl}\n     */\n    _loadQueue: function(event) {\n      var self = this;\n\n      if (self._queue.length > 0) {\n        var task = self._queue[0];\n\n        // Remove this task if a matching event was passed.\n        if (task.event === event) {\n          self._queue.shift();\n          self._loadQueue();\n        }\n\n        // Run the task if no event type is passed.\n        if (!event) {\n          task.action();\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Fired when playback ends at the end of the duration.\n     * @param  {Sound} sound The sound object to work with.\n     * @return {Howl}\n     */\n    _ended: function(sound) {\n      var self = this;\n      var sprite = sound._sprite;\n\n      // If we are using IE and there was network latency we may be clipping\n      // audio before it completes playing. Lets check the node to make sure it\n      // believes it has completed, before ending the playback.\n      if (!self._webAudio && sound._node && !sound._node.paused && !sound._node.ended && sound._node.currentTime < sound._stop) {\n        setTimeout(self._ended.bind(self, sound), 100);\n        return self;\n      }\n\n      // Should this sound loop?\n      var loop = !!(sound._loop || self._sprite[sprite][2]);\n\n      // Fire the ended event.\n      self._emit('end', sound._id);\n\n      // Restart the playback for HTML5 Audio loop.\n      if (!self._webAudio && loop) {\n        self.stop(sound._id, true).play(sound._id);\n      }\n\n      // Restart this timer if on a Web Audio loop.\n      if (self._webAudio && loop) {\n        self._emit('play', sound._id);\n        sound._seek = sound._start || 0;\n        sound._rateSeek = 0;\n        sound._playStart = Howler.ctx.currentTime;\n\n        var timeout = ((sound._stop - sound._start) * 1000) / Math.abs(sound._rate);\n        self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n      }\n\n      // Mark the node as paused.\n      if (self._webAudio && !loop) {\n        sound._paused = true;\n        sound._ended = true;\n        sound._seek = sound._start || 0;\n        sound._rateSeek = 0;\n        self._clearTimer(sound._id);\n\n        // Clean up the buffer source.\n        self._cleanBuffer(sound._node);\n\n        // Attempt to auto-suspend AudioContext if no sounds are still playing.\n        Howler._autoSuspend();\n      }\n\n      // When using a sprite, end the track.\n      if (!self._webAudio && !loop) {\n        self.stop(sound._id, true);\n      }\n\n      return self;\n    },\n\n    /**\n     * Clear the end timer for a sound playback.\n     * @param  {Number} id The sound ID.\n     * @return {Howl}\n     */\n    _clearTimer: function(id) {\n      var self = this;\n\n      if (self._endTimers[id]) {\n        // Clear the timeout or remove the ended listener.\n        if (typeof self._endTimers[id] !== 'function') {\n          clearTimeout(self._endTimers[id]);\n        } else {\n          var sound = self._soundById(id);\n          if (sound && sound._node) {\n            sound._node.removeEventListener('ended', self._endTimers[id], false);\n          }\n        }\n\n        delete self._endTimers[id];\n      }\n\n      return self;\n    },\n\n    /**\n     * Return the sound identified by this ID, or return null.\n     * @param  {Number} id Sound ID\n     * @return {Object}    Sound object or null.\n     */\n    _soundById: function(id) {\n      var self = this;\n\n      // Loop through all sounds and find the one with this ID.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (id === self._sounds[i]._id) {\n          return self._sounds[i];\n        }\n      }\n\n      return null;\n    },\n\n    /**\n     * Return an inactive sound from the pool or create a new one.\n     * @return {Sound} Sound playback object.\n     */\n    _inactiveSound: function() {\n      var self = this;\n\n      self._drain();\n\n      // Find the first inactive node to recycle.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (self._sounds[i]._ended) {\n          return self._sounds[i].reset();\n        }\n      }\n\n      // If no inactive node was found, create a new one.\n      return new Sound(self);\n    },\n\n    /**\n     * Drain excess inactive sounds from the pool.\n     */\n    _drain: function() {\n      var self = this;\n      var limit = self._pool;\n      var cnt = 0;\n      var i = 0;\n\n      // If there are less sounds than the max pool size, we are done.\n      if (self._sounds.length < limit) {\n        return;\n      }\n\n      // Count the number of inactive sounds.\n      for (i=0; i<self._sounds.length; i++) {\n        if (self._sounds[i]._ended) {\n          cnt++;\n        }\n      }\n\n      // Remove excess inactive sounds, going in reverse order.\n      for (i=self._sounds.length - 1; i>=0; i--) {\n        if (cnt <= limit) {\n          return;\n        }\n\n        if (self._sounds[i]._ended) {\n          // Disconnect the audio source when using Web Audio.\n          if (self._webAudio && self._sounds[i]._node) {\n            self._sounds[i]._node.disconnect(0);\n          }\n\n          // Remove sounds until we have the pool size.\n          self._sounds.splice(i, 1);\n          cnt--;\n        }\n      }\n    },\n\n    /**\n     * Get all ID's from the sounds pool.\n     * @param  {Number} id Only return one ID if one is passed.\n     * @return {Array}    Array of IDs.\n     */\n    _getSoundIds: function(id) {\n      var self = this;\n\n      if (typeof id === 'undefined') {\n        var ids = [];\n        for (var i=0; i<self._sounds.length; i++) {\n          ids.push(self._sounds[i]._id);\n        }\n\n        return ids;\n      } else {\n        return [id];\n      }\n    },\n\n    /**\n     * Load the sound back into the buffer source.\n     * @param  {Sound} sound The sound object to work with.\n     * @return {Howl}\n     */\n    _refreshBuffer: function(sound) {\n      var self = this;\n\n      // Setup the buffer source for playback.\n      sound._node.bufferSource = Howler.ctx.createBufferSource();\n      sound._node.bufferSource.buffer = cache[self._src];\n\n      // Connect to the correct node.\n      if (sound._panner) {\n        sound._node.bufferSource.connect(sound._panner);\n      } else {\n        sound._node.bufferSource.connect(sound._node);\n      }\n\n      // Setup looping and playback rate.\n      sound._node.bufferSource.loop = sound._loop;\n      if (sound._loop) {\n        sound._node.bufferSource.loopStart = sound._start || 0;\n        sound._node.bufferSource.loopEnd = sound._stop || 0;\n      }\n      sound._node.bufferSource.playbackRate.setValueAtTime(sound._rate, Howler.ctx.currentTime);\n\n      return self;\n    },\n\n    /**\n     * Prevent memory leaks by cleaning up the buffer source after playback.\n     * @param  {Object} node Sound's audio node containing the buffer source.\n     * @return {Howl}\n     */\n    _cleanBuffer: function(node) {\n      var self = this;\n      var isIOS = Howler._navigator && Howler._navigator.vendor.indexOf('Apple') >= 0;\n\n      if (!node.bufferSource) {\n        return self;\n      }\n\n      if (Howler._scratchBuffer && node.bufferSource) {\n        node.bufferSource.onended = null;\n        node.bufferSource.disconnect(0);\n        if (isIOS) {\n          try { node.bufferSource.buffer = Howler._scratchBuffer; } catch(e) {}\n        }\n      }\n      node.bufferSource = null;\n\n      return self;\n    },\n\n    /**\n     * Set the source to a 0-second silence to stop any downloading (except in IE).\n     * @param  {Object} node Audio node to clear.\n     */\n    _clearSound: function(node) {\n      var checkIE = /MSIE |Trident\\//.test(Howler._navigator && Howler._navigator.userAgent);\n      if (!checkIE) {\n        node.src = 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA';\n      }\n    }\n  };\n\n  /** Single Sound Methods **/\n  /***************************************************************************/\n\n  /**\n   * Setup the sound object, which each node attached to a Howl group is contained in.\n   * @param {Object} howl The Howl parent group.\n   */\n  var Sound = function(howl) {\n    this._parent = howl;\n    this.init();\n  };\n  Sound.prototype = {\n    /**\n     * Initialize a new Sound object.\n     * @return {Sound}\n     */\n    init: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Setup the default parameters.\n      self._muted = parent._muted;\n      self._loop = parent._loop;\n      self._volume = parent._volume;\n      self._rate = parent._rate;\n      self._seek = 0;\n      self._paused = true;\n      self._ended = true;\n      self._sprite = '__default';\n\n      // Generate a unique ID for this sound.\n      self._id = ++Howler._counter;\n\n      // Add itself to the parent's pool.\n      parent._sounds.push(self);\n\n      // Create the new node.\n      self.create();\n\n      return self;\n    },\n\n    /**\n     * Create and setup a new sound object, whether HTML5 Audio or Web Audio.\n     * @return {Sound}\n     */\n    create: function() {\n      var self = this;\n      var parent = self._parent;\n      var volume = (Howler._muted || self._muted || self._parent._muted) ? 0 : self._volume;\n\n      if (parent._webAudio) {\n        // Create the gain node for controlling volume (the source will connect to this).\n        self._node = (typeof Howler.ctx.createGain === 'undefined') ? Howler.ctx.createGainNode() : Howler.ctx.createGain();\n        self._node.gain.setValueAtTime(volume, Howler.ctx.currentTime);\n        self._node.paused = true;\n        self._node.connect(Howler.masterGain);\n      } else if (!Howler.noAudio) {\n        // Get an unlocked Audio object from the pool.\n        self._node = Howler._obtainHtml5Audio();\n\n        // Listen for errors (http://dev.w3.org/html5/spec-author-view/spec.html#mediaerror).\n        self._errorFn = self._errorListener.bind(self);\n        self._node.addEventListener('error', self._errorFn, false);\n\n        // Listen for 'canplaythrough' event to let us know the sound is ready.\n        self._loadFn = self._loadListener.bind(self);\n        self._node.addEventListener(Howler._canPlayEvent, self._loadFn, false);\n\n        // Listen for the 'ended' event on the sound to account for edge-case where\n        // a finite sound has a duration of Infinity.\n        self._endFn = self._endListener.bind(self);\n        self._node.addEventListener('ended', self._endFn, false);\n\n        // Setup the new audio node.\n        self._node.src = parent._src;\n        self._node.preload = parent._preload === true ? 'auto' : parent._preload;\n        self._node.volume = volume * Howler.volume();\n\n        // Begin loading the source.\n        self._node.load();\n      }\n\n      return self;\n    },\n\n    /**\n     * Reset the parameters of this sound to the original state (for recycle).\n     * @return {Sound}\n     */\n    reset: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Reset all of the parameters of this sound.\n      self._muted = parent._muted;\n      self._loop = parent._loop;\n      self._volume = parent._volume;\n      self._rate = parent._rate;\n      self._seek = 0;\n      self._rateSeek = 0;\n      self._paused = true;\n      self._ended = true;\n      self._sprite = '__default';\n\n      // Generate a new ID so that it isn't confused with the previous sound.\n      self._id = ++Howler._counter;\n\n      return self;\n    },\n\n    /**\n     * HTML5 Audio error listener callback.\n     */\n    _errorListener: function() {\n      var self = this;\n\n      // Fire an error event and pass back the code.\n      self._parent._emit('loaderror', self._id, self._node.error ? self._node.error.code : 0);\n\n      // Clear the event listener.\n      self._node.removeEventListener('error', self._errorFn, false);\n    },\n\n    /**\n     * HTML5 Audio canplaythrough listener callback.\n     */\n    _loadListener: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Round up the duration to account for the lower precision in HTML5 Audio.\n      parent._duration = Math.ceil(self._node.duration * 10) / 10;\n\n      // Setup a sprite if none is defined.\n      if (Object.keys(parent._sprite).length === 0) {\n        parent._sprite = {__default: [0, parent._duration * 1000]};\n      }\n\n      if (parent._state !== 'loaded') {\n        parent._state = 'loaded';\n        parent._emit('load');\n        parent._loadQueue();\n      }\n\n      // Clear the event listener.\n      self._node.removeEventListener(Howler._canPlayEvent, self._loadFn, false);\n    },\n\n    /**\n     * HTML5 Audio ended listener callback.\n     */\n    _endListener: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Only handle the `ended`` event if the duration is Infinity.\n      if (parent._duration === Infinity) {\n        // Update the parent duration to match the real audio duration.\n        // Round up the duration to account for the lower precision in HTML5 Audio.\n        parent._duration = Math.ceil(self._node.duration * 10) / 10;\n\n        // Update the sprite that corresponds to the real duration.\n        if (parent._sprite.__default[1] === Infinity) {\n          parent._sprite.__default[1] = parent._duration * 1000;\n        }\n\n        // Run the regular ended method.\n        parent._ended(self);\n      }\n\n      // Clear the event listener since the duration is now correct.\n      self._node.removeEventListener('ended', self._endFn, false);\n    }\n  };\n\n  /** Helper Methods **/\n  /***************************************************************************/\n\n  var cache = {};\n\n  /**\n   * Buffer a sound from URL, Data URI or cache and decode to audio source (Web Audio API).\n   * @param  {Howl} self\n   */\n  var loadBuffer = function(self) {\n    var url = self._src;\n\n    // Check if the buffer has already been cached and use it instead.\n    if (cache[url]) {\n      // Set the duration from the cache.\n      self._duration = cache[url].duration;\n\n      // Load the sound into this Howl.\n      loadSound(self);\n\n      return;\n    }\n\n    if (/^data:[^;]+;base64,/.test(url)) {\n      // Decode the base64 data URI without XHR, since some browsers don't support it.\n      var data = atob(url.split(',')[1]);\n      var dataView = new Uint8Array(data.length);\n      for (var i=0; i<data.length; ++i) {\n        dataView[i] = data.charCodeAt(i);\n      }\n\n      decodeAudioData(dataView.buffer, self);\n    } else {\n      // Load the buffer from the URL.\n      var xhr = new XMLHttpRequest();\n      xhr.open(self._xhr.method, url, true);\n      xhr.withCredentials = self._xhr.withCredentials;\n      xhr.responseType = 'arraybuffer';\n\n      // Apply any custom headers to the request.\n      if (self._xhr.headers) {\n        Object.keys(self._xhr.headers).forEach(function(key) {\n          xhr.setRequestHeader(key, self._xhr.headers[key]);\n        });\n      }\n\n      xhr.onload = function() {\n        // Make sure we get a successful response back.\n        var code = (xhr.status + '')[0];\n        if (code !== '0' && code !== '2' && code !== '3') {\n          self._emit('loaderror', null, 'Failed loading audio file with status: ' + xhr.status + '.');\n          return;\n        }\n\n        decodeAudioData(xhr.response, self);\n      };\n      xhr.onerror = function() {\n        // If there is an error, switch to HTML5 Audio.\n        if (self._webAudio) {\n          self._html5 = true;\n          self._webAudio = false;\n          self._sounds = [];\n          delete cache[url];\n          self.load();\n        }\n      };\n      safeXhrSend(xhr);\n    }\n  };\n\n  /**\n   * Send the XHR request wrapped in a try/catch.\n   * @param  {Object} xhr XHR to send.\n   */\n  var safeXhrSend = function(xhr) {\n    try {\n      xhr.send();\n    } catch (e) {\n      xhr.onerror();\n    }\n  };\n\n  /**\n   * Decode audio data from an array buffer.\n   * @param  {ArrayBuffer} arraybuffer The audio data.\n   * @param  {Howl}        self\n   */\n  var decodeAudioData = function(arraybuffer, self) {\n    // Fire a load error if something broke.\n    var error = function() {\n      self._emit('loaderror', null, 'Decoding audio data failed.');\n    };\n\n    // Load the sound on success.\n    var success = function(buffer) {\n      if (buffer && self._sounds.length > 0) {\n        cache[self._src] = buffer;\n        loadSound(self, buffer);\n      } else {\n        error();\n      }\n    };\n\n    // Decode the buffer into an audio source.\n    if (typeof Promise !== 'undefined' && Howler.ctx.decodeAudioData.length === 1) {\n      Howler.ctx.decodeAudioData(arraybuffer).then(success).catch(error);\n    } else {\n      Howler.ctx.decodeAudioData(arraybuffer, success, error);\n    }\n  }\n\n  /**\n   * Sound is now loaded, so finish setting everything up and fire the loaded event.\n   * @param  {Howl} self\n   * @param  {Object} buffer The decoded buffer sound source.\n   */\n  var loadSound = function(self, buffer) {\n    // Set the duration.\n    if (buffer && !self._duration) {\n      self._duration = buffer.duration;\n    }\n\n    // Setup a sprite if none is defined.\n    if (Object.keys(self._sprite).length === 0) {\n      self._sprite = {__default: [0, self._duration * 1000]};\n    }\n\n    // Fire the loaded event.\n    if (self._state !== 'loaded') {\n      self._state = 'loaded';\n      self._emit('load');\n      self._loadQueue();\n    }\n  };\n\n  /**\n   * Setup the audio context when available, or switch to HTML5 Audio mode.\n   */\n  var setupAudioContext = function() {\n    // If we have already detected that Web Audio isn't supported, don't run this step again.\n    if (!Howler.usingWebAudio) {\n      return;\n    }\n\n    // Check if we are using Web Audio and setup the AudioContext if we are.\n    try {\n      if (typeof AudioContext !== 'undefined') {\n        Howler.ctx = new AudioContext();\n      } else if (typeof webkitAudioContext !== 'undefined') {\n        Howler.ctx = new webkitAudioContext();\n      } else {\n        Howler.usingWebAudio = false;\n      }\n    } catch(e) {\n      Howler.usingWebAudio = false;\n    }\n\n    // If the audio context creation still failed, set using web audio to false.\n    if (!Howler.ctx) {\n      Howler.usingWebAudio = false;\n    }\n\n    // Check if a webview is being used on iOS8 or earlier (rather than the browser).\n    // If it is, disable Web Audio as it causes crashing.\n    var iOS = (/iP(hone|od|ad)/.test(Howler._navigator && Howler._navigator.platform));\n    var appVersion = Howler._navigator && Howler._navigator.appVersion.match(/OS (\\d+)_(\\d+)_?(\\d+)?/);\n    var version = appVersion ? parseInt(appVersion[1], 10) : null;\n    if (iOS && version && version < 9) {\n      var safari = /safari/.test(Howler._navigator && Howler._navigator.userAgent.toLowerCase());\n      if (Howler._navigator && !safari) {\n        Howler.usingWebAudio = false;\n      }\n    }\n\n    // Create and expose the master GainNode when using Web Audio (useful for plugins or advanced usage).\n    if (Howler.usingWebAudio) {\n      Howler.masterGain = (typeof Howler.ctx.createGain === 'undefined') ? Howler.ctx.createGainNode() : Howler.ctx.createGain();\n      Howler.masterGain.gain.setValueAtTime(Howler._muted ? 0 : Howler._volume, Howler.ctx.currentTime);\n      Howler.masterGain.connect(Howler.ctx.destination);\n    }\n\n    // Re-run the setup on Howler.\n    Howler._setup();\n  };\n\n  // Add support for AMD (Asynchronous Module Definition) libraries such as require.js.\n  if (typeof define === 'function' && define.amd) {\n    define([], function() {\n      return {\n        Howler: Howler,\n        Howl: Howl\n      };\n    });\n  }\n\n  // Add support for CommonJS libraries such as browserify.\n  if (typeof exports !== 'undefined') {\n    exports.Howler = Howler;\n    exports.Howl = Howl;\n  }\n\n  // Add to global in Node.js (for testing, etc).\n  if (typeof global !== 'undefined') {\n    global.HowlerGlobal = HowlerGlobal;\n    global.Howler = Howler;\n    global.Howl = Howl;\n    global.Sound = Sound;\n  } else if (typeof window !== 'undefined') {  // Define globally in case AMD is not available or unused.\n    window.HowlerGlobal = HowlerGlobal;\n    window.Howler = Howler;\n    window.Howl = Howl;\n    window.Sound = Sound;\n  }\n})();\n\n\n/*!\n *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.\n *  \n *  howler.js v2.2.4\n *  howlerjs.com\n *\n *  (c) 2013-2020, James Simpson of GoldFire Studios\n *  goldfirestudios.com\n *\n *  MIT License\n */\n\n(function() {\n\n  'use strict';\n\n  // Setup default properties.\n  HowlerGlobal.prototype._pos = [0, 0, 0];\n  HowlerGlobal.prototype._orientation = [0, 0, -1, 0, 1, 0];\n\n  /** Global Methods **/\n  /***************************************************************************/\n\n  /**\n   * Helper method to update the stereo panning position of all current Howls.\n   * Future Howls will not use this value unless explicitly set.\n   * @param  {Number} pan A value of -1.0 is all the way left and 1.0 is all the way right.\n   * @return {Howler/Number}     Self or current stereo panning value.\n   */\n  HowlerGlobal.prototype.stereo = function(pan) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self.ctx || !self.ctx.listener) {\n      return self;\n    }\n\n    // Loop through all Howls and update their stereo panning.\n    for (var i=self._howls.length-1; i>=0; i--) {\n      self._howls[i].stereo(pan);\n    }\n\n    return self;\n  };\n\n  /**\n   * Get/set the position of the listener in 3D cartesian space. Sounds using\n   * 3D position will be relative to the listener's position.\n   * @param  {Number} x The x-position of the listener.\n   * @param  {Number} y The y-position of the listener.\n   * @param  {Number} z The z-position of the listener.\n   * @return {Howler/Array}   Self or current listener position.\n   */\n  HowlerGlobal.prototype.pos = function(x, y, z) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self.ctx || !self.ctx.listener) {\n      return self;\n    }\n\n    // Set the defaults for optional 'y' & 'z'.\n    y = (typeof y !== 'number') ? self._pos[1] : y;\n    z = (typeof z !== 'number') ? self._pos[2] : z;\n\n    if (typeof x === 'number') {\n      self._pos = [x, y, z];\n\n      if (typeof self.ctx.listener.positionX !== 'undefined') {\n        self.ctx.listener.positionX.setTargetAtTime(self._pos[0], Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.positionY.setTargetAtTime(self._pos[1], Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.positionZ.setTargetAtTime(self._pos[2], Howler.ctx.currentTime, 0.1);\n      } else {\n        self.ctx.listener.setPosition(self._pos[0], self._pos[1], self._pos[2]);\n      }\n    } else {\n      return self._pos;\n    }\n\n    return self;\n  };\n\n  /**\n   * Get/set the direction the listener is pointing in the 3D cartesian space.\n   * A front and up vector must be provided. The front is the direction the\n   * face of the listener is pointing, and up is the direction the top of the\n   * listener is pointing. Thus, these values are expected to be at right angles\n   * from each other.\n   * @param  {Number} x   The x-orientation of the listener.\n   * @param  {Number} y   The y-orientation of the listener.\n   * @param  {Number} z   The z-orientation of the listener.\n   * @param  {Number} xUp The x-orientation of the top of the listener.\n   * @param  {Number} yUp The y-orientation of the top of the listener.\n   * @param  {Number} zUp The z-orientation of the top of the listener.\n   * @return {Howler/Array}     Returns self or the current orientation vectors.\n   */\n  HowlerGlobal.prototype.orientation = function(x, y, z, xUp, yUp, zUp) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self.ctx || !self.ctx.listener) {\n      return self;\n    }\n\n    // Set the defaults for optional 'y' & 'z'.\n    var or = self._orientation;\n    y = (typeof y !== 'number') ? or[1] : y;\n    z = (typeof z !== 'number') ? or[2] : z;\n    xUp = (typeof xUp !== 'number') ? or[3] : xUp;\n    yUp = (typeof yUp !== 'number') ? or[4] : yUp;\n    zUp = (typeof zUp !== 'number') ? or[5] : zUp;\n\n    if (typeof x === 'number') {\n      self._orientation = [x, y, z, xUp, yUp, zUp];\n\n      if (typeof self.ctx.listener.forwardX !== 'undefined') {\n        self.ctx.listener.forwardX.setTargetAtTime(x, Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.forwardY.setTargetAtTime(y, Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.forwardZ.setTargetAtTime(z, Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.upX.setTargetAtTime(xUp, Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.upY.setTargetAtTime(yUp, Howler.ctx.currentTime, 0.1);\n        self.ctx.listener.upZ.setTargetAtTime(zUp, Howler.ctx.currentTime, 0.1);\n      } else {\n        self.ctx.listener.setOrientation(x, y, z, xUp, yUp, zUp);\n      }\n    } else {\n      return or;\n    }\n\n    return self;\n  };\n\n  /** Group Methods **/\n  /***************************************************************************/\n\n  /**\n   * Add new properties to the core init.\n   * @param  {Function} _super Core init method.\n   * @return {Howl}\n   */\n  Howl.prototype.init = (function(_super) {\n    return function(o) {\n      var self = this;\n\n      // Setup user-defined default properties.\n      self._orientation = o.orientation || [1, 0, 0];\n      self._stereo = o.stereo || null;\n      self._pos = o.pos || null;\n      self._pannerAttr = {\n        coneInnerAngle: typeof o.coneInnerAngle !== 'undefined' ? o.coneInnerAngle : 360,\n        coneOuterAngle: typeof o.coneOuterAngle !== 'undefined' ? o.coneOuterAngle : 360,\n        coneOuterGain: typeof o.coneOuterGain !== 'undefined' ? o.coneOuterGain : 0,\n        distanceModel: typeof o.distanceModel !== 'undefined' ? o.distanceModel : 'inverse',\n        maxDistance: typeof o.maxDistance !== 'undefined' ? o.maxDistance : 10000,\n        panningModel: typeof o.panningModel !== 'undefined' ? o.panningModel : 'HRTF',\n        refDistance: typeof o.refDistance !== 'undefined' ? o.refDistance : 1,\n        rolloffFactor: typeof o.rolloffFactor !== 'undefined' ? o.rolloffFactor : 1\n      };\n\n      // Setup event listeners.\n      self._onstereo = o.onstereo ? [{fn: o.onstereo}] : [];\n      self._onpos = o.onpos ? [{fn: o.onpos}] : [];\n      self._onorientation = o.onorientation ? [{fn: o.onorientation}] : [];\n\n      // Complete initilization with howler.js core's init function.\n      return _super.call(this, o);\n    };\n  })(Howl.prototype.init);\n\n  /**\n   * Get/set the stereo panning of the audio source for this sound or all in the group.\n   * @param  {Number} pan  A value of -1.0 is all the way left and 1.0 is all the way right.\n   * @param  {Number} id (optional) The sound ID. If none is passed, all in group will be updated.\n   * @return {Howl/Number}    Returns self or the current stereo panning value.\n   */\n  Howl.prototype.stereo = function(pan, id) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self._webAudio) {\n      return self;\n    }\n\n    // If the sound hasn't loaded, add it to the load queue to change stereo pan when capable.\n    if (self._state !== 'loaded') {\n      self._queue.push({\n        event: 'stereo',\n        action: function() {\n          self.stereo(pan, id);\n        }\n      });\n\n      return self;\n    }\n\n    // Check for PannerStereoNode support and fallback to PannerNode if it doesn't exist.\n    var pannerType = (typeof Howler.ctx.createStereoPanner === 'undefined') ? 'spatial' : 'stereo';\n\n    // Setup the group's stereo panning if no ID is passed.\n    if (typeof id === 'undefined') {\n      // Return the group's stereo panning if no parameters are passed.\n      if (typeof pan === 'number') {\n        self._stereo = pan;\n        self._pos = [pan, 0, 0];\n      } else {\n        return self._stereo;\n      }\n    }\n\n    // Change the streo panning of one or all sounds in group.\n    var ids = self._getSoundIds(id);\n    for (var i=0; i<ids.length; i++) {\n      // Get the sound.\n      var sound = self._soundById(ids[i]);\n\n      if (sound) {\n        if (typeof pan === 'number') {\n          sound._stereo = pan;\n          sound._pos = [pan, 0, 0];\n\n          if (sound._node) {\n            // If we are falling back, make sure the panningModel is equalpower.\n            sound._pannerAttr.panningModel = 'equalpower';\n\n            // Check if there is a panner setup and create a new one if not.\n            if (!sound._panner || !sound._panner.pan) {\n              setupPanner(sound, pannerType);\n            }\n\n            if (pannerType === 'spatial') {\n              if (typeof sound._panner.positionX !== 'undefined') {\n                sound._panner.positionX.setValueAtTime(pan, Howler.ctx.currentTime);\n                sound._panner.positionY.setValueAtTime(0, Howler.ctx.currentTime);\n                sound._panner.positionZ.setValueAtTime(0, Howler.ctx.currentTime);\n              } else {\n                sound._panner.setPosition(pan, 0, 0);\n              }\n            } else {\n              sound._panner.pan.setValueAtTime(pan, Howler.ctx.currentTime);\n            }\n          }\n\n          self._emit('stereo', sound._id);\n        } else {\n          return sound._stereo;\n        }\n      }\n    }\n\n    return self;\n  };\n\n  /**\n   * Get/set the 3D spatial position of the audio source for this sound or group relative to the global listener.\n   * @param  {Number} x  The x-position of the audio source.\n   * @param  {Number} y  The y-position of the audio source.\n   * @param  {Number} z  The z-position of the audio source.\n   * @param  {Number} id (optional) The sound ID. If none is passed, all in group will be updated.\n   * @return {Howl/Array}    Returns self or the current 3D spatial position: [x, y, z].\n   */\n  Howl.prototype.pos = function(x, y, z, id) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self._webAudio) {\n      return self;\n    }\n\n    // If the sound hasn't loaded, add it to the load queue to change position when capable.\n    if (self._state !== 'loaded') {\n      self._queue.push({\n        event: 'pos',\n        action: function() {\n          self.pos(x, y, z, id);\n        }\n      });\n\n      return self;\n    }\n\n    // Set the defaults for optional 'y' & 'z'.\n    y = (typeof y !== 'number') ? 0 : y;\n    z = (typeof z !== 'number') ? -0.5 : z;\n\n    // Setup the group's spatial position if no ID is passed.\n    if (typeof id === 'undefined') {\n      // Return the group's spatial position if no parameters are passed.\n      if (typeof x === 'number') {\n        self._pos = [x, y, z];\n      } else {\n        return self._pos;\n      }\n    }\n\n    // Change the spatial position of one or all sounds in group.\n    var ids = self._getSoundIds(id);\n    for (var i=0; i<ids.length; i++) {\n      // Get the sound.\n      var sound = self._soundById(ids[i]);\n\n      if (sound) {\n        if (typeof x === 'number') {\n          sound._pos = [x, y, z];\n\n          if (sound._node) {\n            // Check if there is a panner setup and create a new one if not.\n            if (!sound._panner || sound._panner.pan) {\n              setupPanner(sound, 'spatial');\n            }\n\n            if (typeof sound._panner.positionX !== 'undefined') {\n              sound._panner.positionX.setValueAtTime(x, Howler.ctx.currentTime);\n              sound._panner.positionY.setValueAtTime(y, Howler.ctx.currentTime);\n              sound._panner.positionZ.setValueAtTime(z, Howler.ctx.currentTime);\n            } else {\n              sound._panner.setPosition(x, y, z);\n            }\n          }\n\n          self._emit('pos', sound._id);\n        } else {\n          return sound._pos;\n        }\n      }\n    }\n\n    return self;\n  };\n\n  /**\n   * Get/set the direction the audio source is pointing in the 3D cartesian coordinate\n   * space. Depending on how direction the sound is, based on the `cone` attributes,\n   * a sound pointing away from the listener can be quiet or silent.\n   * @param  {Number} x  The x-orientation of the source.\n   * @param  {Number} y  The y-orientation of the source.\n   * @param  {Number} z  The z-orientation of the source.\n   * @param  {Number} id (optional) The sound ID. If none is passed, all in group will be updated.\n   * @return {Howl/Array}    Returns self or the current 3D spatial orientation: [x, y, z].\n   */\n  Howl.prototype.orientation = function(x, y, z, id) {\n    var self = this;\n\n    // Stop right here if not using Web Audio.\n    if (!self._webAudio) {\n      return self;\n    }\n\n    // If the sound hasn't loaded, add it to the load queue to change orientation when capable.\n    if (self._state !== 'loaded') {\n      self._queue.push({\n        event: 'orientation',\n        action: function() {\n          self.orientation(x, y, z, id);\n        }\n      });\n\n      return self;\n    }\n\n    // Set the defaults for optional 'y' & 'z'.\n    y = (typeof y !== 'number') ? self._orientation[1] : y;\n    z = (typeof z !== 'number') ? self._orientation[2] : z;\n\n    // Setup the group's spatial orientation if no ID is passed.\n    if (typeof id === 'undefined') {\n      // Return the group's spatial orientation if no parameters are passed.\n      if (typeof x === 'number') {\n        self._orientation = [x, y, z];\n      } else {\n        return self._orientation;\n      }\n    }\n\n    // Change the spatial orientation of one or all sounds in group.\n    var ids = self._getSoundIds(id);\n    for (var i=0; i<ids.length; i++) {\n      // Get the sound.\n      var sound = self._soundById(ids[i]);\n\n      if (sound) {\n        if (typeof x === 'number') {\n          sound._orientation = [x, y, z];\n\n          if (sound._node) {\n            // Check if there is a panner setup and create a new one if not.\n            if (!sound._panner) {\n              // Make sure we have a position to setup the node with.\n              if (!sound._pos) {\n                sound._pos = self._pos || [0, 0, -0.5];\n              }\n\n              setupPanner(sound, 'spatial');\n            }\n\n            if (typeof sound._panner.orientationX !== 'undefined') {\n              sound._panner.orientationX.setValueAtTime(x, Howler.ctx.currentTime);\n              sound._panner.orientationY.setValueAtTime(y, Howler.ctx.currentTime);\n              sound._panner.orientationZ.setValueAtTime(z, Howler.ctx.currentTime);\n            } else {\n              sound._panner.setOrientation(x, y, z);\n            }\n          }\n\n          self._emit('orientation', sound._id);\n        } else {\n          return sound._orientation;\n        }\n      }\n    }\n\n    return self;\n  };\n\n  /**\n   * Get/set the panner node's attributes for a sound or group of sounds.\n   * This method can optionall take 0, 1 or 2 arguments.\n   *   pannerAttr() -> Returns the group's values.\n   *   pannerAttr(id) -> Returns the sound id's values.\n   *   pannerAttr(o) -> Set's the values of all sounds in this Howl group.\n   *   pannerAttr(o, id) -> Set's the values of passed sound id.\n   *\n   *   Attributes:\n   *     coneInnerAngle - (360 by default) A parameter for directional audio sources, this is an angle, in degrees,\n   *                      inside of which there will be no volume reduction.\n   *     coneOuterAngle - (360 by default) A parameter for directional audio sources, this is an angle, in degrees,\n   *                      outside of which the volume will be reduced to a constant value of `coneOuterGain`.\n   *     coneOuterGain - (0 by default) A parameter for directional audio sources, this is the gain outside of the\n   *                     `coneOuterAngle`. It is a linear value in the range `[0, 1]`.\n   *     distanceModel - ('inverse' by default) Determines algorithm used to reduce volume as audio moves away from\n   *                     listener. Can be `linear`, `inverse` or `exponential.\n   *     maxDistance - (10000 by default) The maximum distance between source and listener, after which the volume\n   *                   will not be reduced any further.\n   *     refDistance - (1 by default) A reference distance for reducing volume as source moves further from the listener.\n   *                   This is simply a variable of the distance model and has a different effect depending on which model\n   *                   is used and the scale of your coordinates. Generally, volume will be equal to 1 at this distance.\n   *     rolloffFactor - (1 by default) How quickly the volume reduces as source moves from listener. This is simply a\n   *                     variable of the distance model and can be in the range of `[0, 1]` with `linear` and `[0, ∞]`\n   *                     with `inverse` and `exponential`.\n   *     panningModel - ('HRTF' by default) Determines which spatialization algorithm is used to position audio.\n   *                     Can be `HRTF` or `equalpower`.\n   *\n   * @return {Howl/Object} Returns self or current panner attributes.\n   */\n  Howl.prototype.pannerAttr = function() {\n    var self = this;\n    var args = arguments;\n    var o, id, sound;\n\n    // Stop right here if not using Web Audio.\n    if (!self._webAudio) {\n      return self;\n    }\n\n    // Determine the values based on arguments.\n    if (args.length === 0) {\n      // Return the group's panner attribute values.\n      return self._pannerAttr;\n    } else if (args.length === 1) {\n      if (typeof args[0] === 'object') {\n        o = args[0];\n\n        // Set the grou's panner attribute values.\n        if (typeof id === 'undefined') {\n          if (!o.pannerAttr) {\n            o.pannerAttr = {\n              coneInnerAngle: o.coneInnerAngle,\n              coneOuterAngle: o.coneOuterAngle,\n              coneOuterGain: o.coneOuterGain,\n              distanceModel: o.distanceModel,\n              maxDistance: o.maxDistance,\n              refDistance: o.refDistance,\n              rolloffFactor: o.rolloffFactor,\n              panningModel: o.panningModel\n            };\n          }\n\n          self._pannerAttr = {\n            coneInnerAngle: typeof o.pannerAttr.coneInnerAngle !== 'undefined' ? o.pannerAttr.coneInnerAngle : self._coneInnerAngle,\n            coneOuterAngle: typeof o.pannerAttr.coneOuterAngle !== 'undefined' ? o.pannerAttr.coneOuterAngle : self._coneOuterAngle,\n            coneOuterGain: typeof o.pannerAttr.coneOuterGain !== 'undefined' ? o.pannerAttr.coneOuterGain : self._coneOuterGain,\n            distanceModel: typeof o.pannerAttr.distanceModel !== 'undefined' ? o.pannerAttr.distanceModel : self._distanceModel,\n            maxDistance: typeof o.pannerAttr.maxDistance !== 'undefined' ? o.pannerAttr.maxDistance : self._maxDistance,\n            refDistance: typeof o.pannerAttr.refDistance !== 'undefined' ? o.pannerAttr.refDistance : self._refDistance,\n            rolloffFactor: typeof o.pannerAttr.rolloffFactor !== 'undefined' ? o.pannerAttr.rolloffFactor : self._rolloffFactor,\n            panningModel: typeof o.pannerAttr.panningModel !== 'undefined' ? o.pannerAttr.panningModel : self._panningModel\n          };\n        }\n      } else {\n        // Return this sound's panner attribute values.\n        sound = self._soundById(parseInt(args[0], 10));\n        return sound ? sound._pannerAttr : self._pannerAttr;\n      }\n    } else if (args.length === 2) {\n      o = args[0];\n      id = parseInt(args[1], 10);\n    }\n\n    // Update the values of the specified sounds.\n    var ids = self._getSoundIds(id);\n    for (var i=0; i<ids.length; i++) {\n      sound = self._soundById(ids[i]);\n\n      if (sound) {\n        // Merge the new values into the sound.\n        var pa = sound._pannerAttr;\n        pa = {\n          coneInnerAngle: typeof o.coneInnerAngle !== 'undefined' ? o.coneInnerAngle : pa.coneInnerAngle,\n          coneOuterAngle: typeof o.coneOuterAngle !== 'undefined' ? o.coneOuterAngle : pa.coneOuterAngle,\n          coneOuterGain: typeof o.coneOuterGain !== 'undefined' ? o.coneOuterGain : pa.coneOuterGain,\n          distanceModel: typeof o.distanceModel !== 'undefined' ? o.distanceModel : pa.distanceModel,\n          maxDistance: typeof o.maxDistance !== 'undefined' ? o.maxDistance : pa.maxDistance,\n          refDistance: typeof o.refDistance !== 'undefined' ? o.refDistance : pa.refDistance,\n          rolloffFactor: typeof o.rolloffFactor !== 'undefined' ? o.rolloffFactor : pa.rolloffFactor,\n          panningModel: typeof o.panningModel !== 'undefined' ? o.panningModel : pa.panningModel\n        };\n\n        // Create a new panner node if one doesn't already exist.\n        var panner = sound._panner;\n        if (!panner) {\n          // Make sure we have a position to setup the node with.\n          if (!sound._pos) {\n            sound._pos = self._pos || [0, 0, -0.5];\n          }\n\n          // Create a new panner node.\n          setupPanner(sound, 'spatial');\n          panner = sound._panner\n        }\n\n        // Update the panner values or create a new panner if none exists.\n        panner.coneInnerAngle = pa.coneInnerAngle;\n        panner.coneOuterAngle = pa.coneOuterAngle;\n        panner.coneOuterGain = pa.coneOuterGain;\n        panner.distanceModel = pa.distanceModel;\n        panner.maxDistance = pa.maxDistance;\n        panner.refDistance = pa.refDistance;\n        panner.rolloffFactor = pa.rolloffFactor;\n        panner.panningModel = pa.panningModel;\n      }\n    }\n\n    return self;\n  };\n\n  /** Single Sound Methods **/\n  /***************************************************************************/\n\n  /**\n   * Add new properties to the core Sound init.\n   * @param  {Function} _super Core Sound init method.\n   * @return {Sound}\n   */\n  Sound.prototype.init = (function(_super) {\n    return function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Setup user-defined default properties.\n      self._orientation = parent._orientation;\n      self._stereo = parent._stereo;\n      self._pos = parent._pos;\n      self._pannerAttr = parent._pannerAttr;\n\n      // Complete initilization with howler.js core Sound's init function.\n      _super.call(this);\n\n      // If a stereo or position was specified, set it up.\n      if (self._stereo) {\n        parent.stereo(self._stereo);\n      } else if (self._pos) {\n        parent.pos(self._pos[0], self._pos[1], self._pos[2], self._id);\n      }\n    };\n  })(Sound.prototype.init);\n\n  /**\n   * Override the Sound.reset method to clean up properties from the spatial plugin.\n   * @param  {Function} _super Sound reset method.\n   * @return {Sound}\n   */\n  Sound.prototype.reset = (function(_super) {\n    return function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Reset all spatial plugin properties on this sound.\n      self._orientation = parent._orientation;\n      self._stereo = parent._stereo;\n      self._pos = parent._pos;\n      self._pannerAttr = parent._pannerAttr;\n\n      // If a stereo or position was specified, set it up.\n      if (self._stereo) {\n        parent.stereo(self._stereo);\n      } else if (self._pos) {\n        parent.pos(self._pos[0], self._pos[1], self._pos[2], self._id);\n      } else if (self._panner) {\n        // Disconnect the panner.\n        self._panner.disconnect(0);\n        self._panner = undefined;\n        parent._refreshBuffer(self);\n      }\n\n      // Complete resetting of the sound.\n      return _super.call(this);\n    };\n  })(Sound.prototype.reset);\n\n  /** Helper Methods **/\n  /***************************************************************************/\n\n  /**\n   * Create a new panner node and save it on the sound.\n   * @param  {Sound} sound Specific sound to setup panning on.\n   * @param {String} type Type of panner to create: 'stereo' or 'spatial'.\n   */\n  var setupPanner = function(sound, type) {\n    type = type || 'spatial';\n\n    // Create the new panner node.\n    if (type === 'spatial') {\n      sound._panner = Howler.ctx.createPanner();\n      sound._panner.coneInnerAngle = sound._pannerAttr.coneInnerAngle;\n      sound._panner.coneOuterAngle = sound._pannerAttr.coneOuterAngle;\n      sound._panner.coneOuterGain = sound._pannerAttr.coneOuterGain;\n      sound._panner.distanceModel = sound._pannerAttr.distanceModel;\n      sound._panner.maxDistance = sound._pannerAttr.maxDistance;\n      sound._panner.refDistance = sound._pannerAttr.refDistance;\n      sound._panner.rolloffFactor = sound._pannerAttr.rolloffFactor;\n      sound._panner.panningModel = sound._pannerAttr.panningModel;\n\n      if (typeof sound._panner.positionX !== 'undefined') {\n        sound._panner.positionX.setValueAtTime(sound._pos[0], Howler.ctx.currentTime);\n        sound._panner.positionY.setValueAtTime(sound._pos[1], Howler.ctx.currentTime);\n        sound._panner.positionZ.setValueAtTime(sound._pos[2], Howler.ctx.currentTime);\n      } else {\n        sound._panner.setPosition(sound._pos[0], sound._pos[1], sound._pos[2]);\n      }\n\n      if (typeof sound._panner.orientationX !== 'undefined') {\n        sound._panner.orientationX.setValueAtTime(sound._orientation[0], Howler.ctx.currentTime);\n        sound._panner.orientationY.setValueAtTime(sound._orientation[1], Howler.ctx.currentTime);\n        sound._panner.orientationZ.setValueAtTime(sound._orientation[2], Howler.ctx.currentTime);\n      } else {\n        sound._panner.setOrientation(sound._orientation[0], sound._orientation[1], sound._orientation[2]);\n      }\n    } else {\n      sound._panner = Howler.ctx.createStereoPanner();\n      sound._panner.pan.setValueAtTime(sound._stereo, Howler.ctx.currentTime);\n    }\n\n    sound._panner.connect(sound._node);\n\n    // Update the connections.\n    if (!sound._paused) {\n      sound._parent.pause(sound._id, true).play(sound._id, true);\n    }\n  };\n})();\n","var murmur3 = require(\"./murmurhash3_gc.js\")\nvar murmur2 = require(\"./murmurhash2_gc.js\")\n\nmodule.exports = murmur3\nmodule.exports.murmur3 = murmur3\nmodule.exports.murmur2 = murmur2\n","/**\n * JS Implementation of MurmurHash3 (r136) (as of May 20, 2011)\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} key ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash \n */\n\nfunction murmurhash3_32_gc(key, seed) {\n\tvar remainder, bytes, h1, h1b, c1, c1b, c2, c2b, k1, i;\n\t\n\tremainder = key.length & 3; // key.length % 4\n\tbytes = key.length - remainder;\n\th1 = seed;\n\tc1 = 0xcc9e2d51;\n\tc2 = 0x1b873593;\n\ti = 0;\n\t\n\twhile (i < bytes) {\n\t  \tk1 = \n\t  \t  ((key.charCodeAt(i) & 0xff)) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 8) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 16) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 24);\n\t\t++i;\n\t\t\n\t\tk1 = ((((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16))) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = ((((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16))) & 0xffffffff;\n\n\t\th1 ^= k1;\n        h1 = (h1 << 13) | (h1 >>> 19);\n\t\th1b = ((((h1 & 0xffff) * 5) + ((((h1 >>> 16) * 5) & 0xffff) << 16))) & 0xffffffff;\n\t\th1 = (((h1b & 0xffff) + 0x6b64) + ((((h1b >>> 16) + 0xe654) & 0xffff) << 16));\n\t}\n\t\n\tk1 = 0;\n\t\n\tswitch (remainder) {\n\t\tcase 3: k1 ^= (key.charCodeAt(i + 2) & 0xff) << 16;\n\t\tcase 2: k1 ^= (key.charCodeAt(i + 1) & 0xff) << 8;\n\t\tcase 1: k1 ^= (key.charCodeAt(i) & 0xff);\n\t\t\n\t\tk1 = (((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16)) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = (((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16)) & 0xffffffff;\n\t\th1 ^= k1;\n\t}\n\t\n\th1 ^= key.length;\n\n\th1 ^= h1 >>> 16;\n\th1 = (((h1 & 0xffff) * 0x85ebca6b) + ((((h1 >>> 16) * 0x85ebca6b) & 0xffff) << 16)) & 0xffffffff;\n\th1 ^= h1 >>> 13;\n\th1 = ((((h1 & 0xffff) * 0xc2b2ae35) + ((((h1 >>> 16) * 0xc2b2ae35) & 0xffff) << 16))) & 0xffffffff;\n\th1 ^= h1 >>> 16;\n\n\treturn h1 >>> 0;\n}\n\nif(typeof module !== \"undefined\") {\n  module.exports = murmurhash3_32_gc\n}","/*!\n    localForage -- Offline Storage, Improved\n    Version 1.10.0\n    https://localforage.github.io/localForage\n    (c) 2013-2017 Mozilla, Apache License 2.0\n*/\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.localforage = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw (f.code=\"MODULE_NOT_FOUND\", f)}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n(function (global){\n'use strict';\nvar Mutation = global.MutationObserver || global.WebKitMutationObserver;\n\nvar scheduleDrain;\n\n{\n  if (Mutation) {\n    var called = 0;\n    var observer = new Mutation(nextTick);\n    var element = global.document.createTextNode('');\n    observer.observe(element, {\n      characterData: true\n    });\n    scheduleDrain = function () {\n      element.data = (called = ++called % 2);\n    };\n  } else if (!global.setImmediate && typeof global.MessageChannel !== 'undefined') {\n    var channel = new global.MessageChannel();\n    channel.port1.onmessage = nextTick;\n    scheduleDrain = function () {\n      channel.port2.postMessage(0);\n    };\n  } else if ('document' in global && 'onreadystatechange' in global.document.createElement('script')) {\n    scheduleDrain = function () {\n\n      // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n      // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n      var scriptEl = global.document.createElement('script');\n      scriptEl.onreadystatechange = function () {\n        nextTick();\n\n        scriptEl.onreadystatechange = null;\n        scriptEl.parentNode.removeChild(scriptEl);\n        scriptEl = null;\n      };\n      global.document.documentElement.appendChild(scriptEl);\n    };\n  } else {\n    scheduleDrain = function () {\n      setTimeout(nextTick, 0);\n    };\n  }\n}\n\nvar draining;\nvar queue = [];\n//named nextTick for less confusing stack traces\nfunction nextTick() {\n  draining = true;\n  var i, oldQueue;\n  var len = queue.length;\n  while (len) {\n    oldQueue = queue;\n    queue = [];\n    i = -1;\n    while (++i < len) {\n      oldQueue[i]();\n    }\n    len = queue.length;\n  }\n  draining = false;\n}\n\nmodule.exports = immediate;\nfunction immediate(task) {\n  if (queue.push(task) === 1 && !draining) {\n    scheduleDrain();\n  }\n}\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],2:[function(_dereq_,module,exports){\n'use strict';\nvar immediate = _dereq_(1);\n\n/* istanbul ignore next */\nfunction INTERNAL() {}\n\nvar handlers = {};\n\nvar REJECTED = ['REJECTED'];\nvar FULFILLED = ['FULFILLED'];\nvar PENDING = ['PENDING'];\n\nmodule.exports = Promise;\n\nfunction Promise(resolver) {\n  if (typeof resolver !== 'function') {\n    throw new TypeError('resolver must be a function');\n  }\n  this.state = PENDING;\n  this.queue = [];\n  this.outcome = void 0;\n  if (resolver !== INTERNAL) {\n    safelyResolveThenable(this, resolver);\n  }\n}\n\nPromise.prototype[\"catch\"] = function (onRejected) {\n  return this.then(null, onRejected);\n};\nPromise.prototype.then = function (onFulfilled, onRejected) {\n  if (typeof onFulfilled !== 'function' && this.state === FULFILLED ||\n    typeof onRejected !== 'function' && this.state === REJECTED) {\n    return this;\n  }\n  var promise = new this.constructor(INTERNAL);\n  if (this.state !== PENDING) {\n    var resolver = this.state === FULFILLED ? onFulfilled : onRejected;\n    unwrap(promise, resolver, this.outcome);\n  } else {\n    this.queue.push(new QueueItem(promise, onFulfilled, onRejected));\n  }\n\n  return promise;\n};\nfunction QueueItem(promise, onFulfilled, onRejected) {\n  this.promise = promise;\n  if (typeof onFulfilled === 'function') {\n    this.onFulfilled = onFulfilled;\n    this.callFulfilled = this.otherCallFulfilled;\n  }\n  if (typeof onRejected === 'function') {\n    this.onRejected = onRejected;\n    this.callRejected = this.otherCallRejected;\n  }\n}\nQueueItem.prototype.callFulfilled = function (value) {\n  handlers.resolve(this.promise, value);\n};\nQueueItem.prototype.otherCallFulfilled = function (value) {\n  unwrap(this.promise, this.onFulfilled, value);\n};\nQueueItem.prototype.callRejected = function (value) {\n  handlers.reject(this.promise, value);\n};\nQueueItem.prototype.otherCallRejected = function (value) {\n  unwrap(this.promise, this.onRejected, value);\n};\n\nfunction unwrap(promise, func, value) {\n  immediate(function () {\n    var returnValue;\n    try {\n      returnValue = func(value);\n    } catch (e) {\n      return handlers.reject(promise, e);\n    }\n    if (returnValue === promise) {\n      handlers.reject(promise, new TypeError('Cannot resolve promise with itself'));\n    } else {\n      handlers.resolve(promise, returnValue);\n    }\n  });\n}\n\nhandlers.resolve = function (self, value) {\n  var result = tryCatch(getThen, value);\n  if (result.status === 'error') {\n    return handlers.reject(self, result.value);\n  }\n  var thenable = result.value;\n\n  if (thenable) {\n    safelyResolveThenable(self, thenable);\n  } else {\n    self.state = FULFILLED;\n    self.outcome = value;\n    var i = -1;\n    var len = self.queue.length;\n    while (++i < len) {\n      self.queue[i].callFulfilled(value);\n    }\n  }\n  return self;\n};\nhandlers.reject = function (self, error) {\n  self.state = REJECTED;\n  self.outcome = error;\n  var i = -1;\n  var len = self.queue.length;\n  while (++i < len) {\n    self.queue[i].callRejected(error);\n  }\n  return self;\n};\n\nfunction getThen(obj) {\n  // Make sure we only access the accessor once as required by the spec\n  var then = obj && obj.then;\n  if (obj && (typeof obj === 'object' || typeof obj === 'function') && typeof then === 'function') {\n    return function appyThen() {\n      then.apply(obj, arguments);\n    };\n  }\n}\n\nfunction safelyResolveThenable(self, thenable) {\n  // Either fulfill, reject or reject with error\n  var called = false;\n  function onError(value) {\n    if (called) {\n      return;\n    }\n    called = true;\n    handlers.reject(self, value);\n  }\n\n  function onSuccess(value) {\n    if (called) {\n      return;\n    }\n    called = true;\n    handlers.resolve(self, value);\n  }\n\n  function tryToUnwrap() {\n    thenable(onSuccess, onError);\n  }\n\n  var result = tryCatch(tryToUnwrap);\n  if (result.status === 'error') {\n    onError(result.value);\n  }\n}\n\nfunction tryCatch(func, value) {\n  var out = {};\n  try {\n    out.value = func(value);\n    out.status = 'success';\n  } catch (e) {\n    out.status = 'error';\n    out.value = e;\n  }\n  return out;\n}\n\nPromise.resolve = resolve;\nfunction resolve(value) {\n  if (value instanceof this) {\n    return value;\n  }\n  return handlers.resolve(new this(INTERNAL), value);\n}\n\nPromise.reject = reject;\nfunction reject(reason) {\n  var promise = new this(INTERNAL);\n  return handlers.reject(promise, reason);\n}\n\nPromise.all = all;\nfunction all(iterable) {\n  var self = this;\n  if (Object.prototype.toString.call(iterable) !== '[object Array]') {\n    return this.reject(new TypeError('must be an array'));\n  }\n\n  var len = iterable.length;\n  var called = false;\n  if (!len) {\n    return this.resolve([]);\n  }\n\n  var values = new Array(len);\n  var resolved = 0;\n  var i = -1;\n  var promise = new this(INTERNAL);\n\n  while (++i < len) {\n    allResolver(iterable[i], i);\n  }\n  return promise;\n  function allResolver(value, i) {\n    self.resolve(value).then(resolveFromAll, function (error) {\n      if (!called) {\n        called = true;\n        handlers.reject(promise, error);\n      }\n    });\n    function resolveFromAll(outValue) {\n      values[i] = outValue;\n      if (++resolved === len && !called) {\n        called = true;\n        handlers.resolve(promise, values);\n      }\n    }\n  }\n}\n\nPromise.race = race;\nfunction race(iterable) {\n  var self = this;\n  if (Object.prototype.toString.call(iterable) !== '[object Array]') {\n    return this.reject(new TypeError('must be an array'));\n  }\n\n  var len = iterable.length;\n  var called = false;\n  if (!len) {\n    return this.resolve([]);\n  }\n\n  var i = -1;\n  var promise = new this(INTERNAL);\n\n  while (++i < len) {\n    resolver(iterable[i]);\n  }\n  return promise;\n  function resolver(value) {\n    self.resolve(value).then(function (response) {\n      if (!called) {\n        called = true;\n        handlers.resolve(promise, response);\n      }\n    }, function (error) {\n      if (!called) {\n        called = true;\n        handlers.reject(promise, error);\n      }\n    });\n  }\n}\n\n},{\"1\":1}],3:[function(_dereq_,module,exports){\n(function (global){\n'use strict';\nif (typeof global.Promise !== 'function') {\n  global.Promise = _dereq_(2);\n}\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"2\":2}],4:[function(_dereq_,module,exports){\n'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction getIDB() {\n    /* global indexedDB,webkitIndexedDB,mozIndexedDB,OIndexedDB,msIndexedDB */\n    try {\n        if (typeof indexedDB !== 'undefined') {\n            return indexedDB;\n        }\n        if (typeof webkitIndexedDB !== 'undefined') {\n            return webkitIndexedDB;\n        }\n        if (typeof mozIndexedDB !== 'undefined') {\n            return mozIndexedDB;\n        }\n        if (typeof OIndexedDB !== 'undefined') {\n            return OIndexedDB;\n        }\n        if (typeof msIndexedDB !== 'undefined') {\n            return msIndexedDB;\n        }\n    } catch (e) {\n        return;\n    }\n}\n\nvar idb = getIDB();\n\nfunction isIndexedDBValid() {\n    try {\n        // Initialize IndexedDB; fall back to vendor-prefixed versions\n        // if needed.\n        if (!idb || !idb.open) {\n            return false;\n        }\n        // We mimic PouchDB here;\n        //\n        // We test for openDatabase because IE Mobile identifies itself\n        // as Safari. Oh the lulz...\n        var isSafari = typeof openDatabase !== 'undefined' && /(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent) && !/BlackBerry/.test(navigator.platform);\n\n        var hasFetch = typeof fetch === 'function' && fetch.toString().indexOf('[native code') !== -1;\n\n        // Safari <10.1 does not meet our requirements for IDB support\n        // (see: https://github.com/pouchdb/pouchdb/issues/5572).\n        // Safari 10.1 shipped with fetch, we can use that to detect it.\n        // Note: this creates issues with `window.fetch` polyfills and\n        // overrides; see:\n        // https://github.com/localForage/localForage/issues/856\n        return (!isSafari || hasFetch) && typeof indexedDB !== 'undefined' &&\n        // some outdated implementations of IDB that appear on Samsung\n        // and HTC Android devices <4.4 are missing IDBKeyRange\n        // See: https://github.com/mozilla/localForage/issues/128\n        // See: https://github.com/mozilla/localForage/issues/272\n        typeof IDBKeyRange !== 'undefined';\n    } catch (e) {\n        return false;\n    }\n}\n\n// Abstracts constructing a Blob object, so it also works in older\n// browsers that don't support the native Blob constructor. (i.e.\n// old QtWebKit versions, at least).\n// Abstracts constructing a Blob object, so it also works in older\n// browsers that don't support the native Blob constructor. (i.e.\n// old QtWebKit versions, at least).\nfunction createBlob(parts, properties) {\n    /* global BlobBuilder,MSBlobBuilder,MozBlobBuilder,WebKitBlobBuilder */\n    parts = parts || [];\n    properties = properties || {};\n    try {\n        return new Blob(parts, properties);\n    } catch (e) {\n        if (e.name !== 'TypeError') {\n            throw e;\n        }\n        var Builder = typeof BlobBuilder !== 'undefined' ? BlobBuilder : typeof MSBlobBuilder !== 'undefined' ? MSBlobBuilder : typeof MozBlobBuilder !== 'undefined' ? MozBlobBuilder : WebKitBlobBuilder;\n        var builder = new Builder();\n        for (var i = 0; i < parts.length; i += 1) {\n            builder.append(parts[i]);\n        }\n        return builder.getBlob(properties.type);\n    }\n}\n\n// This is CommonJS because lie is an external dependency, so Rollup\n// can just ignore it.\nif (typeof Promise === 'undefined') {\n    // In the \"nopromises\" build this will just throw if you don't have\n    // a global promise object, but it would throw anyway later.\n    _dereq_(3);\n}\nvar Promise$1 = Promise;\n\nfunction executeCallback(promise, callback) {\n    if (callback) {\n        promise.then(function (result) {\n            callback(null, result);\n        }, function (error) {\n            callback(error);\n        });\n    }\n}\n\nfunction executeTwoCallbacks(promise, callback, errorCallback) {\n    if (typeof callback === 'function') {\n        promise.then(callback);\n    }\n\n    if (typeof errorCallback === 'function') {\n        promise[\"catch\"](errorCallback);\n    }\n}\n\nfunction normalizeKey(key) {\n    // Cast the key to a string, as that's all we can set as a key.\n    if (typeof key !== 'string') {\n        console.warn(key + ' used as a key, but it is not a string.');\n        key = String(key);\n    }\n\n    return key;\n}\n\nfunction getCallback() {\n    if (arguments.length && typeof arguments[arguments.length - 1] === 'function') {\n        return arguments[arguments.length - 1];\n    }\n}\n\n// Some code originally from async_storage.js in\n// [Gaia](https://github.com/mozilla-b2g/gaia).\n\nvar DETECT_BLOB_SUPPORT_STORE = 'local-forage-detect-blob-support';\nvar supportsBlobs = void 0;\nvar dbContexts = {};\nvar toString = Object.prototype.toString;\n\n// Transaction Modes\nvar READ_ONLY = 'readonly';\nvar READ_WRITE = 'readwrite';\n\n// Transform a binary string to an array buffer, because otherwise\n// weird stuff happens when you try to work with the binary string directly.\n// It is known.\n// From http://stackoverflow.com/questions/14967647/ (continues on next line)\n// encode-decode-image-with-base64-breaks-image (2013-04-21)\nfunction _binStringToArrayBuffer(bin) {\n    var length = bin.length;\n    var buf = new ArrayBuffer(length);\n    var arr = new Uint8Array(buf);\n    for (var i = 0; i < length; i++) {\n        arr[i] = bin.charCodeAt(i);\n    }\n    return buf;\n}\n\n//\n// Blobs are not supported in all versions of IndexedDB, notably\n// Chrome <37 and Android <5. In those versions, storing a blob will throw.\n//\n// Various other blob bugs exist in Chrome v37-42 (inclusive).\n// Detecting them is expensive and confusing to users, and Chrome 37-42\n// is at very low usage worldwide, so we do a hacky userAgent check instead.\n//\n// content-type bug: https://code.google.com/p/chromium/issues/detail?id=408120\n// 404 bug: https://code.google.com/p/chromium/issues/detail?id=447916\n// FileReader bug: https://code.google.com/p/chromium/issues/detail?id=447836\n//\n// Code borrowed from PouchDB. See:\n// https://github.com/pouchdb/pouchdb/blob/master/packages/node_modules/pouchdb-adapter-idb/src/blobSupport.js\n//\nfunction _checkBlobSupportWithoutCaching(idb) {\n    return new Promise$1(function (resolve) {\n        var txn = idb.transaction(DETECT_BLOB_SUPPORT_STORE, READ_WRITE);\n        var blob = createBlob(['']);\n        txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob, 'key');\n\n        txn.onabort = function (e) {\n            // If the transaction aborts now its due to not being able to\n            // write to the database, likely due to the disk being full\n            e.preventDefault();\n            e.stopPropagation();\n            resolve(false);\n        };\n\n        txn.oncomplete = function () {\n            var matchedChrome = navigator.userAgent.match(/Chrome\\/(\\d+)/);\n            var matchedEdge = navigator.userAgent.match(/Edge\\//);\n            // MS Edge pretends to be Chrome 42:\n            // https://msdn.microsoft.com/en-us/library/hh869301%28v=vs.85%29.aspx\n            resolve(matchedEdge || !matchedChrome || parseInt(matchedChrome[1], 10) >= 43);\n        };\n    })[\"catch\"](function () {\n        return false; // error, so assume unsupported\n    });\n}\n\nfunction _checkBlobSupport(idb) {\n    if (typeof supportsBlobs === 'boolean') {\n        return Promise$1.resolve(supportsBlobs);\n    }\n    return _checkBlobSupportWithoutCaching(idb).then(function (value) {\n        supportsBlobs = value;\n        return supportsBlobs;\n    });\n}\n\nfunction _deferReadiness(dbInfo) {\n    var dbContext = dbContexts[dbInfo.name];\n\n    // Create a deferred object representing the current database operation.\n    var deferredOperation = {};\n\n    deferredOperation.promise = new Promise$1(function (resolve, reject) {\n        deferredOperation.resolve = resolve;\n        deferredOperation.reject = reject;\n    });\n\n    // Enqueue the deferred operation.\n    dbContext.deferredOperations.push(deferredOperation);\n\n    // Chain its promise to the database readiness.\n    if (!dbContext.dbReady) {\n        dbContext.dbReady = deferredOperation.promise;\n    } else {\n        dbContext.dbReady = dbContext.dbReady.then(function () {\n            return deferredOperation.promise;\n        });\n    }\n}\n\nfunction _advanceReadiness(dbInfo) {\n    var dbContext = dbContexts[dbInfo.name];\n\n    // Dequeue a deferred operation.\n    var deferredOperation = dbContext.deferredOperations.pop();\n\n    // Resolve its promise (which is part of the database readiness\n    // chain of promises).\n    if (deferredOperation) {\n        deferredOperation.resolve();\n        return deferredOperation.promise;\n    }\n}\n\nfunction _rejectReadiness(dbInfo, err) {\n    var dbContext = dbContexts[dbInfo.name];\n\n    // Dequeue a deferred operation.\n    var deferredOperation = dbContext.deferredOperations.pop();\n\n    // Reject its promise (which is part of the database readiness\n    // chain of promises).\n    if (deferredOperation) {\n        deferredOperation.reject(err);\n        return deferredOperation.promise;\n    }\n}\n\nfunction _getConnection(dbInfo, upgradeNeeded) {\n    return new Promise$1(function (resolve, reject) {\n        dbContexts[dbInfo.name] = dbContexts[dbInfo.name] || createDbContext();\n\n        if (dbInfo.db) {\n            if (upgradeNeeded) {\n                _deferReadiness(dbInfo);\n                dbInfo.db.close();\n            } else {\n                return resolve(dbInfo.db);\n            }\n        }\n\n        var dbArgs = [dbInfo.name];\n\n        if (upgradeNeeded) {\n            dbArgs.push(dbInfo.version);\n        }\n\n        var openreq = idb.open.apply(idb, dbArgs);\n\n        if (upgradeNeeded) {\n            openreq.onupgradeneeded = function (e) {\n                var db = openreq.result;\n                try {\n                    db.createObjectStore(dbInfo.storeName);\n                    if (e.oldVersion <= 1) {\n                        // Added when support for blob shims was added\n                        db.createObjectStore(DETECT_BLOB_SUPPORT_STORE);\n                    }\n                } catch (ex) {\n                    if (ex.name === 'ConstraintError') {\n                        console.warn('The database \"' + dbInfo.name + '\"' + ' has been upgraded from version ' + e.oldVersion + ' to version ' + e.newVersion + ', but the storage \"' + dbInfo.storeName + '\" already exists.');\n                    } else {\n                        throw ex;\n                    }\n                }\n            };\n        }\n\n        openreq.onerror = function (e) {\n            e.preventDefault();\n            reject(openreq.error);\n        };\n\n        openreq.onsuccess = function () {\n            var db = openreq.result;\n            db.onversionchange = function (e) {\n                // Triggered when the database is modified (e.g. adding an objectStore) or\n                // deleted (even when initiated by other sessions in different tabs).\n                // Closing the connection here prevents those operations from being blocked.\n                // If the database is accessed again later by this instance, the connection\n                // will be reopened or the database recreated as needed.\n                e.target.close();\n            };\n            resolve(db);\n            _advanceReadiness(dbInfo);\n        };\n    });\n}\n\nfunction _getOriginalConnection(dbInfo) {\n    return _getConnection(dbInfo, false);\n}\n\nfunction _getUpgradedConnection(dbInfo) {\n    return _getConnection(dbInfo, true);\n}\n\nfunction _isUpgradeNeeded(dbInfo, defaultVersion) {\n    if (!dbInfo.db) {\n        return true;\n    }\n\n    var isNewStore = !dbInfo.db.objectStoreNames.contains(dbInfo.storeName);\n    var isDowngrade = dbInfo.version < dbInfo.db.version;\n    var isUpgrade = dbInfo.version > dbInfo.db.version;\n\n    if (isDowngrade) {\n        // If the version is not the default one\n        // then warn for impossible downgrade.\n        if (dbInfo.version !== defaultVersion) {\n            console.warn('The database \"' + dbInfo.name + '\"' + \" can't be downgraded from version \" + dbInfo.db.version + ' to version ' + dbInfo.version + '.');\n        }\n        // Align the versions to prevent errors.\n        dbInfo.version = dbInfo.db.version;\n    }\n\n    if (isUpgrade || isNewStore) {\n        // If the store is new then increment the version (if needed).\n        // This will trigger an \"upgradeneeded\" event which is required\n        // for creating a store.\n        if (isNewStore) {\n            var incVersion = dbInfo.db.version + 1;\n            if (incVersion > dbInfo.version) {\n                dbInfo.version = incVersion;\n            }\n        }\n\n        return true;\n    }\n\n    return false;\n}\n\n// encode a blob for indexeddb engines that don't support blobs\nfunction _encodeBlob(blob) {\n    return new Promise$1(function (resolve, reject) {\n        var reader = new FileReader();\n        reader.onerror = reject;\n        reader.onloadend = function (e) {\n            var base64 = btoa(e.target.result || '');\n            resolve({\n                __local_forage_encoded_blob: true,\n                data: base64,\n                type: blob.type\n            });\n        };\n        reader.readAsBinaryString(blob);\n    });\n}\n\n// decode an encoded blob\nfunction _decodeBlob(encodedBlob) {\n    var arrayBuff = _binStringToArrayBuffer(atob(encodedBlob.data));\n    return createBlob([arrayBuff], { type: encodedBlob.type });\n}\n\n// is this one of our fancy encoded blobs?\nfunction _isEncodedBlob(value) {\n    return value && value.__local_forage_encoded_blob;\n}\n\n// Specialize the default `ready()` function by making it dependent\n// on the current database operations. Thus, the driver will be actually\n// ready when it's been initialized (default) *and* there are no pending\n// operations on the database (initiated by some other instances).\nfunction _fullyReady(callback) {\n    var self = this;\n\n    var promise = self._initReady().then(function () {\n        var dbContext = dbContexts[self._dbInfo.name];\n\n        if (dbContext && dbContext.dbReady) {\n            return dbContext.dbReady;\n        }\n    });\n\n    executeTwoCallbacks(promise, callback, callback);\n    return promise;\n}\n\n// Try to establish a new db connection to replace the\n// current one which is broken (i.e. experiencing\n// InvalidStateError while creating a transaction).\nfunction _tryReconnect(dbInfo) {\n    _deferReadiness(dbInfo);\n\n    var dbContext = dbContexts[dbInfo.name];\n    var forages = dbContext.forages;\n\n    for (var i = 0; i < forages.length; i++) {\n        var forage = forages[i];\n        if (forage._dbInfo.db) {\n            forage._dbInfo.db.close();\n            forage._dbInfo.db = null;\n        }\n    }\n    dbInfo.db = null;\n\n    return _getOriginalConnection(dbInfo).then(function (db) {\n        dbInfo.db = db;\n        if (_isUpgradeNeeded(dbInfo)) {\n            // Reopen the database for upgrading.\n            return _getUpgradedConnection(dbInfo);\n        }\n        return db;\n    }).then(function (db) {\n        // store the latest db reference\n        // in case the db was upgraded\n        dbInfo.db = dbContext.db = db;\n        for (var i = 0; i < forages.length; i++) {\n            forages[i]._dbInfo.db = db;\n        }\n    })[\"catch\"](function (err) {\n        _rejectReadiness(dbInfo, err);\n        throw err;\n    });\n}\n\n// FF doesn't like Promises (micro-tasks) and IDDB store operations,\n// so we have to do it with callbacks\nfunction createTransaction(dbInfo, mode, callback, retries) {\n    if (retries === undefined) {\n        retries = 1;\n    }\n\n    try {\n        var tx = dbInfo.db.transaction(dbInfo.storeName, mode);\n        callback(null, tx);\n    } catch (err) {\n        if (retries > 0 && (!dbInfo.db || err.name === 'InvalidStateError' || err.name === 'NotFoundError')) {\n            return Promise$1.resolve().then(function () {\n                if (!dbInfo.db || err.name === 'NotFoundError' && !dbInfo.db.objectStoreNames.contains(dbInfo.storeName) && dbInfo.version <= dbInfo.db.version) {\n                    // increase the db version, to create the new ObjectStore\n                    if (dbInfo.db) {\n                        dbInfo.version = dbInfo.db.version + 1;\n                    }\n                    // Reopen the database for upgrading.\n                    return _getUpgradedConnection(dbInfo);\n                }\n            }).then(function () {\n                return _tryReconnect(dbInfo).then(function () {\n                    createTransaction(dbInfo, mode, callback, retries - 1);\n                });\n            })[\"catch\"](callback);\n        }\n\n        callback(err);\n    }\n}\n\nfunction createDbContext() {\n    return {\n        // Running localForages sharing a database.\n        forages: [],\n        // Shared database.\n        db: null,\n        // Database readiness (promise).\n        dbReady: null,\n        // Deferred operations on the database.\n        deferredOperations: []\n    };\n}\n\n// Open the IndexedDB database (automatically creates one if one didn't\n// previously exist), using any options set in the config.\nfunction _initStorage(options) {\n    var self = this;\n    var dbInfo = {\n        db: null\n    };\n\n    if (options) {\n        for (var i in options) {\n            dbInfo[i] = options[i];\n        }\n    }\n\n    // Get the current context of the database;\n    var dbContext = dbContexts[dbInfo.name];\n\n    // ...or create a new context.\n    if (!dbContext) {\n        dbContext = createDbContext();\n        // Register the new context in the global container.\n        dbContexts[dbInfo.name] = dbContext;\n    }\n\n    // Register itself as a running localForage in the current context.\n    dbContext.forages.push(self);\n\n    // Replace the default `ready()` function with the specialized one.\n    if (!self._initReady) {\n        self._initReady = self.ready;\n        self.ready = _fullyReady;\n    }\n\n    // Create an array of initialization states of the related localForages.\n    var initPromises = [];\n\n    function ignoreErrors() {\n        // Don't handle errors here,\n        // just makes sure related localForages aren't pending.\n        return Promise$1.resolve();\n    }\n\n    for (var j = 0; j < dbContext.forages.length; j++) {\n        var forage = dbContext.forages[j];\n        if (forage !== self) {\n            // Don't wait for itself...\n            initPromises.push(forage._initReady()[\"catch\"](ignoreErrors));\n        }\n    }\n\n    // Take a snapshot of the related localForages.\n    var forages = dbContext.forages.slice(0);\n\n    // Initialize the connection process only when\n    // all the related localForages aren't pending.\n    return Promise$1.all(initPromises).then(function () {\n        dbInfo.db = dbContext.db;\n        // Get the connection or open a new one without upgrade.\n        return _getOriginalConnection(dbInfo);\n    }).then(function (db) {\n        dbInfo.db = db;\n        if (_isUpgradeNeeded(dbInfo, self._defaultConfig.version)) {\n            // Reopen the database for upgrading.\n            return _getUpgradedConnection(dbInfo);\n        }\n        return db;\n    }).then(function (db) {\n        dbInfo.db = dbContext.db = db;\n        self._dbInfo = dbInfo;\n        // Share the final connection amongst related localForages.\n        for (var k = 0; k < forages.length; k++) {\n            var forage = forages[k];\n            if (forage !== self) {\n                // Self is already up-to-date.\n                forage._dbInfo.db = dbInfo.db;\n                forage._dbInfo.version = dbInfo.version;\n            }\n        }\n    });\n}\n\nfunction getItem(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.get(key);\n\n                    req.onsuccess = function () {\n                        var value = req.result;\n                        if (value === undefined) {\n                            value = null;\n                        }\n                        if (_isEncodedBlob(value)) {\n                            value = _decodeBlob(value);\n                        }\n                        resolve(value);\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Iterate over all items stored in database.\nfunction iterate(iterator, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.openCursor();\n                    var iterationNumber = 1;\n\n                    req.onsuccess = function () {\n                        var cursor = req.result;\n\n                        if (cursor) {\n                            var value = cursor.value;\n                            if (_isEncodedBlob(value)) {\n                                value = _decodeBlob(value);\n                            }\n                            var result = iterator(value, cursor.key, iterationNumber++);\n\n                            // when the iterator callback returns any\n                            // (non-`undefined`) value, then we stop\n                            // the iteration immediately\n                            if (result !== void 0) {\n                                resolve(result);\n                            } else {\n                                cursor[\"continue\"]();\n                            }\n                        } else {\n                            resolve();\n                        }\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n\n    return promise;\n}\n\nfunction setItem(key, value, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        var dbInfo;\n        self.ready().then(function () {\n            dbInfo = self._dbInfo;\n            if (toString.call(value) === '[object Blob]') {\n                return _checkBlobSupport(dbInfo.db).then(function (blobSupport) {\n                    if (blobSupport) {\n                        return value;\n                    }\n                    return _encodeBlob(value);\n                });\n            }\n            return value;\n        }).then(function (value) {\n            createTransaction(self._dbInfo, READ_WRITE, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n\n                    // The reason we don't _save_ null is because IE 10 does\n                    // not support saving the `null` type in IndexedDB. How\n                    // ironic, given the bug below!\n                    // See: https://github.com/mozilla/localForage/issues/161\n                    if (value === null) {\n                        value = undefined;\n                    }\n\n                    var req = store.put(value, key);\n\n                    transaction.oncomplete = function () {\n                        // Cast to undefined so the value passed to\n                        // callback/promise is the same as what one would get out\n                        // of `getItem()` later. This leads to some weirdness\n                        // (setItem('foo', undefined) will return `null`), but\n                        // it's not my fault localStorage is our baseline and that\n                        // it's weird.\n                        if (value === undefined) {\n                            value = null;\n                        }\n\n                        resolve(value);\n                    };\n                    transaction.onabort = transaction.onerror = function () {\n                        var err = req.error ? req.error : req.transaction.error;\n                        reject(err);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction removeItem(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_WRITE, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    // We use a Grunt task to make this safe for IE and some\n                    // versions of Android (including those used by Cordova).\n                    // Normally IE won't like `.delete()` and will insist on\n                    // using `['delete']()`, but we have a build step that\n                    // fixes this for us now.\n                    var req = store[\"delete\"](key);\n                    transaction.oncomplete = function () {\n                        resolve();\n                    };\n\n                    transaction.onerror = function () {\n                        reject(req.error);\n                    };\n\n                    // The request will be also be aborted if we've exceeded our storage\n                    // space.\n                    transaction.onabort = function () {\n                        var err = req.error ? req.error : req.transaction.error;\n                        reject(err);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction clear(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_WRITE, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.clear();\n\n                    transaction.oncomplete = function () {\n                        resolve();\n                    };\n\n                    transaction.onabort = transaction.onerror = function () {\n                        var err = req.error ? req.error : req.transaction.error;\n                        reject(err);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction length(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.count();\n\n                    req.onsuccess = function () {\n                        resolve(req.result);\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction key(n, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        if (n < 0) {\n            resolve(null);\n\n            return;\n        }\n\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var advanced = false;\n                    var req = store.openKeyCursor();\n\n                    req.onsuccess = function () {\n                        var cursor = req.result;\n                        if (!cursor) {\n                            // this means there weren't enough keys\n                            resolve(null);\n\n                            return;\n                        }\n\n                        if (n === 0) {\n                            // We have the first key, return it if that's what they\n                            // wanted.\n                            resolve(cursor.key);\n                        } else {\n                            if (!advanced) {\n                                // Otherwise, ask the cursor to skip ahead n\n                                // records.\n                                advanced = true;\n                                cursor.advance(n);\n                            } else {\n                                // When we get here, we've got the nth key.\n                                resolve(cursor.key);\n                            }\n                        }\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction keys(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.openKeyCursor();\n                    var keys = [];\n\n                    req.onsuccess = function () {\n                        var cursor = req.result;\n\n                        if (!cursor) {\n                            resolve(keys);\n                            return;\n                        }\n\n                        keys.push(cursor.key);\n                        cursor[\"continue\"]();\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction dropInstance(options, callback) {\n    callback = getCallback.apply(this, arguments);\n\n    var currentConfig = this.config();\n    options = typeof options !== 'function' && options || {};\n    if (!options.name) {\n        options.name = options.name || currentConfig.name;\n        options.storeName = options.storeName || currentConfig.storeName;\n    }\n\n    var self = this;\n    var promise;\n    if (!options.name) {\n        promise = Promise$1.reject('Invalid arguments');\n    } else {\n        var isCurrentDb = options.name === currentConfig.name && self._dbInfo.db;\n\n        var dbPromise = isCurrentDb ? Promise$1.resolve(self._dbInfo.db) : _getOriginalConnection(options).then(function (db) {\n            var dbContext = dbContexts[options.name];\n            var forages = dbContext.forages;\n            dbContext.db = db;\n            for (var i = 0; i < forages.length; i++) {\n                forages[i]._dbInfo.db = db;\n            }\n            return db;\n        });\n\n        if (!options.storeName) {\n            promise = dbPromise.then(function (db) {\n                _deferReadiness(options);\n\n                var dbContext = dbContexts[options.name];\n                var forages = dbContext.forages;\n\n                db.close();\n                for (var i = 0; i < forages.length; i++) {\n                    var forage = forages[i];\n                    forage._dbInfo.db = null;\n                }\n\n                var dropDBPromise = new Promise$1(function (resolve, reject) {\n                    var req = idb.deleteDatabase(options.name);\n\n                    req.onerror = function () {\n                        var db = req.result;\n                        if (db) {\n                            db.close();\n                        }\n                        reject(req.error);\n                    };\n\n                    req.onblocked = function () {\n                        // Closing all open connections in onversionchange handler should prevent this situation, but if\n                        // we do get here, it just means the request remains pending - eventually it will succeed or error\n                        console.warn('dropInstance blocked for database \"' + options.name + '\" until all open connections are closed');\n                    };\n\n                    req.onsuccess = function () {\n                        var db = req.result;\n                        if (db) {\n                            db.close();\n                        }\n                        resolve(db);\n                    };\n                });\n\n                return dropDBPromise.then(function (db) {\n                    dbContext.db = db;\n                    for (var i = 0; i < forages.length; i++) {\n                        var _forage = forages[i];\n                        _advanceReadiness(_forage._dbInfo);\n                    }\n                })[\"catch\"](function (err) {\n                    (_rejectReadiness(options, err) || Promise$1.resolve())[\"catch\"](function () {});\n                    throw err;\n                });\n            });\n        } else {\n            promise = dbPromise.then(function (db) {\n                if (!db.objectStoreNames.contains(options.storeName)) {\n                    return;\n                }\n\n                var newVersion = db.version + 1;\n\n                _deferReadiness(options);\n\n                var dbContext = dbContexts[options.name];\n                var forages = dbContext.forages;\n\n                db.close();\n                for (var i = 0; i < forages.length; i++) {\n                    var forage = forages[i];\n                    forage._dbInfo.db = null;\n                    forage._dbInfo.version = newVersion;\n                }\n\n                var dropObjectPromise = new Promise$1(function (resolve, reject) {\n                    var req = idb.open(options.name, newVersion);\n\n                    req.onerror = function (err) {\n                        var db = req.result;\n                        db.close();\n                        reject(err);\n                    };\n\n                    req.onupgradeneeded = function () {\n                        var db = req.result;\n                        db.deleteObjectStore(options.storeName);\n                    };\n\n                    req.onsuccess = function () {\n                        var db = req.result;\n                        db.close();\n                        resolve(db);\n                    };\n                });\n\n                return dropObjectPromise.then(function (db) {\n                    dbContext.db = db;\n                    for (var j = 0; j < forages.length; j++) {\n                        var _forage2 = forages[j];\n                        _forage2._dbInfo.db = db;\n                        _advanceReadiness(_forage2._dbInfo);\n                    }\n                })[\"catch\"](function (err) {\n                    (_rejectReadiness(options, err) || Promise$1.resolve())[\"catch\"](function () {});\n                    throw err;\n                });\n            });\n        }\n    }\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nvar asyncStorage = {\n    _driver: 'asyncStorage',\n    _initStorage: _initStorage,\n    _support: isIndexedDBValid(),\n    iterate: iterate,\n    getItem: getItem,\n    setItem: setItem,\n    removeItem: removeItem,\n    clear: clear,\n    length: length,\n    key: key,\n    keys: keys,\n    dropInstance: dropInstance\n};\n\nfunction isWebSQLValid() {\n    return typeof openDatabase === 'function';\n}\n\n// Sadly, the best way to save binary data in WebSQL/localStorage is serializing\n// it to Base64, so this is how we store it to prevent very strange errors with less\n// verbose ways of binary <-> string data storage.\nvar BASE_CHARS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\nvar BLOB_TYPE_PREFIX = '~~local_forage_type~';\nvar BLOB_TYPE_PREFIX_REGEX = /^~~local_forage_type~([^~]+)~/;\n\nvar SERIALIZED_MARKER = '__lfsc__:';\nvar SERIALIZED_MARKER_LENGTH = SERIALIZED_MARKER.length;\n\n// OMG the serializations!\nvar TYPE_ARRAYBUFFER = 'arbf';\nvar TYPE_BLOB = 'blob';\nvar TYPE_INT8ARRAY = 'si08';\nvar TYPE_UINT8ARRAY = 'ui08';\nvar TYPE_UINT8CLAMPEDARRAY = 'uic8';\nvar TYPE_INT16ARRAY = 'si16';\nvar TYPE_INT32ARRAY = 'si32';\nvar TYPE_UINT16ARRAY = 'ur16';\nvar TYPE_UINT32ARRAY = 'ui32';\nvar TYPE_FLOAT32ARRAY = 'fl32';\nvar TYPE_FLOAT64ARRAY = 'fl64';\nvar TYPE_SERIALIZED_MARKER_LENGTH = SERIALIZED_MARKER_LENGTH + TYPE_ARRAYBUFFER.length;\n\nvar toString$1 = Object.prototype.toString;\n\nfunction stringToBuffer(serializedString) {\n    // Fill the string into a ArrayBuffer.\n    var bufferLength = serializedString.length * 0.75;\n    var len = serializedString.length;\n    var i;\n    var p = 0;\n    var encoded1, encoded2, encoded3, encoded4;\n\n    if (serializedString[serializedString.length - 1] === '=') {\n        bufferLength--;\n        if (serializedString[serializedString.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n\n    var buffer = new ArrayBuffer(bufferLength);\n    var bytes = new Uint8Array(buffer);\n\n    for (i = 0; i < len; i += 4) {\n        encoded1 = BASE_CHARS.indexOf(serializedString[i]);\n        encoded2 = BASE_CHARS.indexOf(serializedString[i + 1]);\n        encoded3 = BASE_CHARS.indexOf(serializedString[i + 2]);\n        encoded4 = BASE_CHARS.indexOf(serializedString[i + 3]);\n\n        /*jslint bitwise: true */\n        bytes[p++] = encoded1 << 2 | encoded2 >> 4;\n        bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;\n        bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;\n    }\n    return buffer;\n}\n\n// Converts a buffer to a string to store, serialized, in the backend\n// storage library.\nfunction bufferToString(buffer) {\n    // base64-arraybuffer\n    var bytes = new Uint8Array(buffer);\n    var base64String = '';\n    var i;\n\n    for (i = 0; i < bytes.length; i += 3) {\n        /*jslint bitwise: true */\n        base64String += BASE_CHARS[bytes[i] >> 2];\n        base64String += BASE_CHARS[(bytes[i] & 3) << 4 | bytes[i + 1] >> 4];\n        base64String += BASE_CHARS[(bytes[i + 1] & 15) << 2 | bytes[i + 2] >> 6];\n        base64String += BASE_CHARS[bytes[i + 2] & 63];\n    }\n\n    if (bytes.length % 3 === 2) {\n        base64String = base64String.substring(0, base64String.length - 1) + '=';\n    } else if (bytes.length % 3 === 1) {\n        base64String = base64String.substring(0, base64String.length - 2) + '==';\n    }\n\n    return base64String;\n}\n\n// Serialize a value, afterwards executing a callback (which usually\n// instructs the `setItem()` callback/promise to be executed). This is how\n// we store binary data with localStorage.\nfunction serialize(value, callback) {\n    var valueType = '';\n    if (value) {\n        valueType = toString$1.call(value);\n    }\n\n    // Cannot use `value instanceof ArrayBuffer` or such here, as these\n    // checks fail when running the tests using casper.js...\n    //\n    // TODO: See why those tests fail and use a better solution.\n    if (value && (valueType === '[object ArrayBuffer]' || value.buffer && toString$1.call(value.buffer) === '[object ArrayBuffer]')) {\n        // Convert binary arrays to a string and prefix the string with\n        // a special marker.\n        var buffer;\n        var marker = SERIALIZED_MARKER;\n\n        if (value instanceof ArrayBuffer) {\n            buffer = value;\n            marker += TYPE_ARRAYBUFFER;\n        } else {\n            buffer = value.buffer;\n\n            if (valueType === '[object Int8Array]') {\n                marker += TYPE_INT8ARRAY;\n            } else if (valueType === '[object Uint8Array]') {\n                marker += TYPE_UINT8ARRAY;\n            } else if (valueType === '[object Uint8ClampedArray]') {\n                marker += TYPE_UINT8CLAMPEDARRAY;\n            } else if (valueType === '[object Int16Array]') {\n                marker += TYPE_INT16ARRAY;\n            } else if (valueType === '[object Uint16Array]') {\n                marker += TYPE_UINT16ARRAY;\n            } else if (valueType === '[object Int32Array]') {\n                marker += TYPE_INT32ARRAY;\n            } else if (valueType === '[object Uint32Array]') {\n                marker += TYPE_UINT32ARRAY;\n            } else if (valueType === '[object Float32Array]') {\n                marker += TYPE_FLOAT32ARRAY;\n            } else if (valueType === '[object Float64Array]') {\n                marker += TYPE_FLOAT64ARRAY;\n            } else {\n                callback(new Error('Failed to get type for BinaryArray'));\n            }\n        }\n\n        callback(marker + bufferToString(buffer));\n    } else if (valueType === '[object Blob]') {\n        // Conver the blob to a binaryArray and then to a string.\n        var fileReader = new FileReader();\n\n        fileReader.onload = function () {\n            // Backwards-compatible prefix for the blob type.\n            var str = BLOB_TYPE_PREFIX + value.type + '~' + bufferToString(this.result);\n\n            callback(SERIALIZED_MARKER + TYPE_BLOB + str);\n        };\n\n        fileReader.readAsArrayBuffer(value);\n    } else {\n        try {\n            callback(JSON.stringify(value));\n        } catch (e) {\n            console.error(\"Couldn't convert value into a JSON string: \", value);\n\n            callback(null, e);\n        }\n    }\n}\n\n// Deserialize data we've inserted into a value column/field. We place\n// special markers into our strings to mark them as encoded; this isn't\n// as nice as a meta field, but it's the only sane thing we can do whilst\n// keeping localStorage support intact.\n//\n// Oftentimes this will just deserialize JSON content, but if we have a\n// special marker (SERIALIZED_MARKER, defined above), we will extract\n// some kind of arraybuffer/binary data/typed array out of the string.\nfunction deserialize(value) {\n    // If we haven't marked this string as being specially serialized (i.e.\n    // something other than serialized JSON), we can just return it and be\n    // done with it.\n    if (value.substring(0, SERIALIZED_MARKER_LENGTH) !== SERIALIZED_MARKER) {\n        return JSON.parse(value);\n    }\n\n    // The following code deals with deserializing some kind of Blob or\n    // TypedArray. First we separate out the type of data we're dealing\n    // with from the data itself.\n    var serializedString = value.substring(TYPE_SERIALIZED_MARKER_LENGTH);\n    var type = value.substring(SERIALIZED_MARKER_LENGTH, TYPE_SERIALIZED_MARKER_LENGTH);\n\n    var blobType;\n    // Backwards-compatible blob type serialization strategy.\n    // DBs created with older versions of localForage will simply not have the blob type.\n    if (type === TYPE_BLOB && BLOB_TYPE_PREFIX_REGEX.test(serializedString)) {\n        var matcher = serializedString.match(BLOB_TYPE_PREFIX_REGEX);\n        blobType = matcher[1];\n        serializedString = serializedString.substring(matcher[0].length);\n    }\n    var buffer = stringToBuffer(serializedString);\n\n    // Return the right type based on the code/type set during\n    // serialization.\n    switch (type) {\n        case TYPE_ARRAYBUFFER:\n            return buffer;\n        case TYPE_BLOB:\n            return createBlob([buffer], { type: blobType });\n        case TYPE_INT8ARRAY:\n            return new Int8Array(buffer);\n        case TYPE_UINT8ARRAY:\n            return new Uint8Array(buffer);\n        case TYPE_UINT8CLAMPEDARRAY:\n            return new Uint8ClampedArray(buffer);\n        case TYPE_INT16ARRAY:\n            return new Int16Array(buffer);\n        case TYPE_UINT16ARRAY:\n            return new Uint16Array(buffer);\n        case TYPE_INT32ARRAY:\n            return new Int32Array(buffer);\n        case TYPE_UINT32ARRAY:\n            return new Uint32Array(buffer);\n        case TYPE_FLOAT32ARRAY:\n            return new Float32Array(buffer);\n        case TYPE_FLOAT64ARRAY:\n            return new Float64Array(buffer);\n        default:\n            throw new Error('Unkown type: ' + type);\n    }\n}\n\nvar localforageSerializer = {\n    serialize: serialize,\n    deserialize: deserialize,\n    stringToBuffer: stringToBuffer,\n    bufferToString: bufferToString\n};\n\n/*\n * Includes code from:\n *\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n\nfunction createDbTable(t, dbInfo, callback, errorCallback) {\n    t.executeSql('CREATE TABLE IF NOT EXISTS ' + dbInfo.storeName + ' ' + '(id INTEGER PRIMARY KEY, key unique, value)', [], callback, errorCallback);\n}\n\n// Open the WebSQL database (automatically creates one if one didn't\n// previously exist), using any options set in the config.\nfunction _initStorage$1(options) {\n    var self = this;\n    var dbInfo = {\n        db: null\n    };\n\n    if (options) {\n        for (var i in options) {\n            dbInfo[i] = typeof options[i] !== 'string' ? options[i].toString() : options[i];\n        }\n    }\n\n    var dbInfoPromise = new Promise$1(function (resolve, reject) {\n        // Open the database; the openDatabase API will automatically\n        // create it for us if it doesn't exist.\n        try {\n            dbInfo.db = openDatabase(dbInfo.name, String(dbInfo.version), dbInfo.description, dbInfo.size);\n        } catch (e) {\n            return reject(e);\n        }\n\n        // Create our key/value table if it doesn't exist.\n        dbInfo.db.transaction(function (t) {\n            createDbTable(t, dbInfo, function () {\n                self._dbInfo = dbInfo;\n                resolve();\n            }, function (t, error) {\n                reject(error);\n            });\n        }, reject);\n    });\n\n    dbInfo.serializer = localforageSerializer;\n    return dbInfoPromise;\n}\n\nfunction tryExecuteSql(t, dbInfo, sqlStatement, args, callback, errorCallback) {\n    t.executeSql(sqlStatement, args, callback, function (t, error) {\n        if (error.code === error.SYNTAX_ERR) {\n            t.executeSql('SELECT name FROM sqlite_master ' + \"WHERE type='table' AND name = ?\", [dbInfo.storeName], function (t, results) {\n                if (!results.rows.length) {\n                    // if the table is missing (was deleted)\n                    // re-create it table and retry\n                    createDbTable(t, dbInfo, function () {\n                        t.executeSql(sqlStatement, args, callback, errorCallback);\n                    }, errorCallback);\n                } else {\n                    errorCallback(t, error);\n                }\n            }, errorCallback);\n        } else {\n            errorCallback(t, error);\n        }\n    }, errorCallback);\n}\n\nfunction getItem$1(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT * FROM ' + dbInfo.storeName + ' WHERE key = ? LIMIT 1', [key], function (t, results) {\n                    var result = results.rows.length ? results.rows.item(0).value : null;\n\n                    // Check to see if this is serialized content we need to\n                    // unpack.\n                    if (result) {\n                        result = dbInfo.serializer.deserialize(result);\n                    }\n\n                    resolve(result);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction iterate$1(iterator, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT * FROM ' + dbInfo.storeName, [], function (t, results) {\n                    var rows = results.rows;\n                    var length = rows.length;\n\n                    for (var i = 0; i < length; i++) {\n                        var item = rows.item(i);\n                        var result = item.value;\n\n                        // Check to see if this is serialized content\n                        // we need to unpack.\n                        if (result) {\n                            result = dbInfo.serializer.deserialize(result);\n                        }\n\n                        result = iterator(result, item.key, i + 1);\n\n                        // void(0) prevents problems with redefinition\n                        // of `undefined`.\n                        if (result !== void 0) {\n                            resolve(result);\n                            return;\n                        }\n                    }\n\n                    resolve();\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction _setItem(key, value, callback, retriesLeft) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            // The localStorage API doesn't return undefined values in an\n            // \"expected\" way, so undefined is always cast to null in all\n            // drivers. See: https://github.com/mozilla/localForage/pull/42\n            if (value === undefined) {\n                value = null;\n            }\n\n            // Save the original value to pass to the callback.\n            var originalValue = value;\n\n            var dbInfo = self._dbInfo;\n            dbInfo.serializer.serialize(value, function (value, error) {\n                if (error) {\n                    reject(error);\n                } else {\n                    dbInfo.db.transaction(function (t) {\n                        tryExecuteSql(t, dbInfo, 'INSERT OR REPLACE INTO ' + dbInfo.storeName + ' ' + '(key, value) VALUES (?, ?)', [key, value], function () {\n                            resolve(originalValue);\n                        }, function (t, error) {\n                            reject(error);\n                        });\n                    }, function (sqlError) {\n                        // The transaction failed; check\n                        // to see if it's a quota error.\n                        if (sqlError.code === sqlError.QUOTA_ERR) {\n                            // We reject the callback outright for now, but\n                            // it's worth trying to re-run the transaction.\n                            // Even if the user accepts the prompt to use\n                            // more storage on Safari, this error will\n                            // be called.\n                            //\n                            // Try to re-run the transaction.\n                            if (retriesLeft > 0) {\n                                resolve(_setItem.apply(self, [key, originalValue, callback, retriesLeft - 1]));\n                                return;\n                            }\n                            reject(sqlError);\n                        }\n                    });\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction setItem$1(key, value, callback) {\n    return _setItem.apply(this, [key, value, callback, 1]);\n}\n\nfunction removeItem$1(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'DELETE FROM ' + dbInfo.storeName + ' WHERE key = ?', [key], function () {\n                    resolve();\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Deletes every item in the table.\n// TODO: Find out if this resets the AUTO_INCREMENT number.\nfunction clear$1(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'DELETE FROM ' + dbInfo.storeName, [], function () {\n                    resolve();\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Does a simple `COUNT(key)` to get the number of items stored in\n// localForage.\nfunction length$1(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                // Ahhh, SQL makes this one soooooo easy.\n                tryExecuteSql(t, dbInfo, 'SELECT COUNT(key) as c FROM ' + dbInfo.storeName, [], function (t, results) {\n                    var result = results.rows.item(0).c;\n                    resolve(result);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Return the key located at key index X; essentially gets the key from a\n// `WHERE id = ?`. This is the most efficient way I can think to implement\n// this rarely-used (in my experience) part of the API, but it can seem\n// inconsistent, because we do `INSERT OR REPLACE INTO` on `setItem()`, so\n// the ID of each key will change every time it's updated. Perhaps a stored\n// procedure for the `setItem()` SQL would solve this problem?\n// TODO: Don't change ID on `setItem()`.\nfunction key$1(n, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT key FROM ' + dbInfo.storeName + ' WHERE id = ? LIMIT 1', [n + 1], function (t, results) {\n                    var result = results.rows.length ? results.rows.item(0).key : null;\n                    resolve(result);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction keys$1(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT key FROM ' + dbInfo.storeName, [], function (t, results) {\n                    var keys = [];\n\n                    for (var i = 0; i < results.rows.length; i++) {\n                        keys.push(results.rows.item(i).key);\n                    }\n\n                    resolve(keys);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// https://www.w3.org/TR/webdatabase/#databases\n// > There is no way to enumerate or delete the databases available for an origin from this API.\nfunction getAllStoreNames(db) {\n    return new Promise$1(function (resolve, reject) {\n        db.transaction(function (t) {\n            t.executeSql('SELECT name FROM sqlite_master ' + \"WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'\", [], function (t, results) {\n                var storeNames = [];\n\n                for (var i = 0; i < results.rows.length; i++) {\n                    storeNames.push(results.rows.item(i).name);\n                }\n\n                resolve({\n                    db: db,\n                    storeNames: storeNames\n                });\n            }, function (t, error) {\n                reject(error);\n            });\n        }, function (sqlError) {\n            reject(sqlError);\n        });\n    });\n}\n\nfunction dropInstance$1(options, callback) {\n    callback = getCallback.apply(this, arguments);\n\n    var currentConfig = this.config();\n    options = typeof options !== 'function' && options || {};\n    if (!options.name) {\n        options.name = options.name || currentConfig.name;\n        options.storeName = options.storeName || currentConfig.storeName;\n    }\n\n    var self = this;\n    var promise;\n    if (!options.name) {\n        promise = Promise$1.reject('Invalid arguments');\n    } else {\n        promise = new Promise$1(function (resolve) {\n            var db;\n            if (options.name === currentConfig.name) {\n                // use the db reference of the current instance\n                db = self._dbInfo.db;\n            } else {\n                db = openDatabase(options.name, '', '', 0);\n            }\n\n            if (!options.storeName) {\n                // drop all database tables\n                resolve(getAllStoreNames(db));\n            } else {\n                resolve({\n                    db: db,\n                    storeNames: [options.storeName]\n                });\n            }\n        }).then(function (operationInfo) {\n            return new Promise$1(function (resolve, reject) {\n                operationInfo.db.transaction(function (t) {\n                    function dropTable(storeName) {\n                        return new Promise$1(function (resolve, reject) {\n                            t.executeSql('DROP TABLE IF EXISTS ' + storeName, [], function () {\n                                resolve();\n                            }, function (t, error) {\n                                reject(error);\n                            });\n                        });\n                    }\n\n                    var operations = [];\n                    for (var i = 0, len = operationInfo.storeNames.length; i < len; i++) {\n                        operations.push(dropTable(operationInfo.storeNames[i]));\n                    }\n\n                    Promise$1.all(operations).then(function () {\n                        resolve();\n                    })[\"catch\"](function (e) {\n                        reject(e);\n                    });\n                }, function (sqlError) {\n                    reject(sqlError);\n                });\n            });\n        });\n    }\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nvar webSQLStorage = {\n    _driver: 'webSQLStorage',\n    _initStorage: _initStorage$1,\n    _support: isWebSQLValid(),\n    iterate: iterate$1,\n    getItem: getItem$1,\n    setItem: setItem$1,\n    removeItem: removeItem$1,\n    clear: clear$1,\n    length: length$1,\n    key: key$1,\n    keys: keys$1,\n    dropInstance: dropInstance$1\n};\n\nfunction isLocalStorageValid() {\n    try {\n        return typeof localStorage !== 'undefined' && 'setItem' in localStorage &&\n        // in IE8 typeof localStorage.setItem === 'object'\n        !!localStorage.setItem;\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction _getKeyPrefix(options, defaultConfig) {\n    var keyPrefix = options.name + '/';\n\n    if (options.storeName !== defaultConfig.storeName) {\n        keyPrefix += options.storeName + '/';\n    }\n    return keyPrefix;\n}\n\n// Check if localStorage throws when saving an item\nfunction checkIfLocalStorageThrows() {\n    var localStorageTestKey = '_localforage_support_test';\n\n    try {\n        localStorage.setItem(localStorageTestKey, true);\n        localStorage.removeItem(localStorageTestKey);\n\n        return false;\n    } catch (e) {\n        return true;\n    }\n}\n\n// Check if localStorage is usable and allows to save an item\n// This method checks if localStorage is usable in Safari Private Browsing\n// mode, or in any other case where the available quota for localStorage\n// is 0 and there wasn't any saved items yet.\nfunction _isLocalStorageUsable() {\n    return !checkIfLocalStorageThrows() || localStorage.length > 0;\n}\n\n// Config the localStorage backend, using options set in the config.\nfunction _initStorage$2(options) {\n    var self = this;\n    var dbInfo = {};\n    if (options) {\n        for (var i in options) {\n            dbInfo[i] = options[i];\n        }\n    }\n\n    dbInfo.keyPrefix = _getKeyPrefix(options, self._defaultConfig);\n\n    if (!_isLocalStorageUsable()) {\n        return Promise$1.reject();\n    }\n\n    self._dbInfo = dbInfo;\n    dbInfo.serializer = localforageSerializer;\n\n    return Promise$1.resolve();\n}\n\n// Remove all keys from the datastore, effectively destroying all data in\n// the app's key/value store!\nfunction clear$2(callback) {\n    var self = this;\n    var promise = self.ready().then(function () {\n        var keyPrefix = self._dbInfo.keyPrefix;\n\n        for (var i = localStorage.length - 1; i >= 0; i--) {\n            var key = localStorage.key(i);\n\n            if (key.indexOf(keyPrefix) === 0) {\n                localStorage.removeItem(key);\n            }\n        }\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Retrieve an item from the store. Unlike the original async_storage\n// library in Gaia, we don't modify return values at all. If a key's value\n// is `undefined`, we pass that value to the callback function.\nfunction getItem$2(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var result = localStorage.getItem(dbInfo.keyPrefix + key);\n\n        // If a result was found, parse it from the serialized\n        // string into a JS object. If result isn't truthy, the key\n        // is likely undefined and we'll pass it straight to the\n        // callback.\n        if (result) {\n            result = dbInfo.serializer.deserialize(result);\n        }\n\n        return result;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Iterate over all items in the store.\nfunction iterate$2(iterator, callback) {\n    var self = this;\n\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var keyPrefix = dbInfo.keyPrefix;\n        var keyPrefixLength = keyPrefix.length;\n        var length = localStorage.length;\n\n        // We use a dedicated iterator instead of the `i` variable below\n        // so other keys we fetch in localStorage aren't counted in\n        // the `iterationNumber` argument passed to the `iterate()`\n        // callback.\n        //\n        // See: github.com/mozilla/localForage/pull/435#discussion_r38061530\n        var iterationNumber = 1;\n\n        for (var i = 0; i < length; i++) {\n            var key = localStorage.key(i);\n            if (key.indexOf(keyPrefix) !== 0) {\n                continue;\n            }\n            var value = localStorage.getItem(key);\n\n            // If a result was found, parse it from the serialized\n            // string into a JS object. If result isn't truthy, the\n            // key is likely undefined and we'll pass it straight\n            // to the iterator.\n            if (value) {\n                value = dbInfo.serializer.deserialize(value);\n            }\n\n            value = iterator(value, key.substring(keyPrefixLength), iterationNumber++);\n\n            if (value !== void 0) {\n                return value;\n            }\n        }\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Same as localStorage's key() method, except takes a callback.\nfunction key$2(n, callback) {\n    var self = this;\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var result;\n        try {\n            result = localStorage.key(n);\n        } catch (error) {\n            result = null;\n        }\n\n        // Remove the prefix from the key, if a key is found.\n        if (result) {\n            result = result.substring(dbInfo.keyPrefix.length);\n        }\n\n        return result;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction keys$2(callback) {\n    var self = this;\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var length = localStorage.length;\n        var keys = [];\n\n        for (var i = 0; i < length; i++) {\n            var itemKey = localStorage.key(i);\n            if (itemKey.indexOf(dbInfo.keyPrefix) === 0) {\n                keys.push(itemKey.substring(dbInfo.keyPrefix.length));\n            }\n        }\n\n        return keys;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Supply the number of keys in the datastore to the callback function.\nfunction length$2(callback) {\n    var self = this;\n    var promise = self.keys().then(function (keys) {\n        return keys.length;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Remove an item from the store, nice and simple.\nfunction removeItem$2(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        localStorage.removeItem(dbInfo.keyPrefix + key);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Set a key's value and run an optional callback once the value is set.\n// Unlike Gaia's implementation, the callback function is passed the value,\n// in case you want to operate on that value only after you're sure it\n// saved, or something like that.\nfunction setItem$2(key, value, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = self.ready().then(function () {\n        // Convert undefined values to null.\n        // https://github.com/mozilla/localForage/pull/42\n        if (value === undefined) {\n            value = null;\n        }\n\n        // Save the original value to pass to the callback.\n        var originalValue = value;\n\n        return new Promise$1(function (resolve, reject) {\n            var dbInfo = self._dbInfo;\n            dbInfo.serializer.serialize(value, function (value, error) {\n                if (error) {\n                    reject(error);\n                } else {\n                    try {\n                        localStorage.setItem(dbInfo.keyPrefix + key, value);\n                        resolve(originalValue);\n                    } catch (e) {\n                        // localStorage capacity exceeded.\n                        // TODO: Make this a specific error/event.\n                        if (e.name === 'QuotaExceededError' || e.name === 'NS_ERROR_DOM_QUOTA_REACHED') {\n                            reject(e);\n                        }\n                        reject(e);\n                    }\n                }\n            });\n        });\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction dropInstance$2(options, callback) {\n    callback = getCallback.apply(this, arguments);\n\n    options = typeof options !== 'function' && options || {};\n    if (!options.name) {\n        var currentConfig = this.config();\n        options.name = options.name || currentConfig.name;\n        options.storeName = options.storeName || currentConfig.storeName;\n    }\n\n    var self = this;\n    var promise;\n    if (!options.name) {\n        promise = Promise$1.reject('Invalid arguments');\n    } else {\n        promise = new Promise$1(function (resolve) {\n            if (!options.storeName) {\n                resolve(options.name + '/');\n            } else {\n                resolve(_getKeyPrefix(options, self._defaultConfig));\n            }\n        }).then(function (keyPrefix) {\n            for (var i = localStorage.length - 1; i >= 0; i--) {\n                var key = localStorage.key(i);\n\n                if (key.indexOf(keyPrefix) === 0) {\n                    localStorage.removeItem(key);\n                }\n            }\n        });\n    }\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nvar localStorageWrapper = {\n    _driver: 'localStorageWrapper',\n    _initStorage: _initStorage$2,\n    _support: isLocalStorageValid(),\n    iterate: iterate$2,\n    getItem: getItem$2,\n    setItem: setItem$2,\n    removeItem: removeItem$2,\n    clear: clear$2,\n    length: length$2,\n    key: key$2,\n    keys: keys$2,\n    dropInstance: dropInstance$2\n};\n\nvar sameValue = function sameValue(x, y) {\n    return x === y || typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y);\n};\n\nvar includes = function includes(array, searchElement) {\n    var len = array.length;\n    var i = 0;\n    while (i < len) {\n        if (sameValue(array[i], searchElement)) {\n            return true;\n        }\n        i++;\n    }\n\n    return false;\n};\n\nvar isArray = Array.isArray || function (arg) {\n    return Object.prototype.toString.call(arg) === '[object Array]';\n};\n\n// Drivers are stored here when `defineDriver()` is called.\n// They are shared across all instances of localForage.\nvar DefinedDrivers = {};\n\nvar DriverSupport = {};\n\nvar DefaultDrivers = {\n    INDEXEDDB: asyncStorage,\n    WEBSQL: webSQLStorage,\n    LOCALSTORAGE: localStorageWrapper\n};\n\nvar DefaultDriverOrder = [DefaultDrivers.INDEXEDDB._driver, DefaultDrivers.WEBSQL._driver, DefaultDrivers.LOCALSTORAGE._driver];\n\nvar OptionalDriverMethods = ['dropInstance'];\n\nvar LibraryMethods = ['clear', 'getItem', 'iterate', 'key', 'keys', 'length', 'removeItem', 'setItem'].concat(OptionalDriverMethods);\n\nvar DefaultConfig = {\n    description: '',\n    driver: DefaultDriverOrder.slice(),\n    name: 'localforage',\n    // Default DB size is _JUST UNDER_ 5MB, as it's the highest size\n    // we can use without a prompt.\n    size: 4980736,\n    storeName: 'keyvaluepairs',\n    version: 1.0\n};\n\nfunction callWhenReady(localForageInstance, libraryMethod) {\n    localForageInstance[libraryMethod] = function () {\n        var _args = arguments;\n        return localForageInstance.ready().then(function () {\n            return localForageInstance[libraryMethod].apply(localForageInstance, _args);\n        });\n    };\n}\n\nfunction extend() {\n    for (var i = 1; i < arguments.length; i++) {\n        var arg = arguments[i];\n\n        if (arg) {\n            for (var _key in arg) {\n                if (arg.hasOwnProperty(_key)) {\n                    if (isArray(arg[_key])) {\n                        arguments[0][_key] = arg[_key].slice();\n                    } else {\n                        arguments[0][_key] = arg[_key];\n                    }\n                }\n            }\n        }\n    }\n\n    return arguments[0];\n}\n\nvar LocalForage = function () {\n    function LocalForage(options) {\n        _classCallCheck(this, LocalForage);\n\n        for (var driverTypeKey in DefaultDrivers) {\n            if (DefaultDrivers.hasOwnProperty(driverTypeKey)) {\n                var driver = DefaultDrivers[driverTypeKey];\n                var driverName = driver._driver;\n                this[driverTypeKey] = driverName;\n\n                if (!DefinedDrivers[driverName]) {\n                    // we don't need to wait for the promise,\n                    // since the default drivers can be defined\n                    // in a blocking manner\n                    this.defineDriver(driver);\n                }\n            }\n        }\n\n        this._defaultConfig = extend({}, DefaultConfig);\n        this._config = extend({}, this._defaultConfig, options);\n        this._driverSet = null;\n        this._initDriver = null;\n        this._ready = false;\n        this._dbInfo = null;\n\n        this._wrapLibraryMethodsWithReady();\n        this.setDriver(this._config.driver)[\"catch\"](function () {});\n    }\n\n    // Set any config values for localForage; can be called anytime before\n    // the first API call (e.g. `getItem`, `setItem`).\n    // We loop through options so we don't overwrite existing config\n    // values.\n\n\n    LocalForage.prototype.config = function config(options) {\n        // If the options argument is an object, we use it to set values.\n        // Otherwise, we return either a specified config value or all\n        // config values.\n        if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) === 'object') {\n            // If localforage is ready and fully initialized, we can't set\n            // any new configuration values. Instead, we return an error.\n            if (this._ready) {\n                return new Error(\"Can't call config() after localforage \" + 'has been used.');\n            }\n\n            for (var i in options) {\n                if (i === 'storeName') {\n                    options[i] = options[i].replace(/\\W/g, '_');\n                }\n\n                if (i === 'version' && typeof options[i] !== 'number') {\n                    return new Error('Database version must be a number.');\n                }\n\n                this._config[i] = options[i];\n            }\n\n            // after all config options are set and\n            // the driver option is used, try setting it\n            if ('driver' in options && options.driver) {\n                return this.setDriver(this._config.driver);\n            }\n\n            return true;\n        } else if (typeof options === 'string') {\n            return this._config[options];\n        } else {\n            return this._config;\n        }\n    };\n\n    // Used to define a custom driver, shared across all instances of\n    // localForage.\n\n\n    LocalForage.prototype.defineDriver = function defineDriver(driverObject, callback, errorCallback) {\n        var promise = new Promise$1(function (resolve, reject) {\n            try {\n                var driverName = driverObject._driver;\n                var complianceError = new Error('Custom driver not compliant; see ' + 'https://mozilla.github.io/localForage/#definedriver');\n\n                // A driver name should be defined and not overlap with the\n                // library-defined, default drivers.\n                if (!driverObject._driver) {\n                    reject(complianceError);\n                    return;\n                }\n\n                var driverMethods = LibraryMethods.concat('_initStorage');\n                for (var i = 0, len = driverMethods.length; i < len; i++) {\n                    var driverMethodName = driverMethods[i];\n\n                    // when the property is there,\n                    // it should be a method even when optional\n                    var isRequired = !includes(OptionalDriverMethods, driverMethodName);\n                    if ((isRequired || driverObject[driverMethodName]) && typeof driverObject[driverMethodName] !== 'function') {\n                        reject(complianceError);\n                        return;\n                    }\n                }\n\n                var configureMissingMethods = function configureMissingMethods() {\n                    var methodNotImplementedFactory = function methodNotImplementedFactory(methodName) {\n                        return function () {\n                            var error = new Error('Method ' + methodName + ' is not implemented by the current driver');\n                            var promise = Promise$1.reject(error);\n                            executeCallback(promise, arguments[arguments.length - 1]);\n                            return promise;\n                        };\n                    };\n\n                    for (var _i = 0, _len = OptionalDriverMethods.length; _i < _len; _i++) {\n                        var optionalDriverMethod = OptionalDriverMethods[_i];\n                        if (!driverObject[optionalDriverMethod]) {\n                            driverObject[optionalDriverMethod] = methodNotImplementedFactory(optionalDriverMethod);\n                        }\n                    }\n                };\n\n                configureMissingMethods();\n\n                var setDriverSupport = function setDriverSupport(support) {\n                    if (DefinedDrivers[driverName]) {\n                        console.info('Redefining LocalForage driver: ' + driverName);\n                    }\n                    DefinedDrivers[driverName] = driverObject;\n                    DriverSupport[driverName] = support;\n                    // don't use a then, so that we can define\n                    // drivers that have simple _support methods\n                    // in a blocking manner\n                    resolve();\n                };\n\n                if ('_support' in driverObject) {\n                    if (driverObject._support && typeof driverObject._support === 'function') {\n                        driverObject._support().then(setDriverSupport, reject);\n                    } else {\n                        setDriverSupport(!!driverObject._support);\n                    }\n                } else {\n                    setDriverSupport(true);\n                }\n            } catch (e) {\n                reject(e);\n            }\n        });\n\n        executeTwoCallbacks(promise, callback, errorCallback);\n        return promise;\n    };\n\n    LocalForage.prototype.driver = function driver() {\n        return this._driver || null;\n    };\n\n    LocalForage.prototype.getDriver = function getDriver(driverName, callback, errorCallback) {\n        var getDriverPromise = DefinedDrivers[driverName] ? Promise$1.resolve(DefinedDrivers[driverName]) : Promise$1.reject(new Error('Driver not found.'));\n\n        executeTwoCallbacks(getDriverPromise, callback, errorCallback);\n        return getDriverPromise;\n    };\n\n    LocalForage.prototype.getSerializer = function getSerializer(callback) {\n        var serializerPromise = Promise$1.resolve(localforageSerializer);\n        executeTwoCallbacks(serializerPromise, callback);\n        return serializerPromise;\n    };\n\n    LocalForage.prototype.ready = function ready(callback) {\n        var self = this;\n\n        var promise = self._driverSet.then(function () {\n            if (self._ready === null) {\n                self._ready = self._initDriver();\n            }\n\n            return self._ready;\n        });\n\n        executeTwoCallbacks(promise, callback, callback);\n        return promise;\n    };\n\n    LocalForage.prototype.setDriver = function setDriver(drivers, callback, errorCallback) {\n        var self = this;\n\n        if (!isArray(drivers)) {\n            drivers = [drivers];\n        }\n\n        var supportedDrivers = this._getSupportedDrivers(drivers);\n\n        function setDriverToConfig() {\n            self._config.driver = self.driver();\n        }\n\n        function extendSelfWithDriver(driver) {\n            self._extend(driver);\n            setDriverToConfig();\n\n            self._ready = self._initStorage(self._config);\n            return self._ready;\n        }\n\n        function initDriver(supportedDrivers) {\n            return function () {\n                var currentDriverIndex = 0;\n\n                function driverPromiseLoop() {\n                    while (currentDriverIndex < supportedDrivers.length) {\n                        var driverName = supportedDrivers[currentDriverIndex];\n                        currentDriverIndex++;\n\n                        self._dbInfo = null;\n                        self._ready = null;\n\n                        return self.getDriver(driverName).then(extendSelfWithDriver)[\"catch\"](driverPromiseLoop);\n                    }\n\n                    setDriverToConfig();\n                    var error = new Error('No available storage method found.');\n                    self._driverSet = Promise$1.reject(error);\n                    return self._driverSet;\n                }\n\n                return driverPromiseLoop();\n            };\n        }\n\n        // There might be a driver initialization in progress\n        // so wait for it to finish in order to avoid a possible\n        // race condition to set _dbInfo\n        var oldDriverSetDone = this._driverSet !== null ? this._driverSet[\"catch\"](function () {\n            return Promise$1.resolve();\n        }) : Promise$1.resolve();\n\n        this._driverSet = oldDriverSetDone.then(function () {\n            var driverName = supportedDrivers[0];\n            self._dbInfo = null;\n            self._ready = null;\n\n            return self.getDriver(driverName).then(function (driver) {\n                self._driver = driver._driver;\n                setDriverToConfig();\n                self._wrapLibraryMethodsWithReady();\n                self._initDriver = initDriver(supportedDrivers);\n            });\n        })[\"catch\"](function () {\n            setDriverToConfig();\n            var error = new Error('No available storage method found.');\n            self._driverSet = Promise$1.reject(error);\n            return self._driverSet;\n        });\n\n        executeTwoCallbacks(this._driverSet, callback, errorCallback);\n        return this._driverSet;\n    };\n\n    LocalForage.prototype.supports = function supports(driverName) {\n        return !!DriverSupport[driverName];\n    };\n\n    LocalForage.prototype._extend = function _extend(libraryMethodsAndProperties) {\n        extend(this, libraryMethodsAndProperties);\n    };\n\n    LocalForage.prototype._getSupportedDrivers = function _getSupportedDrivers(drivers) {\n        var supportedDrivers = [];\n        for (var i = 0, len = drivers.length; i < len; i++) {\n            var driverName = drivers[i];\n            if (this.supports(driverName)) {\n                supportedDrivers.push(driverName);\n            }\n        }\n        return supportedDrivers;\n    };\n\n    LocalForage.prototype._wrapLibraryMethodsWithReady = function _wrapLibraryMethodsWithReady() {\n        // Add a stub for each driver API method that delays the call to the\n        // corresponding driver method until localForage is ready. These stubs\n        // will be replaced by the driver methods as soon as the driver is\n        // loaded, so there is no performance impact.\n        for (var i = 0, len = LibraryMethods.length; i < len; i++) {\n            callWhenReady(this, LibraryMethods[i]);\n        }\n    };\n\n    LocalForage.prototype.createInstance = function createInstance(options) {\n        return new LocalForage(options);\n    };\n\n    return LocalForage;\n}();\n\n// The actual localForage object that we expose as a module or via a\n// global. It's extended by pulling in one of our other libraries.\n\n\nvar localforage_js = new LocalForage();\n\nmodule.exports = localforage_js;\n\n},{\"3\":3}]},{},[4])(4)\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const S = {};\nlet h = \"\";\nfunction w(t) {\n  return `${h}${t}`;\n}\nfunction lt() {\n  h = \"\", Object.keys(S).forEach((t) => delete S[t]);\n}\nfunction St(t) {\n  h = `>>${t}<<`;\n}\nasync function yt(t) {\n  return !!S[w(t)];\n}\nasync function dt(t) {\n  return JSON.parse(S[w(t)]);\n}\nasync function mt(t, e) {\n  S[w(t)] = JSON.stringify(e);\n}\nasync function pt(t) {\n  delete S[w(t)];\n}\nasync function vt() {\n  return Object.keys(S).filter((t) => t.includes(h)).map((t) => t.replace(h, \"\"));\n}\nconst ht = {\n  gameState: S,\n  reset: lt,\n  init: St,\n  exists: yt,\n  get: dt,\n  set: mt,\n  remove: pt,\n  keys: vt\n}, bt = {\n  init: () => {\n  },\n  mute: () => {\n  },\n  isMuted: () => {\n  },\n  setVolume: () => {\n  },\n  getVolume: () => {\n  },\n  playSound: () => {\n  },\n  playMusic: () => {\n  },\n  stopMusic: () => {\n  }\n}, u = {\n  settings: {},\n  game: {},\n  metadata: {},\n  scenes: [],\n  vars: {}\n};\nfunction Ot() {\n  u.settings = {}, u.game = {}, u.metadata = {}, u.scenes = [], u.vars = {};\n}\nfunction Ct() {\n  return u;\n}\nfunction Et() {\n  return JSON.parse(JSON.stringify(u));\n}\nfunction wt(t, e) {\n  u[t] = e;\n}\nfunction It(t) {\n  u[t] = !u[t];\n}\nfunction $t(t, e) {\n  u[t] = [...u[t], e];\n}\nfunction At(t, e, s) {\n  u[t] = { ...u[t], [e]: s };\n}\nfunction kt(t, e) {\n  u[t] = { ...u[t], [e]: !u[t][e] };\n}\nfunction Ut(t, e, s) {\n  u[t] = { ...u[t], [e]: [...u[t][e], s] };\n}\nconst Dt = {\n  reset: Ot,\n  store: Ct,\n  get: Et,\n  setKey: wt,\n  toggleKey: It,\n  appendKey: $t,\n  setSubkey: At,\n  toggleSubkey: kt,\n  appendSubkey: Ut\n};\nlet k = {\n  loader: null,\n  persistent: ht,\n  sound: bt,\n  state: Dt\n};\nconst i = () => k;\nfunction Pt(t) {\n  k = { ...k, ...t };\n}\nconst U = {\n  settings: {\n    volume: 0,\n    mute: !0\n  }\n};\nfunction M() {\n  return U;\n}\nfunction Mt(t, e = {}) {\n  if (!t)\n    throw new Error(\"atrament.init: provide ink Story constructor as a first argument!\");\n  if (typeof t != \"function\")\n    throw new Error(\"atrament.init: Story is not a constructor!\");\n  if (!e.applicationID)\n    throw new Error(\"atrament.init: config.applicationID is not set!\");\n  U.InkStory = t, Object.entries(e).forEach(([s, n]) => {\n    U[s] = JSON.parse(JSON.stringify(n));\n  });\n}\nfunction Vt(t) {\n  return { all: t = t || /* @__PURE__ */ new Map(), on: function(e, s) {\n    var n = t.get(e);\n    n ? n.push(s) : t.set(e, [s]);\n  }, off: function(e, s) {\n    var n = t.get(e);\n    n && (s ? n.splice(n.indexOf(s) >>> 0, 1) : t.set(e, []));\n  }, emit: function(e, s) {\n    var n = t.get(e);\n    n && n.slice().map(function(a) {\n      a(s);\n    }), (n = t.get(\"*\")) && n.slice().map(function(a) {\n      a(e, s);\n    });\n  } };\n}\nconst D = Vt(), c = (...t) => D.emit(...t);\nfunction Tt(t) {\n  return [...t].reduce((e, s) => Math.imul(31, e) + s.charCodeAt(0) | 0, 0);\n}\nfunction y(t) {\n  return Array.isArray(t) ? t : [t];\n}\nfunction V(t) {\n  if (!t)\n    return {};\n  const e = {};\n  return t.forEach((s) => {\n    let n, a;\n    const o = s.match(/\\s*(\\w+)\\s*:\\s*(.+?)\\s*$/);\n    if (o) {\n      const [, g, l] = o;\n      n = g;\n      try {\n        a = JSON.parse(l);\n      } catch {\n        const J = l.substr(0, 1);\n        J === \"{\" || J === \"[\" ? console.warn(\"Malformed JSON tag, ignored.\", g, l) : a = l;\n      }\n    } else\n      n = s, a = !0;\n    Array.isArray(e[n]) ? e[n].push(a) : e[n] ? e[n] = [e[n], a] : e[n] = a;\n  }), e;\n}\nlet r = null;\nfunction Nt(t) {\n  const { InkStory: e } = M();\n  r = new e(t), c(\"ink/initStory\");\n}\nfunction Kt() {\n  let t = !1;\n  r && (r.ResetState(), t = !0), c(\"ink/resetStory\", t);\n}\nfunction P(t, e) {\n  if (!t.canContinue)\n    return;\n  t.Continue();\n  const s = t.currentText;\n  e.text.push(s);\n  const n = V(t.currentTags);\n  e.tags = { ...e.tags, ...n }, e.content.push({ text: s, tags: n }), s === `\n` && P(t, e);\n}\nfunction xt(t) {\n  const e = {\n    content: [],\n    text: [],\n    tags: {},\n    choices: [],\n    uuid: Date.now()\n  };\n  if (t)\n    for (; r.canContinue; )\n      P(r, e);\n  else\n    P(r, e), e.canContinue = r.canContinue;\n  return r.currentChoices.forEach((s, n) => {\n    e.choices.push({\n      id: n,\n      choice: s.text,\n      tags: V(s.tags)\n    });\n  }), c(\"ink/getScene\", e), e;\n}\nconst f = {\n  initStory: Nt,\n  resetStory: Kt,\n  story: () => r,\n  loadState: (t) => r.state.LoadJson(t),\n  getState: () => r.state.toJson(),\n  makeChoice: (t) => {\n    r.ChooseChoiceIndex(t), c(\"ink/makeChoice\", t);\n  },\n  getVisitCount: (t) => {\n    const e = r.VisitCountAtPathString(t);\n    return c(\"ink/getVisitCount\", { ref: t, visitCount: e }), e;\n  },\n  evaluateFunction: (t, e, s) => {\n    const n = r.EvaluateFunction(t, e, s);\n    return c(\"ink/evaluateFunction\", { function: t, args: e, result: n }), n;\n  },\n  getGlobalTags: () => {\n    const t = V(r.globalTags);\n    return c(\"ink/getGlobalTags\", t), t;\n  },\n  getVariable: (t) => {\n    const e = r.variablesState[t];\n    return c(\"ink/getVariable\", { name: t, value: e }), e;\n  },\n  getVariables: () => {\n    const t = r.variablesState, e = {};\n    return t._globalVariables.forEach(\n      /* eslint-disable-line no-underscore-dangle */\n      (s, n) => {\n        e[n] = t[n];\n      }\n    ), c(\"ink/getVariables\", e), e;\n  },\n  setVariable: (t, e) => {\n    r.variablesState[t] = e, c(\"ink/setVariable\", { name: t, value: e });\n  },\n  observeVariable: (t, e) => r.ObserveVariable(t, e),\n  goTo: (t) => {\n    r.ChoosePathString(t), c(\"ink/goTo\", t);\n  },\n  onError: (t) => {\n    r.onError = (e) => {\n      c(\"ink/onError\", e), t(e);\n    };\n  },\n  getScene: xt\n};\nasync function H(t) {\n  const { persistent: e } = i(), s = await e.keys();\n  await Promise.all(\n    s.map(\n      async (n) => {\n        if (!n.includes(\"save\"))\n          return;\n        const a = await e.get(n);\n        await t(n, a);\n      }\n    )\n  );\n}\nfunction m(t) {\n  return typeof t == \"number\" || typeof t == \"string\" ? t : \"\";\n}\nfunction _t() {\n  const { state: t } = i();\n  return m(t.get().game.$sessionID);\n}\nfunction Lt(t) {\n  const { state: e } = i(), s = m(t);\n  e.setSubkey(\"game\", \"$sessionID\", s), c(\"game/setSession\", s);\n}\nasync function Jt() {\n  const t = {};\n  return await H(async (e, s) => {\n    const n = m(s.game.$sessionID);\n    t[n] ? t[n] += 1 : t[n] = 1;\n  }), c(\"game/getSessions\", t), t;\n}\nasync function Rt(t) {\n  const { persistent: e } = i(), s = m(t);\n  await H(async (n, a) => {\n    m(a.game.$sessionID) === s && await e.remove(n);\n  }), c(\"game/deleteSession\", s);\n}\nconst C = \"game\", I = \"autosave\", $ = \"checkpoint\";\nfunction T(t) {\n  const { $gameUUID: e, $sessionID: s } = i().state.get().game;\n  return [\n    e,\n    m(s),\n    t\n  ].join(\"/\");\n}\nfunction O({ name: t, type: e }) {\n  return [\n    T(\"save\"),\n    [C, I, $].includes(e) ? e : C,\n    typeof t == \"string\" || typeof t == \"number\" ? t : \"\"\n  ].join(\"/\");\n}\nfunction Y(t) {\n  const { state: e } = i();\n  e.setKey(\"scenes\", t.scenes), e.setKey(\"game\", t.game), f.loadState(t.state);\n}\nasync function F(t) {\n  let e = t;\n  typeof t == \"object\" && (e = O(t));\n  const { persistent: s } = i(), n = await s.get(e);\n  Y(n), c(\"game/load\", e);\n}\nfunction B() {\n  const { state: t } = i(), e = t.get();\n  return {\n    date: Date.now(),\n    state: f.getState(),\n    game: e.game,\n    scenes: e.scenes\n  };\n}\nasync function N({ name: t, type: e }) {\n  const { persistent: s } = i(), n = B(), a = {\n    name: t,\n    type: e,\n    ...n\n  }, o = O({ name: t, type: e });\n  await s.set(o, a), c(\"game/save\", o);\n}\nasync function K(t) {\n  return await i().persistent.exists(t);\n}\nasync function jt(t) {\n  await i().persistent.remove(t), c(\"game/removeSave\", t);\n}\nasync function q() {\n  const { persistent: t } = i(), s = (await t.keys()).filter((a) => a.includes(T(\"save\"))), n = await Promise.all(\n    s.map(\n      async (a) => {\n        const o = await t.get(a);\n        return o.id = a, delete o.state, delete o.scenes, o;\n      }\n    )\n  );\n  return c(\"game/listSaves\", n), n;\n}\nfunction R(t) {\n  const { sound: e, loader: s } = i();\n  y(t).forEach(\n    (n) => e.playSound(s.getAssetPath(n))\n  );\n}\nfunction A(t) {\n  const { sound: e, loader: s } = i();\n  y(t).forEach(\n    (n) => e.stopSound(n ? s.getAssetPath(n) : null)\n  );\n}\nfunction z(t) {\n  const { sound: e, state: s, loader: n } = i(), a = s.get().game.$currentMusic || [];\n  y(t).forEach((o) => {\n    e.playMusic(n.getAssetPath(o)), a.push(o);\n  }), s.setSubkey(\"game\", \"$currentMusic\", a);\n}\nfunction Gt(t) {\n  const { sound: e, state: s, loader: n } = i();\n  e.stopMusic();\n  const a = y(t).pop();\n  e.playMusic(n.getAssetPath(a)), s.setSubkey(\"game\", \"$currentMusic\", [a]);\n}\nfunction v(t) {\n  const { sound: e, state: s, loader: n } = i();\n  let a = s.get().game.$currentMusic || [];\n  y(t).forEach((o) => {\n    o ? (e.stopMusic(n.getAssetPath(o)), a = a.filter((g) => g !== o)) : (e.stopMusic(), a = []);\n  }), s.setSubkey(\"game\", \"$currentMusic\", a);\n}\nlet x = null, Q = null;\nfunction W() {\n  const { state: t } = i();\n  t.setKey(\"scenes\", []), t.setKey(\"vars\", {});\n}\nfunction X(t) {\n  const { state: e } = i(), s = e.get().metadata.observe;\n  s && y(s).forEach(t);\n}\nconst d = {};\nasync function Ht() {\n  const { state: t, persistent: e } = i(), { game: s, metadata: n } = t.get(), a = n.persist;\n  if (a) {\n    const o = T(\"persist\");\n    await e.exists(o) ? (d[s.$gameUUID] = await e.get(o), Object.entries(d[s.$gameUUID]).forEach(\n      ([g, l]) => f.setVariable(g, l)\n    )) : d[s.$gameUUID] || (d[s.$gameUUID] = {}), y(a).forEach((g) => {\n      f.observeVariable(g, async (l, L) => {\n        d[s.$gameUUID][l] = L, await e.set(o, d[s.$gameUUID]);\n      });\n    });\n  }\n}\nasync function Yt(t, e, s) {\n  await i().loader.init(t);\n  const n = {\n    $path: t,\n    $file: e,\n    $gameUUID: s || Tt(`${t}|${e}`)\n  };\n  i().state.setKey(\"game\", n), x = n.$gameUUID, c(\"game/init\", { pathToInkFile: t, inkFile: e });\n}\nasync function Z() {\n  const { game: t } = i().state.get();\n  let e = await i().loader.loadInk(t.$file);\n  return typeof e == \"string\" && (e = JSON.parse(e.replace(\"\\uFEFF\", \"\"))), c(\"game/loadInkFile\", t.$file), e;\n}\nasync function tt() {\n  const { state: t } = i(), e = await Z();\n  f.initStory(e);\n  const s = f.getGlobalTags();\n  t.setKey(\"metadata\", s), X((n) => {\n    f.observeVariable(n, (a, o) => {\n      t.setSubkey(\"vars\", a, o), c(\"ink/variableObserver\", { name: a, value: o });\n    });\n  }), Q = x, c(\"game/initInkStory\");\n}\nasync function _(t) {\n  const { state: e } = i();\n  if (v(), W(), Q !== x && await tt(), t && await K(t)) {\n    await F(t);\n    const { game: s } = e.get();\n    s.$currentMusic && z(s.$currentMusic);\n  }\n  await Ht(), X((s) => {\n    e.setSubkey(\"vars\", s, f.getVariable(s));\n  }), c(\"game/start\", { saveSlot: t });\n}\nfunction et() {\n  v(), W(), f.resetStory(), c(\"game/clear\");\n}\nfunction Ft() {\n  const { state: t } = i();\n  et(), t.setKey(\"metadata\", {}), t.setKey(\"game\", {}), c(\"game/reset\");\n}\nfunction p(t, e, s) {\n  t[s] || (t[s] = []), t.content = t.content.map((n) => {\n    n[s] || (n[s] = []);\n    const a = n.tags?.[e];\n    if (a) {\n      const o = y(a);\n      t[s] = [...t[s], ...o], n[s] = [...n[s], ...o];\n    }\n    return n;\n  });\n}\nfunction Bt(t) {\n  t.choices = t.choices.map((e) => ((e.tags.UNCLICKABLE || e.tags.DISABLED || e.tags.INACTIVE) && (e.disabled = !0), e));\n}\nconst qt = [\n  (t) => p(t, \"IMAGE\", \"images\"),\n  (t) => p(t, \"AUDIO\", \"sounds\"),\n  (t) => p(t, \"PLAY_SOUND\", \"sounds\"),\n  (t) => p(t, \"AUDIOLOOP\", \"music\"),\n  (t) => p(t, \"PLAY_MUSIC\", \"music\"),\n  Bt\n], st = [];\nasync function nt() {\n  let t = null;\n  const e = O({ type: I });\n  if (await K(e))\n    t = e;\n  else {\n    const n = (await q()).filter((a) => a.type === $);\n    n.length && (t = n.sort((a, o) => o.date - a.date)[0].id);\n  }\n  return c(\"game/canResume\", t), t;\n}\nasync function zt() {\n  const t = await nt();\n  c(\"game/resume\", { saveSlot: t }), f.resetStory(), await _(t);\n}\nasync function E(t) {\n  c(\"game/restart\", { saveSlot: t }), f.resetStory(), await _(t);\n}\nasync function Qt(t) {\n  await E(t), ct();\n}\nasync function at(t) {\n  await N({ type: C, name: t });\n}\nasync function it(t) {\n  await N({ type: $, name: t });\n}\nasync function ot() {\n  await N({ type: I });\n}\nconst j = {\n  CLEAR: () => i().state.setKey(\"scenes\", []),\n  AUDIO: (t) => t ? R(t) : A(),\n  AUDIOLOOP: (t) => t ? Gt(t) : v(),\n  PLAY_SOUND: R,\n  STOP_SOUND: (t) => t === !0 ? A() : A(t),\n  PLAY_MUSIC: z,\n  STOP_MUSIC: (t) => t === !0 ? v() : v(t),\n  CHECKPOINT: (t) => it(t),\n  SAVEGAME: (t) => at(t)\n};\nfunction G(t, e) {\n  t.forEach((s) => {\n    s in e && s in j && (j[s](e[s]), c(\"game/handletag\", { [s]: e[s] }));\n  });\n}\nfunction Wt(t) {\n  st.push(t);\n}\nfunction ct() {\n  const { state: t } = i(), { metadata: e } = t.get(), s = e.continue_maximally !== !1, n = f.getScene(s);\n  if (n.content.length === 0)\n    return;\n  qt.forEach((o) => o(n)), st.forEach((o) => o(n));\n  const { tags: a } = n;\n  if (a.RESTART) {\n    E();\n    return;\n  }\n  if (a.RESTART_FROM_CHECKPOINT) {\n    E(O({ type: \"checkpoint\", name: a.RESTART_FROM_CHECKPOINT }));\n    return;\n  }\n  G(\n    [\"CLEAR\", \"STOP_SOUND\", \"STOP_MUSIC\", \"PLAY_SOUND\", \"PLAY_MUSIC\", \"AUDIO\", \"AUDIOLOOP\"],\n    a\n  ), e.single_scene ? t.setKey(\"scenes\", [n]) : t.appendKey(\"scenes\", n), G(\n    [\"CHECKPOINT\", \"SAVEGAME\"],\n    a\n  ), e.autosave !== !1 && ot(), c(\"game/continueStory\");\n}\nconst Xt = {\n  // game-control\n  init: Yt,\n  loadInkFile: Z,\n  initInkStory: tt,\n  start: _,\n  clear: et,\n  reset: Ft,\n  // game\n  resume: zt,\n  canResume: nt,\n  restart: E,\n  restartAndContinue: Qt,\n  continueStory: ct,\n  makeChoice: (t) => f.makeChoice(t),\n  getAssetPath: (t) => i().loader.getAssetPath(t),\n  defineSceneProcessor: Wt,\n  // saves\n  SAVE_GAME: C,\n  SAVE_AUTOSAVE: I,\n  SAVE_CHECKPOINT: $,\n  getSaveSlotKey: O,\n  saveGame: at,\n  saveCheckpoint: it,\n  saveAutosave: ot,\n  load: F,\n  getState: B,\n  setState: Y,\n  listSaves: q,\n  removeSave: jt,\n  existSave: K,\n  // sessions\n  getSession: _t,\n  setSession: Lt,\n  getSessions: Jt,\n  removeSession: Rt\n}, b = {\n  mute: (t, e) => i().sound.mute(e),\n  volume: (t, e) => i().sound.setVolume(e)\n};\nasync function Zt() {\n  const { state: t, persistent: e } = i(), s = JSON.parse(JSON.stringify(M().settings));\n  let n = {};\n  await e.exists(\"settings\") && (n = await e.get(\"settings\"));\n  const o = { ...s, ...n };\n  t.setKey(\"settings\", o), ft(), c(\"settings/load\", o);\n}\nasync function te() {\n  const { state: t, persistent: e } = i(), s = t.get();\n  await e.set(\"settings\", s.settings), c(\"settings/save\", s.settings);\n}\nfunction rt(t) {\n  const e = i().state.get().settings[t];\n  return c(\"settings/get\", { name: t, value: e }), e;\n}\nfunction ut(t, e) {\n  const { state: s } = i(), n = s.get().settings[t];\n  s.setSubkey(\"settings\", t, e), b[t] && b[t](n, e), c(\"settings/set\", { name: t, value: e });\n}\nfunction ee(t) {\n  const e = rt(t);\n  ut(t, !e);\n}\nfunction se(t, e) {\n  b[t] = e;\n}\nfunction ft() {\n  const t = i().state.get().settings;\n  Object.entries(t).forEach(([e, s]) => {\n    b[e] && b[e](null, s);\n  });\n}\nconst gt = {\n  load: Zt,\n  save: te,\n  get: rt,\n  set: ut,\n  toggle: ee,\n  defineHandler: se,\n  runHandlers: ft\n}, ne = \"2.1.3\";\nasync function ae(t, e) {\n  c(\"atrament/init\");\n  const { persistent: s } = i();\n  Mt(t, e), s.init(M().applicationID), await gt.load();\n}\nconst ie = {\n  get interfaces() {\n    return i();\n  },\n  defineInterfaces: Pt,\n  init: ae,\n  get state() {\n    return i().state;\n  },\n  get store() {\n    return i().state.store();\n  },\n  on: (t, e) => D.on(t, e),\n  off: (t, e) => D.off(t, e),\n  // sub-objects\n  game: Xt,\n  ink: f,\n  settings: gt,\n  version: ne\n};\nexport {\n  ie as default\n};\n","// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = new Worker(ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([\n        c + ';addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'\n    ], { type: 'text/javascript' }))));\n    w.onmessage = function (e) {\n        var d = e.data, ed = d.$e$;\n        if (ed) {\n            var err = new Error(ed[0]);\n            err['code'] = ed[1];\n            err.stack = ed[2];\n            cb(err, null);\n        }\n        else\n            cb(null, d);\n    };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, i32 = Int32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new i32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return { b: b, r: r };\n};\nvar _a = freb(fleb, 2), fl = _a.b, revfl = _a.r;\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b.b, revfd = _b.r;\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >> 8) | ((x & 0x00FF) << 8)) >> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i) {\n        if (cd[i])\n            ++l[cd[i] - 1];\n    }\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 1; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    return new u8(v.subarray(s, e));\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, st, buf, dict) {\n    // source length       dict length\n    var sl = dat.length, dl = dict ? dict.length : 0;\n    if (!sl || st.f && !st.l)\n        return buf || new u8(0);\n    var noBuf = !buf;\n    // have to estimate size\n    var resize = noBuf || st.i != 2;\n    // no state\n    var noSt = st.i;\n    // Assumes roughly 33% compression ratio average\n    if (noBuf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (resize)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17\n        if (resize)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (resize)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                if (bt < dt) {\n                    var shift = dl - dt, dend = Math.min(dt, end);\n                    if (shift + bt < 0)\n                        err(3);\n                    for (; bt < dend; ++bt)\n                        buf[bt] = dict[shift + bt];\n                }\n                for (; bt < end; ++bt)\n                    buf[bt] = buf[bt - dt];\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    // don't reallocate for streams or user buffers\n    return bt != buf.length && noBuf ? slc(buf, 0, bt) : buf.subarray(0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n    d[o + 2] |= v >> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return { t: et, l: 0 };\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return { t: v, l: 1 };\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return { t: new u8(tr), l: mbt };\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return { c: cl.subarray(0, cli), n: s };\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a.t, mlb = _a.l;\n    var _b = hTree(df, 15), ddt = _b.t, mdb = _b.l;\n    var _c = lc(dlt), lclt = _c.c, nlc = _c.n;\n    var _d = lc(ddt), lcdt = _d.c, ndc = _d.n;\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        ++lcfreq[lclt[i] & 31];\n    for (var i = 0; i < lcdt.length; ++i)\n        ++lcfreq[lcdt[i] & 31];\n    var _e = hTree(lcfreq, 7), lct = _e.t, mlcb = _e.l;\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + 2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18];\n    if (bs >= 0 && flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >> 5) & 127), p += clct[i] >> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        var sym = syms[i];\n        if (sym > 255) {\n            var len = (sym >> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (sym >> 23) & 31), p += fleb[len];\n            var dst = sym & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (sym >> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[sym]), p += ll[sym];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new i32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, st) {\n    var s = st.z || dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var lst = st.l;\n    var pos = (st.r || 0) & 7;\n    if (lvl) {\n        if (pos)\n            w[0] = st.r >> 3;\n        var opt = deo[lvl - 1];\n        var n = opt >> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = st.p || new u16(32768), head = st.h || new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new i32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index          l/lind  waitdx          blkpos\n        var lc_1 = 0, eb = 0, i = st.i || 0, li = 0, wi = st.w || 0, bs = 0;\n        for (; i + 2 < s; ++i) {\n            // hash value\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && (rem > 423 || !lst)) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = imod - pimod & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = i - dif + j & 32767;\n                                    var pti = prev[ti];\n                                    var cd = ti - pti & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += imod - pimod & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one int32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        for (i = Math.max(i, wi); i < s; ++i) {\n            syms[li++] = dat[i];\n            ++lf[dat[i]];\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        if (!lst) {\n            st.r = (pos & 7) | w[(pos / 8) | 0] << 3;\n            // shft(pos) now 1 less if pos & 7 != 0\n            pos -= 7;\n            st.h = head, st.p = prev, st.i = i, st.w = wi;\n        }\n    }\n    else {\n        for (var i = st.w || 0; i < s + lst; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e >= s) {\n                // write final block\n                w[(pos / 8) | 0] = lst;\n                e = s;\n            }\n            pos = wfblk(w, pos + 1, dat.subarray(i, e));\n        }\n        st.i = s;\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Adler32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a & 0xFF00) << 8 | (b & 255) << 8 | (b >> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    if (!st) {\n        st = { l: 1 };\n        if (opt.dictionary) {\n            var dict = opt.dictionary.subarray(-32768);\n            var newDat = new u8(dict.length + dat.length);\n            newDat.set(dict);\n            newDat.set(dat, dict.length);\n            dat = newDat;\n            st.w = dict.length;\n        }\n    }\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? (st.l ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : 20) : (12 + opt.mem), pre, post, st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/\\s+/g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return fnStr;\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k].buffer) {\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n        }\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            fnStr = wcln(fns[i], fnStr, td_1);\n        ch[id] = { c: wcln(fns[m], fnStr, td_1), e: td_1 };\n    }\n    var td = mrg({}, ch[id].e);\n    return wk(ch[id].c + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, i32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gopt]; };\nvar bDflt = function () { return [u8, u16, i32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zls]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get opts\nvar gopt = function (o) { return o && {\n    out: o.size && new u8(o.size),\n    dictionary: o.dictionary\n}; };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) {\n        if (ev.data.length) {\n            strm.push(ev.data[0], ev.data[1]);\n            postMessage([ev.data[0].length]);\n        }\n        else\n            strm.flush();\n    };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id, flush, ext) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else if (!Array.isArray(dat))\n            ext(dat);\n        else if (dat.length == 1) {\n            strm.queuedSize -= dat[0];\n            if (strm.ondrain)\n                strm.ondrain(dat[0]);\n        }\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.queuedSize = 0;\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        strm.queuedSize += d.length;\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n    if (flush) {\n        strm.flush = function () { w.postMessage([]); };\n    }\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += (d[10] | d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16 | d[l - 1] << 24) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + (o.filename ? o.filename.length + 1 : 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (o.dictionary && 32);\n    c[1] |= 31 - ((c[0] << 8) | c[1]) % 31;\n    if (o.dictionary) {\n        var h = adler();\n        h.p(o.dictionary);\n        wbytes(c, 2, h.d());\n    }\n};\n// zlib start\nvar zls = function (d, dict) {\n    if ((d[0] & 15) != 8 || (d[0] >> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if ((d[1] >> 5 & 1) == +!dict)\n        err(6, 'invalid zlib data: ' + (d[1] & 32 ? 'need' : 'unexpected') + ' dictionary');\n    return (d[1] >> 3 & 4) + 2;\n};\nfunction StrmOpt(opts, cb) {\n    if (typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n        this.s = { l: 0, i: 32768, w: 32768, z: 32768 };\n        // Buffer length must always be 0 mod 32768 for index calculations to be correct when modifying head and prev\n        // 98304 = 32768 (lookback) + 65536 (common chunk size)\n        this.b = new u8(98304);\n        if (this.o.dictionary) {\n            var dict = this.o.dictionary.subarray(-32768);\n            this.b.set(dict, 32768 - dict.length);\n            this.s.i = 32768 - dict.length;\n        }\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, this.s), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.s.l)\n            err(4);\n        var endLen = chunk.length + this.s.z;\n        if (endLen > this.b.length) {\n            if (endLen > 2 * this.b.length - 32768) {\n                var newBuf = new u8(endLen & -32768);\n                newBuf.set(this.b.subarray(0, this.s.z));\n                this.b = newBuf;\n            }\n            var split = this.b.length - this.s.z;\n            this.b.set(chunk.subarray(0, split), this.s.z);\n            this.s.z = this.b.length;\n            this.p(this.b, false);\n            this.b.set(this.b.subarray(-32768));\n            this.b.set(chunk.subarray(split), 32768);\n            this.s.z = chunk.length - split + 32768;\n            this.s.i = 32766, this.s.w = 32768;\n        }\n        else {\n            this.b.set(chunk, this.s.z);\n            this.s.z += chunk.length;\n        }\n        this.s.l = final & 1;\n        if (this.s.z > this.s.w + 8191 || final) {\n            this.p(this.b, final || false);\n            this.s.w = this.s.i, this.s.i -= 2;\n        }\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * deflated output for small inputs.\n     */\n    Deflate.prototype.flush = function () {\n        if (!this.ondata)\n            err(5);\n        if (this.s.l)\n            err(4);\n        this.p(this.b, false);\n        this.s.w = this.s.i, this.s.i -= 2;\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6, 1);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    function Inflate(opts, cb) {\n        // no StrmOpt here to avoid adding to workerizer\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        var dict = opts && opts.dictionary && opts.dictionary.subarray(-32768);\n        this.s = { i: 0, b: dict ? dict.length : 0 };\n        this.o = new u8(32768);\n        this.p = new u8(0);\n        if (dict)\n            this.o.set(dict);\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        if (!this.p.length)\n            this.p = c;\n        else if (c.length) {\n            var n = new u8(this.p.length + c.length);\n            n.set(this.p), n.set(c, this.p.length), this.p = n;\n        }\n    };\n    Inflate.prototype.c = function (final) {\n        this.s.i = +(this.d = final || false);\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.s, this.o);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    function AsyncInflate(opts, cb) {\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Inflate(ev.data);\n            onmessage = astrm(strm);\n        }, 7, 0);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gopt(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, opts) {\n    return inflt(data, { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        this.l += chunk.length;\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, this.s);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * GZIPped output for small inputs.\n     */\n    Gzip.prototype.flush = function () {\n        Deflate.prototype.flush.call(this);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8, 1);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming single or multi-member GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    function Gunzip(opts, cb) {\n        this.v = 1;\n        this.r = 0;\n        Inflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        this.r += chunk.length;\n        if (this.v) {\n            var p = this.p.subarray(this.v - 1);\n            var s = p.length > 3 ? gzs(p) : 4;\n            if (s > p.length) {\n                if (!final)\n                    return;\n            }\n            else if (this.v > 1 && this.onmember) {\n                this.onmember(this.r - p.length);\n            }\n            this.p = p.subarray(s), this.v = 0;\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n        // process concatenated GZIP\n        if (this.s.f && !this.s.l && !final) {\n            this.v = shft(this.s.p) + 9;\n            this.s = { i: 0 };\n            this.o = new u8(0);\n            this.push(new u8(0), final);\n        }\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming single or multi-member GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    function AsyncGunzip(opts, cb) {\n        var _this = this;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gunzip(ev.data);\n            strm.onmember = function (offset) { return postMessage(offset); };\n            onmessage = astrm(strm);\n        }, 9, 0, function (offset) { return _this.onmember && _this.onmember(offset); });\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0], ev.data[1])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, opts) {\n    var st = gzs(data);\n    if (st + 8 > data.length)\n        err(6, 'invalid gzip data');\n    return inflt(data.subarray(st, -8), { i: 2 }, opts && opts.out || new u8(gzl(data)), opts && opts.dictionary);\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && (this.o.dictionary ? 6 : 2), f && 4, this.s);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * zlibbed output for small inputs.\n     */\n    Zlib.prototype.flush = function () {\n        Deflate.prototype.flush.call(this);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10, 1);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, opts.dictionary ? 6 : 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    function Unzlib(opts, cb) {\n        Inflate.call(this, opts, cb);\n        this.v = opts && opts.dictionary ? 2 : 1;\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 6 && !final)\n                return;\n            this.p = this.p.subarray(zls(this.p, this.v - 1)), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    function AsyncUnzlib(opts, cb) {\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Unzlib(ev.data);\n            onmessage = astrm(strm);\n        }, 11, 0);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gopt(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, opts) {\n    return inflt(data.subarray(zls(data, opts && opts.dictionary), -4), { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    function Decompress(opts, cb) {\n        this.o = StrmOpt.call(this, opts, cb) || {};\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n    }\n    // init substream\n    // overriden by AsyncDecompress\n    Decompress.prototype.i = function () {\n        var _this = this;\n        this.s.ondata = function (dat, final) {\n            _this.ondata(dat, final);\n        };\n    };\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(this.o)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(this.o)\n                        : new this.Z(this.o);\n                this.i();\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    function AsyncDecompress(opts, cb) {\n        Decompress.call(this, opts, cb);\n        this.queuedSize = 0;\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n    }\n    AsyncDecompress.prototype.i = function () {\n        var _this = this;\n        this.s.ondata = function (err, dat, final) {\n            _this.ondata(err, dat, final);\n        };\n        this.s.ondrain = function (size) {\n            _this.queuedSize -= size;\n            if (_this.ondrain)\n                _this.ondrain(size);\n        };\n    };\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        this.queuedSize += chunk.length;\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, opts) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, opts)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, opts)\n            : unzlibSync(data, opts);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k, op = o;\n        if (Array.isArray(val))\n            op = mrg(o, val[1]), val = val[0];\n        if (val instanceof u8)\n            t[n] = [val, op];\n        else {\n            t[n += '/'] = [new u8(0), op];\n            fltn(val, n, t, o);\n        }\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return { s: r, r: slc(d, i - 1) };\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (final) {\n            if (r.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = r;\n        this.ondata(s, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td) {\n        return td.decode(dat);\n    }\n    else {\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (r.length)\n            err(8);\n        return s;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c < 0 && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >> 1)), b += 4;\n    if (c != -1) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c < 0 ? -c - 2 : c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u, -1);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this.ondata(err, dat, final);\n                    _this.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this.d & 1))\n                        return;\n                    _this.u.splice(-1, 1);\n                    _this.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, -f.c - 2, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this = this;\n        this.i = new Inflate(function (dat, final) {\n            _this.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this.k[0] == chks_3 && _this.c)\n                                        _this.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295 || c == 65535;\n        if (z) {\n            var ze = b4(data, e - 12);\n            z = b4(data, ze) == 0x6064B50;\n            if (z) {\n                c = lft = b4(data, ze + 32);\n                o = b4(data, ze + 48);\n            }\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    // Synchronously decompress under 512KB, or barely-compressed data\n                    if (su < 524288 || sc > 0.8 * su) {\n                        try {\n                            cbl(null, inflateSync(infl, { out: new u8(su) }));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295 || c == 65535;\n    if (z) {\n        var ze = b4(data, e - 12);\n        z = b4(data, ze) == 0x6064B50;\n        if (z) {\n            c = b4(data, ze + 32);\n            o = b4(data, ze + 48);\n        }\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), { out: new u8(su) });\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n","/* global window, document */\n\nexport async function loadFromJSON(filename) {\n  const response = await fetch(filename);\n  return response;\n}\n\nexport async function appendScript(src) {\n  return new Promise((resolve, reject) => {\n    const el = document.createElement('script');\n    el.src = src;\n    el.addEventListener('load', resolve);\n    el.addEventListener('error', reject);\n    document.body.append(el);\n  });\n}\n\nexport async function loadFromJS(filename) {\n  const response = {};\n  try {\n    await appendScript(filename);\n    response.ok = true;\n    response.text = () => JSON.stringify(window.storyContent);\n  } catch (e) {\n    console.error(e);\n  }\n  return response;\n}\n","/* eslint-disable no-await-in-loop */\n\nimport { unzip } from 'fflate';\n\nimport { loadFromJS, loadFromJSON } from './loader-common';\n\nlet $gameFileType = 'plain';\nlet $gamePath = '';\nlet $zipContent = {};\n\nlet $onProgress = () => {};\n\nasync function fetchWithProgress(path) {\n  const response = await fetch(path, { responseType: 'arraybuffer' });\n  const reader = response.body.getReader();\n  const contentLength = +response.headers.get('Content-Length');\n  const chunks = [];\n  let receivedLength = 0;\n  for (;;) {\n    const { done, value } = await reader.read();\n    if (done) {\n      break;\n    }\n    chunks.push(value);\n    receivedLength += value.length;\n    const percent = Math.round((receivedLength * 100) / contentLength);\n    $onProgress({ percent, receivedLength, contentLength });\n  }\n  const chunksAll = new Uint8Array(receivedLength);\n  let position = 0;\n  chunks.forEach((chunk) => {\n    chunksAll.set(chunk, position);\n    position += chunk.length;\n  });\n  return chunksAll;\n}\n\nasync function init(path) {\n  if (path.endsWith('.zip')) {\n    $gameFileType = 'zip';\n  }\n  if ($gameFileType === 'zip') {\n    $zipContent = {}; // clear zip content\n    const zipContent = await fetchWithProgress(path);\n    await unzip(\n      zipContent,\n      (err, unzipped) => Object.entries(unzipped).forEach(([filepath, content]) => {\n        $zipContent[filepath] = URL.createObjectURL(new Blob([content]));\n      }));\n  } else {\n    $gamePath = path;\n  }\n}\n\nfunction getAssetPath(filename) {\n  if ($gameFileType === 'zip') {\n    return $zipContent[filename];\n  }\n  return `${$gamePath}/${filename}`;\n}\n\n\nasync function loadInk(filename) {\n  const fullpath = getAssetPath(filename);\n  const response = await (fullpath.endsWith('js') ? loadFromJS(fullpath) : loadFromJSON(fullpath));\n  if (response.ok) {\n    return response.text();\n  }\n  throw new Error(`Failed to load ink file: ${filename}`);\n}\n\nfunction onProgress(cb) {\n  $onProgress = cb;\n}\n\nexport default {\n  init,\n  getAssetPath,\n  loadInk,\n  onProgress\n};\n","import localforage from 'localforage';\n\nlet storage;\n\nfunction init(prefix) {\n  storage = localforage.createInstance(`${prefix}-atrament`);\n  storage.config({\n    name: prefix\n  });\n  storage.setDriver([localforage.INDEXEDDB, localforage.LOCALSTORAGE]);\n}\n\nasync function exists(item) {\n  const value = await storage.getItem(item);\n  return value !== null;\n}\n\nasync function get(item) {\n  const value = await storage.getItem(item);\n  return value;\n}\n\nasync function set(item, value) {\n  await storage.setItem(item, value);\n}\n\nasync function remove(item) {\n  await storage.removeItem(item);\n}\n\nasync function keys() {\n  const storageKeys = await storage.keys();\n  return storageKeys;\n}\n\nexport default {\n  init,\n  exists,\n  get,\n  set,\n  remove,\n  keys\n};\n","\n/* global window */\nimport murmur from 'murmurhash-js';\n\nconst KEY_STORAGE = '__atrament_storage';\n\n// storage keys update queue\nlet storageLock = Promise.resolve();\n\n// neutralino functions\n\nasync function neuGetData(key) {\n  try {\n    const data = await window.Neutralino.storage.getData(key);\n    return JSON.parse(data);\n  } catch (e) {\n    console.warn(e.message);\n    return null;\n  }\n}\n\nasync function neuSetData(key, value) {\n  const v = JSON.stringify(value);\n  await window.Neutralino.storage.setData(key, v);\n  return v;\n}\n\nasync function neuDeleteData(key) {\n  await window.Neutralino.storage.setData(key, null);\n  return true;\n}\n\n// key handling\n\nfunction normalizeKey(key) {\n  return `storage_${murmur(key)}`;\n}\n\nasync function neuSetKey(key, item) {\n  storageLock = storageLock.then(async () => {\n    let storageKeys = await neuGetData(KEY_STORAGE);\n    if (storageKeys === null) {\n      storageKeys = {};\n    }\n    storageKeys[item] = key;\n    await neuSetData(KEY_STORAGE, storageKeys);\n  }).catch((e) => console.error(e.message));\n  return storageLock;\n}\n\nasync function neuDeleteKey(item) {\n  storageLock = storageLock.then(async () => {\n    let storageKeys = await neuGetData(KEY_STORAGE);\n    if (storageKeys === null) {\n      storageKeys = {};\n    }\n    delete storageKeys[item];\n    await neuSetData(KEY_STORAGE, storageKeys);\n  }).catch((e) => console.error(e.message));\n  return storageLock;\n}\n\n// interface functions\n\nfunction init() {\n}\n\nasync function exists(item) {\n  const persistentKeys = await keys();\n  return persistentKeys.includes(item);\n}\n\nasync function get(item) {\n  const storageKeys = await neuGetData(KEY_STORAGE);\n  const key = storageKeys === null ? normalizeKey(item) : storageKeys[item];\n  const value = await neuGetData(key);\n  return value;\n}\n\nasync function set(item, value) {\n  const key = normalizeKey(item);\n  try {\n    await neuSetData(key, value);\n    await neuSetKey(key, item);\n  } catch (e) {\n    console.error(e.message);\n  }\n}\n\nasync function remove(item) {\n  const key = normalizeKey(item);\n  try {\n    await neuDeleteData(key);\n    await neuDeleteKey(item);\n  } catch (e) {\n    console.error(e.message);\n  }\n}\n\nasync function keys() {\n  const storageKeys = await neuGetData(KEY_STORAGE);\n  return storageKeys === null ? [] : Object.keys(storageKeys);\n}\n\nexport default {\n  init,\n  exists,\n  get,\n  set,\n  remove,\n  keys\n};\n","import { Howl, Howler } from 'howler';\n\nconst soundCache = {};\nconst musicCache = {};\n\n// stop playback of given sound file or all cached sound files\nfunction $stopPlayback(file, cache) {\n  if (file) {\n    if (cache[file]) {\n      cache[file].stop();\n    }\n  } else {\n    Object.keys(cache).forEach((s) => {\n      if (s && s.fade) {\n        s.fade(undefined, 0, 1);\n      }\n      cache[s].stop();\n    });\n  }\n}\n\n/*\n  init({\n    mute: true/false,\n    volume: 0-100\n  }) - initialize sound with given configuration\n*/\nfunction init(cfg) {\n  mute(cfg.mute);\n  setVolume(cfg.volume);\n}\n\n/*\n  mute(true/false) - turn sound on/off\n*/\nfunction mute(state = true) {\n  Howler.mute(state);\n}\n\n/*\n  isMuted(true/false) - returns true if sound is muted, false otherwise\n*/\nfunction isMuted() {\n  return Howler.muted;\n}\n\n/*\n  setVolume(volume) - should set sound volume (0-100)\n*/\nfunction setVolume(volume) {\n  Howler.volume(volume / 100);\n}\n\n/*\n  getVolume() - returns current volume\n*/\nfunction getVolume() {\n  return Howler.volume * 100;\n}\n\n/*\n  playSound(snd)\n  Plays sound once.\n  - snd: path to a sound file.\n*/\nfunction playSound(snd) {\n  if (!soundCache[snd]) {\n    soundCache[snd] = new Howl({\n      src: [snd]\n    });\n  }\n  soundCache[snd].play();\n}\n\n/*\n  stopSound(snd)\n   sound once.\n  - snd: path to a sound file.\n  If no parameter is supplied, all sounds should be stopped\n*/\nfunction stopSound(snd) {\n  $stopPlayback(snd, soundCache);\n}\n\n/*\n  playMusic(mus, loop)\n  - mus: path to a music file\n  - loop: is track looped? true by default\n*/\nfunction playMusic(mus, loop = true) {\n  if (!musicCache[mus]) {\n    musicCache[mus] = new Howl({\n      src: [mus],\n      html5: true, // streaming\n      loop\n    });\n  }\n  musicCache[mus].play();\n}\n\n/*\n  stopMusic(mus)\n  - mus: path to a music file\n  If no parameter is supplied, all music should be stopped\n*/\nfunction stopMusic(mus) {\n  $stopPlayback(mus, musicCache);\n}\n\nexport default {\n  init,\n  mute,\n  isMuted,\n  setVolume,\n  getVolume,\n  playSound,\n  stopSound,\n  playMusic,\n  stopMusic\n};\n","import { clean } from '../clean-stores/index.js'\n\nlet listenerQueue = []\nlet lqIndex = 0\nconst QUEUE_ITEMS_PER_LISTENER = 4\nexport let epoch = 0\n\nexport let atom = initialValue => {\n  let listeners = []\n  let $atom = {\n    get() {\n      if (!$atom.lc) {\n        $atom.listen(() => {})()\n      }\n      return $atom.value\n    },\n    lc: 0,\n    listen(listener) {\n      $atom.lc = listeners.push(listener)\n\n      return () => {\n        for (\n          let i = lqIndex + QUEUE_ITEMS_PER_LISTENER;\n          i < listenerQueue.length;\n\n        ) {\n          if (listenerQueue[i] === listener) {\n            listenerQueue.splice(i, QUEUE_ITEMS_PER_LISTENER)\n          } else {\n            i += QUEUE_ITEMS_PER_LISTENER\n          }\n        }\n\n        let index = listeners.indexOf(listener)\n        if (~index) {\n          listeners.splice(index, 1)\n          if (!--$atom.lc) $atom.off()\n        }\n      }\n    },\n    notify(oldValue, changedKey) {\n      epoch++\n      let runListenerQueue = !listenerQueue.length\n      for (let listener of listeners) {\n        listenerQueue.push(listener, $atom.value, oldValue, changedKey)\n      }\n\n      if (runListenerQueue) {\n        for (\n          lqIndex = 0;\n          lqIndex < listenerQueue.length;\n          lqIndex += QUEUE_ITEMS_PER_LISTENER\n        ) {\n          listenerQueue[lqIndex](\n            listenerQueue[lqIndex + 1],\n            listenerQueue[lqIndex + 2],\n            listenerQueue[lqIndex + 3]\n          )\n        }\n        listenerQueue.length = 0\n      }\n    },\n    /* It will be called on last listener unsubscribing.\n       We will redefine it in onMount and onStop. */\n    off() {},\n    set(newValue) {\n      let oldValue = $atom.value\n      if (oldValue !== newValue) {\n        $atom.value = newValue\n        $atom.notify(oldValue)\n      }\n    },\n    subscribe(listener) {\n      let unbind = $atom.listen(listener)\n      listener($atom.value)\n      return unbind\n    },\n    value: initialValue\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    $atom[clean] = () => {\n      listeners = []\n      $atom.lc = 0\n      $atom.off()\n    }\n  }\n\n  return $atom\n}\n\nexport const readonlyType = store => store\n","import { map } from 'nanostores';\n\nconst $state = map({\n  settings: {},\n  game: {},\n  metadata: {},\n  scenes: [],\n  vars: {}\n});\n\nfunction store() {\n  return $state;\n}\n\nfunction get() {\n  return $state.get();\n}\n\nconst setKey = (key, value) => {\n  $state.setKey(key, value);\n  return $state.get();\n};\n\nconst toggleKey = (key) => {\n  $state.setKey(key, !$state.get()[key]);\n  return $state.get();\n};\n\nconst appendKey = (key, value) => {\n  $state.setKey(key, [...$state.get()[key], value]);\n  return $state.get();\n};\n\nconst setSubkey = (key, subkey, value) => {\n  $state.setKey(key, { ...$state.get()[key], [subkey]: value });\n  return $state.get();\n};\n\nconst toggleSubkey = (key, subkey) => {\n  $state.setKey(key, { ...$state.get()[key], [subkey]: !$state.get()[key][subkey] });\n  return $state.get();\n};\n\nconst appendSubkey = (key, subkey, value) => {\n  $state.setKey(key, { ...$state.get()[key], [subkey]: [...$state.get()[key][subkey], value] });\n  return $state.get();\n};\n\nexport default {\n  store,\n  get,\n  setKey,\n  toggleKey,\n  appendKey,\n  setSubkey,\n  toggleSubkey,\n  appendSubkey\n};\n","import { atom } from '../atom/index.js'\n\nexport let map = (initial = {}) => {\n  let $map = atom(initial)\n\n  $map.setKey = function (key, value) {\n    let oldMap = $map.value\n    if (typeof value === 'undefined' && key in $map.value) {\n      $map.value = { ...$map.value }\n      delete $map.value[key]\n      $map.notify(oldMap, key)\n    } else if ($map.value[key] !== value) {\n      $map.value = {\n        ...$map.value,\n        [key]: value\n      }\n      $map.notify(oldMap, key)\n    }\n  }\n\n  return $map\n}\n","/* global document */\n\nasync function setFullscreen(enabled, setFullscreenState) {\n  if (enabled && !document.fullscreenElement) {\n    try {\n      await document.documentElement.requestFullscreen();\n    } catch {\n      setFullscreenState(false);\n    }\n  } else if (document.fullscreenElement && document.exitFullscreen) {\n    document.exitFullscreen();\n  }\n}\n\nfunction setTitle(title) {\n  document.title = title;\n}\n\nexport default {\n  setFullscreen,\n  setTitle\n};\n","/* global window */\n\nasync function setFullscreen(enabled) {\n  if (enabled) {\n    await window.Neutralino.window.setFullScreen();\n  } else {\n    await window.Neutralino.window.exitFullScreen();\n  }\n}\n\nasync function setTitle(title) {\n  await window.Neutralino.window.setTitle(title);\n}\n\nasync function exitApp() {\n  await window.Neutralino.app.exit();\n}\n\nexport default {\n  setFullscreen,\n  setTitle,\n  exitApp\n};\n","/* global window */\n\nimport atrament from '@atrament/core';\n\nimport loader from './interfaces/loader-web-fflate';\nimport persistentWeb from './interfaces/persistent-localforage';\nimport persistentNeutralino from './interfaces/persistent-neutralino';\nimport sound from './interfaces/sound-howler';\nimport state from './interfaces/state-nanostores';\nimport platformWeb from './interfaces/platform-web';\nimport platformNeutralino from './interfaces/platform-neutralino';\n\natrament.defineInterfaces({\n  loader,\n  persistent: window.Neutralino ? persistentNeutralino : persistentWeb,\n  sound,\n  state,\n  platform: window.Neutralino ? platformNeutralino : platformWeb\n});\n\nexport default atrament;\n"],"names":["root","factory","exports","module","define","amd","self","this","str","seed","k","l","length","h","i","charCodeAt","HowlerGlobal","init","prototype","Howler","_counter","_html5AudioPool","html5PoolSize","_codecs","_howls","_muted","_volume","_canPlayEvent","_navigator","window","navigator","masterGain","noAudio","usingWebAudio","autoSuspend","ctx","autoUnlock","_setup","volume","vol","parseFloat","setupAudioContext","gain","setValueAtTime","currentTime","_webAudio","ids","_getSoundIds","j","sound","_soundById","_node","mute","muted","stop","unload","close","codecs","ext","replace","state","_autoSuspend","Audio","oncanplaythrough","e","_setupCodecs","audioTest","err","canPlayType","mpegTest","ua","userAgent","checkOpera","match","isOldOpera","parseInt","split","checkSafari","indexOf","safariVersion","isOldSafari","mp3","mpeg","opus","ogg","oga","wav","aac","caf","m4a","m4b","mp4","weba","webm","dolby","flac","_unlockAudio","_audioUnlocked","_mobileUnloaded","sampleRate","_scratchBuffer","createBuffer","unlock","audioNode","_unlocked","_releaseHtml5Audio","load","_autoResume","source","createBufferSource","buffer","connect","destination","start","noteOn","resume","onended","disconnect","document","removeEventListener","_emit","addEventListener","_obtainHtml5Audio","pop","testPlay","play","Promise","then","catch","console","warn","audio","push","suspend","_sounds","_paused","_suspendTimer","clearTimeout","setTimeout","handleSuspension","_resumeAfterSuspend","Howl","o","src","error","_autoplay","autoplay","_format","format","_html5","html5","_loop","loop","_pool","pool","_preload","preload","_rate","rate","_sprite","sprite","_src","undefined","_xhr","method","xhr","headers","withCredentials","_duration","_state","_endTimers","_queue","_playLock","_onend","onend","fn","_onfade","onfade","_onload","onload","_onloaderror","onloaderror","_onplayerror","onplayerror","_onpause","onpause","_onplay","onplay","_onstop","onstop","_onmute","onmute","_onvolume","onvolume","_onrate","onrate","_onseek","onseek","_onunlock","onunlock","_onresume","event","action","url","exec","toLowerCase","location","protocol","slice","Sound","loadBuffer","internal","id","num","_ended","_id","_inactiveSound","soundId","_loadQueue","seek","Math","max","_seek","duration","timeout","abs","setParams","_start","_stop","node","playWebAudio","_refreshBuffer","_playStart","bufferSource","noteGrainOn","Infinity","bind","once","_clearTimer","playHtml5","playbackRate","paused","loadedNoReadyState","ejecta","readyState","isCocoonJS","listener","pause","_rateSeek","_stopFade","noteOff","_cleanBuffer","isNaN","arguments","_clearSound","_interval","args","apply","fade","from","to","len","min","end","linearRampToValueAtTime","_startFadeInterval","isGroup","diff","steps","stepLen","lastTick","Date","now","_fadeTo","setInterval","tick","round","clearInterval","cancelScheduledValues","loopStart","loopEnd","playing","realTime","rateSeek","seekAndEmit","emitSeek","sounds","_errorFn","_loadFn","_endFn","index","splice","remCache","cache","on","events","off","isId","keys","Object","Array","isArray","msg","call","task","shift","ended","_drain","reset","limit","cnt","_panner","isIOS","vendor","test","howl","_parent","parent","create","createGain","createGainNode","_errorListener","_loadListener","_endListener","code","ceil","__default","loadSound","data","atob","dataView","Uint8Array","decodeAudioData","XMLHttpRequest","open","responseType","forEach","key","setRequestHeader","status","response","onerror","safeXhrSend","send","arraybuffer","success","AudioContext","webkitAudioContext","iOS","platform","appVersion","version","safari","g","_super","_pos","_orientation","stereo","pan","pos","x","y","z","positionX","setTargetAtTime","positionY","positionZ","setPosition","orientation","xUp","yUp","zUp","or","forwardX","forwardY","forwardZ","upX","upY","upZ","setOrientation","_stereo","_pannerAttr","coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","panningModel","refDistance","rolloffFactor","_onstereo","onstereo","_onpos","onpos","_onorientation","onorientation","pannerType","createStereoPanner","setupPanner","orientationX","orientationY","orientationZ","pannerAttr","_coneInnerAngle","_coneOuterAngle","_coneOuterGain","_distanceModel","_maxDistance","_refDistance","_rolloffFactor","_panningModel","pa","panner","type","createPanner","murmur3","murmur2","remainder","bytes","h1","h1b","c1","c2","k1","t","n","r","s","u","f","Error","_dereq_","global","scheduleDrain","draining","Mutation","MutationObserver","WebKitMutationObserver","called","observer","nextTick","element","createTextNode","observe","characterData","setImmediate","MessageChannel","createElement","scriptEl","onreadystatechange","parentNode","removeChild","documentElement","appendChild","channel","port1","onmessage","port2","postMessage","queue","oldQueue","immediate","INTERNAL","handlers","REJECTED","FULFILLED","PENDING","resolver","TypeError","outcome","safelyResolveThenable","QueueItem","promise","onFulfilled","onRejected","callFulfilled","otherCallFulfilled","callRejected","otherCallRejected","unwrap","func","value","returnValue","reject","resolve","getThen","obj","thenable","onError","onSuccess","tryToUnwrap","result","tryCatch","out","reason","all","iterable","toString","values","resolved","allResolver","resolveFromAll","outValue","race","constructor","_typeof","Symbol","iterator","_classCallCheck","instance","Constructor","getIDB","indexedDB","webkitIndexedDB","mozIndexedDB","OIndexedDB","msIndexedDB","idb","isIndexedDBValid","isSafari","openDatabase","hasFetch","fetch","IDBKeyRange","createBlob","parts","properties","Blob","name","builder","BlobBuilder","MSBlobBuilder","MozBlobBuilder","WebKitBlobBuilder","append","getBlob","Promise$1","executeCallback","callback","executeTwoCallbacks","errorCallback","normalizeKey","String","getCallback","DETECT_BLOB_SUPPORT_STORE","supportsBlobs","dbContexts","READ_ONLY","READ_WRITE","_binStringToArrayBuffer","bin","buf","ArrayBuffer","arr","_checkBlobSupportWithoutCaching","txn","transaction","blob","objectStore","put","onabort","preventDefault","stopPropagation","oncomplete","matchedChrome","matchedEdge","_checkBlobSupport","_deferReadiness","dbInfo","dbContext","deferredOperation","deferredOperations","dbReady","_advanceReadiness","_rejectReadiness","_getConnection","upgradeNeeded","createDbContext","db","dbArgs","openreq","onupgradeneeded","createObjectStore","storeName","oldVersion","ex","newVersion","onsuccess","onversionchange","target","_getOriginalConnection","_getUpgradedConnection","_isUpgradeNeeded","defaultVersion","isNewStore","objectStoreNames","contains","isDowngrade","isUpgrade","incVersion","_encodeBlob","reader","FileReader","onloadend","base64","btoa","__local_forage_encoded_blob","readAsBinaryString","_decodeBlob","encodedBlob","_isEncodedBlob","_fullyReady","_initReady","_dbInfo","_tryReconnect","forages","forage","createTransaction","mode","retries","tx","_initStorage","options","ready","initPromises","ignoreErrors","_defaultConfig","getItem","req","get","iterate","openCursor","iterationNumber","cursor","setItem","blobSupport","store","removeItem","clear","count","advanced","openKeyCursor","advance","dropInstance","currentConfig","config","dbPromise","dropObjectPromise","deleteObjectStore","_forage2","dropDBPromise","deleteDatabase","onblocked","asyncStorage","_driver","_support","isWebSQLValid","BASE_CHARS","BLOB_TYPE_PREFIX","BLOB_TYPE_PREFIX_REGEX","SERIALIZED_MARKER","SERIALIZED_MARKER_LENGTH","TYPE_ARRAYBUFFER","TYPE_BLOB","TYPE_INT8ARRAY","TYPE_UINT8ARRAY","TYPE_UINT8CLAMPEDARRAY","TYPE_INT16ARRAY","TYPE_INT32ARRAY","TYPE_UINT16ARRAY","TYPE_UINT32ARRAY","TYPE_FLOAT32ARRAY","TYPE_FLOAT64ARRAY","TYPE_SERIALIZED_MARKER_LENGTH","toString$1","stringToBuffer","serializedString","encoded1","encoded2","encoded3","encoded4","bufferLength","p","bufferToString","base64String","substring","serialize","valueType","marker","fileReader","readAsArrayBuffer","JSON","stringify","deserialize","parse","blobType","matcher","Int8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","localforageSerializer","createDbTable","executeSql","_initStorage$1","dbInfoPromise","description","size","serializer","tryExecuteSql","sqlStatement","SYNTAX_ERR","results","rows","getItem$1","item","iterate$1","_setItem","retriesLeft","originalValue","sqlError","QUOTA_ERR","setItem$1","removeItem$1","clear$1","length$1","c","key$1","keys$1","getAllStoreNames","storeNames","dropInstance$1","operationInfo","dropTable","operations","webSQLStorage","isLocalStorageValid","localStorage","_getKeyPrefix","defaultConfig","keyPrefix","checkIfLocalStorageThrows","localStorageTestKey","_isLocalStorageUsable","_initStorage$2","clear$2","getItem$2","iterate$2","keyPrefixLength","key$2","keys$2","itemKey","length$2","removeItem$2","setItem$2","dropInstance$2","localStorageWrapper","sameValue","includes","array","searchElement","arg","DefinedDrivers","DriverSupport","DefaultDrivers","INDEXEDDB","WEBSQL","LOCALSTORAGE","DefaultDriverOrder","OptionalDriverMethods","LibraryMethods","concat","DefaultConfig","driver","callWhenReady","localForageInstance","libraryMethod","_args","extend","_key","hasOwnProperty","LocalForage","driverTypeKey","driverName","defineDriver","_config","_driverSet","_initDriver","_ready","_wrapLibraryMethodsWithReady","setDriver","driverObject","complianceError","driverMethods","driverMethodName","configureMissingMethods","methodNotImplementedFactory","methodName","_i","_len","optionalDriverMethod","setDriverSupport","support","info","getDriver","getDriverPromise","getSerializer","serializerPromise","drivers","supportedDrivers","_getSupportedDrivers","setDriverToConfig","extendSelfWithDriver","_extend","initDriver","currentDriverIndex","driverPromiseLoop","oldDriverSetDone","supports","libraryMethodsAndProperties","createInstance","localforage_js","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","d","a","definition","defineProperty","enumerable","globalThis","Function","prop","S","w","ht","gameState","exists","async","set","remove","filter","map","settings","game","metadata","scenes","vars","Dt","setKey","toggleKey","appendKey","setSubkey","toggleSubkey","appendSubkey","loader","persistent","isMuted","setVolume","getVolume","playSound","playMusic","stopMusic","U","M","D","Map","emit","Tt","reduce","imul","V","J","substr","P","canContinue","Continue","currentText","text","currentTags","tags","content","initStory","InkStory","resetStory","ResetState","story","loadState","LoadJson","getState","toJson","makeChoice","ChooseChoiceIndex","getVisitCount","VisitCountAtPathString","ref","visitCount","evaluateFunction","EvaluateFunction","function","getGlobalTags","globalTags","getVariable","variablesState","getVariables","_globalVariables","setVariable","observeVariable","ObserveVariable","goTo","ChoosePathString","getScene","choices","uuid","currentChoices","choice","H","m","C","I","$","T","$gameUUID","$sessionID","join","O","Y","F","B","date","N","K","q","R","getAssetPath","A","stopSound","$currentMusic","v","Q","W","X","Z","loadInk","$file","tt","_","persist","entries","L","Ht","saveSlot","et","qt","UNCLICKABLE","DISABLED","INACTIVE","disabled","st","nt","sort","E","at","it","ot","CLEAR","AUDIO","AUDIOLOOP","Gt","PLAY_SOUND","STOP_SOUND","PLAY_MUSIC","STOP_MUSIC","CHECKPOINT","SAVEGAME","G","ct","continue_maximally","RESTART","RESTART_FROM_CHECKPOINT","single_scene","autosave","Xt","$path","pathToInkFile","inkFile","loadInkFile","initInkStory","canResume","restart","restartAndContinue","continueStory","defineSceneProcessor","SAVE_GAME","SAVE_AUTOSAVE","SAVE_CHECKPOINT","getSaveSlotKey","saveGame","saveCheckpoint","saveAutosave","setState","listSaves","removeSave","existSave","getSession","setSession","getSessions","removeSession","b","rt","ut","ft","gt","save","toggle","defineHandler","runHandlers","ie","interfaces","defineInterfaces","applicationID","Mt","ink","ch2","u8","u16","i32","fleb","fdeb","clim","freb","eb","_a","fl","revfl","_b","fd","rev","hMap","cd","mb","co","le","rvb","sv","r_1","flt","fdt","bits","bits16","shft","slc","subarray","ec","ind","captureStackTrace","inflt","dat","dict","sl","dl","noBuf","resize","noSt","cbuf","bl","nbuf","final","bt","lm","dm","lbt","dbt","tbts","flrm","fdrm","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","add","dsym","dend","mrg","wcln","fnStr","td","ks","lastIndexOf","st_1","spInd","ch","wrkr","fns","cb","td_1","transfer","Worker","URL","createObjectURL","ed","$e$","stack","wk","cbfs","bInflt","inflateSync","pbf","gopt","dictionary","cbify","opts","terminate","consume","b2","b4","b8","inflate","ev","TextDecoder","decode","stream","dutf8","fromCharCode","strFromU8","latin1","slzh","zh","fnl","es","bs","z64e","sc","su","queueMicrotask","loadFromJS","filename","el","body","appendScript","ok","storyContent","$gameFileType","$gamePath","$zipContent","$onProgress","path","endsWith","zipContent","getReader","contentLength","chunks","receivedLength","done","read","percent","chunksAll","position","chunk","fetchWithProgress","term","tAll","files","cbd","lft","ze","fltr","_loop_3","c_1","no","cbl","originalSize","compression","infl","unzip","unzipped","filepath","fullpath","loadFromJSON","onProgress","storage","prefix","localforage","KEY_STORAGE","storageLock","neuGetData","Neutralino","getData","message","neuSetData","setData","murmur","storageKeys","neuSetKey","neuDeleteData","neuDeleteKey","soundCache","musicCache","$stopPlayback","file","cfg","snd","mus","listenerQueue","lqIndex","$state","initial","$map","initialValue","listeners","$atom","lc","listen","notify","oldValue","changedKey","epoch","runListenerQueue","newValue","subscribe","unbind","atom","oldMap","subkey","setFullscreen","enabled","setFullscreenState","fullscreenElement","requestFullscreen","exitFullscreen","setTitle","title","setFullScreen","exitFullScreen","exitApp","app","exit","atrament","persistentNeutralino","persistentWeb","platformNeutralino","platformWeb"],"sourceRoot":""}